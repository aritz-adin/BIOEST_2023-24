[
  {
    "objectID": "Practica0.html",
    "href": "Practica0.html",
    "title": "Práctica 0: Introducción a R",
    "section": "",
    "text": "R permite realizar operaciones matemáticas de manera sencilla. Realiza las siguientes operaciones matemáticas.\n\n\\((7 \\times 3)+12/2+7^2+\\sqrt{4}\\)\n\n\n(7*3)+12/2-7^2+sqrt(4)\n\n[1] -20\n\n\n\n\\(\\log{3}+\\sqrt{2}\\mbox{sin}(\\pi/4)-e^3\\)\n\n\nlog(3)+sqrt(2)*sin(pi/4)-exp(3)\n\n[1] -17.98692\n\n\n\n\\(3+2+\\log(5)+\\dfrac{e^3}{4}+\\sqrt{6}\\)\n\n\n3+2+log(5)+exp(3)/4+sqrt(6)\n\n[1] 14.08031\n\n\n\n\n\n\nAsigna a la letra \\(x\\) el valor 0.28354. Redondea a 2 y 3 decimales.\n\n\nx &lt;- 0.28354\nround(x,2)\n\n[1] 0.28\n\nround(x,3)\n\n[1] 0.284\n\n\n\nAsigna a la letra \\(x\\) el valor 7 y visualízalo en pantalla. Elimina esta asignación utilizando la función rm().\n\n\nx &lt;- 7\nx\n\n[1] 7\n\nrm(x)\n\n\nAsigna a la letra \\(x\\) el valor 2 y a la letra \\(y\\) el valor 5. Multiplica \\(x\\) por \\(y\\) y asigna el resultado a la letra \\(z\\).\n\n\nx &lt;- 2\ny &lt;- 5\n\nz &lt;- x*y\nz\n\n[1] 10\n\n\n\nUtiliza la función ls() para obtener una lista de todos los objetos guardados en la memoria.\n\n\nls()\n\n[1] \"has_annotations\" \"x\"               \"y\"               \"z\"              \n\n\n\nElimina todos los objetos de la memoria con la función rm().\n\n\nrm(list=ls())\nls()\n\ncharacter(0)\n\n\n\n\n\n\nCrea el vector \\(x=(1.5,2,3)\\) y visualízalo por pantalla.\n\n\nx &lt;- c(1.5,2,3)\nx\n\n[1] 1.5 2.0 3.0\n\n\n\nEleva el vector \\(x\\) al cuadrado y guarda el resultado en un objeto denotado por la letra \\(y\\). ¿Qué hace R?\n\n\ny &lt;- x^2\ny\n\n[1] 2.25 4.00 9.00\n\n\n\nSelecciona el valor del vector \\(y\\) que es igual a 4.\n\n\nwhich(y==4)\n\n[1] 2\n\n\n\nCrea un vector cuyas componentes sean small, medium y large.\n\n\ny &lt;- c(\"small\",\"medium\",\"large\")\ny\n\n[1] \"small\"  \"medium\" \"large\" \n\n\n\nCrea los vectores \\(x=(2,3,4,1)\\) y \\(y=(1,1,3,7)\\).\n\n\nx &lt;- c(2,3,4,1)\ny &lt;- c(1,1,3,7)\n\n\nSuma los vectores \\(x\\) e \\(y\\). ¿Qué hace R?\n\n\nx+y\n\n[1] 3 4 7 8\n\n\n\nCrea una matriz cuyas columnas sean los vectores \\(x\\) e \\(y\\).\n\n\ncbind(x,y)\n\n     x y\n[1,] 2 1\n[2,] 3 1\n[3,] 4 3\n[4,] 1 7\n\n\n\nCrea una matriz cuyas filas sean los vectores \\(x\\) e \\(y\\).\n\n\nrbind(x,y)\n\n  [,1] [,2] [,3] [,4]\nx    2    3    4    1\ny    1    1    3    7\n\n\n\nCrea un fichero cuyas columnas sean los vectores \\(x\\) e \\(y\\).\n\n\ndata.frame(x,y)\n\n  x y\n1 2 1\n2 3 1\n3 4 3\n4 1 7\n\n\n\nCrea una secuencia de 0 a 1 con incrementos de 0.2 unidades.\n\n\nseq(from=0,to=1,by=0.2)\n\n[1] 0.0 0.2 0.4 0.6 0.8 1.0\n\n\n\nCrea una secuencia de 0 a 8 con incrementos de 1 unidad.\n\n\nseq(0,8)\n\n[1] 0 1 2 3 4 5 6 7 8\n\n0:8\n\n[1] 0 1 2 3 4 5 6 7 8\n\n\n\nCrea una secuencia descendente del 8 al 1.\n\n\nseq(8,1,-1)\n\n[1] 8 7 6 5 4 3 2 1\n\n8:1\n\n[1] 8 7 6 5 4 3 2 1\n\n\n\nCrea un vector de longitud 5 cuyas componentes sean iguales a 1.\n\n\nrep(1,5)\n\n[1] 1 1 1 1 1\n\n\n\nCrea un vector cuyas primeras tres componentes tomen el valor 1, las tres siguientes tomen el valor 2 y las tres últimas tomen el valor 3.\n\n\nc(rep(1,3), rep(2,3), rep(3,3))\n\n[1] 1 1 1 2 2 2 3 3 3\n\nrep(1:3, each=3)\n\n[1] 1 1 1 2 2 2 3 3 3\n\n\n\nIntroduce en R los datos typos=(2,2,2,3,3,0,3,4,6,4)\n\n\ntypos &lt;- c(2,2,2,3,3,0,3,4,6,4)\ntypos\n\n [1] 2 2 2 3 3 0 3 4 6 4\n\n\n\nUtilizando el vector typos, selecciona el 4º elemento del vector.\n\n\ntypos[4]\n\n[1] 3\n\n\n\nSelecciona todos los elmentos del vector typos excepto el 2º y el 3º.\n\n\ntypos[-c(2,3)]\n\n[1] 2 3 3 0 3 4 6 4\n\n\n\n\n\n\nEn primer lugar, debemos estar seguros de cuál es nuestro directorio de trabajo.\n\n\ngetwd()\n\n\nDescarga el fichero Bodyfat.txt desde MiAulario, léelo en R y almacénalo en un objeto llamado datos.\n\n\ndatos &lt;- read.table(\"BodyFat.txt\", header=TRUE)\n\nhead(datos)\n\n\nGuarda el fichero datos en el archivo Bodyfat.Rdata.\n\n\nsave(datos, file=\"BodyFat.Rdata\")"
  },
  {
    "objectID": "Practica0.html#operaciones-matemáticas",
    "href": "Practica0.html#operaciones-matemáticas",
    "title": "Práctica 0: Introducción a R",
    "section": "",
    "text": "R permite realizar operaciones matemáticas de manera sencilla. Realiza las siguientes operaciones matemáticas.\n\n\\((7 \\times 3)+12/2+7^2+\\sqrt{4}\\)\n\n\n(7*3)+12/2-7^2+sqrt(4)\n\n[1] -20\n\n\n\n\\(\\log{3}+\\sqrt{2}\\mbox{sin}(\\pi/4)-e^3\\)\n\n\nlog(3)+sqrt(2)*sin(pi/4)-exp(3)\n\n[1] -17.98692\n\n\n\n\\(3+2+\\log(5)+\\dfrac{e^3}{4}+\\sqrt{6}\\)\n\n\n3+2+log(5)+exp(3)/4+sqrt(6)\n\n[1] 14.08031"
  },
  {
    "objectID": "Practica0.html#asignaciones",
    "href": "Practica0.html#asignaciones",
    "title": "Práctica 0: Introducción a R",
    "section": "",
    "text": "Asigna a la letra \\(x\\) el valor 0.28354. Redondea a 2 y 3 decimales.\n\n\nx &lt;- 0.28354\nround(x,2)\n\n[1] 0.28\n\nround(x,3)\n\n[1] 0.284\n\n\n\nAsigna a la letra \\(x\\) el valor 7 y visualízalo en pantalla. Elimina esta asignación utilizando la función rm().\n\n\nx &lt;- 7\nx\n\n[1] 7\n\nrm(x)\n\n\nAsigna a la letra \\(x\\) el valor 2 y a la letra \\(y\\) el valor 5. Multiplica \\(x\\) por \\(y\\) y asigna el resultado a la letra \\(z\\).\n\n\nx &lt;- 2\ny &lt;- 5\n\nz &lt;- x*y\nz\n\n[1] 10\n\n\n\nUtiliza la función ls() para obtener una lista de todos los objetos guardados en la memoria.\n\n\nls()\n\n[1] \"has_annotations\" \"x\"               \"y\"               \"z\"              \n\n\n\nElimina todos los objetos de la memoria con la función rm().\n\n\nrm(list=ls())\nls()\n\ncharacter(0)"
  },
  {
    "objectID": "Practica0.html#vectores-y-secuencias",
    "href": "Practica0.html#vectores-y-secuencias",
    "title": "Práctica 0: Introducción a R",
    "section": "",
    "text": "Crea el vector \\(x=(1.5,2,3)\\) y visualízalo por pantalla.\n\n\nx &lt;- c(1.5,2,3)\nx\n\n[1] 1.5 2.0 3.0\n\n\n\nEleva el vector \\(x\\) al cuadrado y guarda el resultado en un objeto denotado por la letra \\(y\\). ¿Qué hace R?\n\n\ny &lt;- x^2\ny\n\n[1] 2.25 4.00 9.00\n\n\n\nSelecciona el valor del vector \\(y\\) que es igual a 4.\n\n\nwhich(y==4)\n\n[1] 2\n\n\n\nCrea un vector cuyas componentes sean small, medium y large.\n\n\ny &lt;- c(\"small\",\"medium\",\"large\")\ny\n\n[1] \"small\"  \"medium\" \"large\" \n\n\n\nCrea los vectores \\(x=(2,3,4,1)\\) y \\(y=(1,1,3,7)\\).\n\n\nx &lt;- c(2,3,4,1)\ny &lt;- c(1,1,3,7)\n\n\nSuma los vectores \\(x\\) e \\(y\\). ¿Qué hace R?\n\n\nx+y\n\n[1] 3 4 7 8\n\n\n\nCrea una matriz cuyas columnas sean los vectores \\(x\\) e \\(y\\).\n\n\ncbind(x,y)\n\n     x y\n[1,] 2 1\n[2,] 3 1\n[3,] 4 3\n[4,] 1 7\n\n\n\nCrea una matriz cuyas filas sean los vectores \\(x\\) e \\(y\\).\n\n\nrbind(x,y)\n\n  [,1] [,2] [,3] [,4]\nx    2    3    4    1\ny    1    1    3    7\n\n\n\nCrea un fichero cuyas columnas sean los vectores \\(x\\) e \\(y\\).\n\n\ndata.frame(x,y)\n\n  x y\n1 2 1\n2 3 1\n3 4 3\n4 1 7\n\n\n\nCrea una secuencia de 0 a 1 con incrementos de 0.2 unidades.\n\n\nseq(from=0,to=1,by=0.2)\n\n[1] 0.0 0.2 0.4 0.6 0.8 1.0\n\n\n\nCrea una secuencia de 0 a 8 con incrementos de 1 unidad.\n\n\nseq(0,8)\n\n[1] 0 1 2 3 4 5 6 7 8\n\n0:8\n\n[1] 0 1 2 3 4 5 6 7 8\n\n\n\nCrea una secuencia descendente del 8 al 1.\n\n\nseq(8,1,-1)\n\n[1] 8 7 6 5 4 3 2 1\n\n8:1\n\n[1] 8 7 6 5 4 3 2 1\n\n\n\nCrea un vector de longitud 5 cuyas componentes sean iguales a 1.\n\n\nrep(1,5)\n\n[1] 1 1 1 1 1\n\n\n\nCrea un vector cuyas primeras tres componentes tomen el valor 1, las tres siguientes tomen el valor 2 y las tres últimas tomen el valor 3.\n\n\nc(rep(1,3), rep(2,3), rep(3,3))\n\n[1] 1 1 1 2 2 2 3 3 3\n\nrep(1:3, each=3)\n\n[1] 1 1 1 2 2 2 3 3 3\n\n\n\nIntroduce en R los datos typos=(2,2,2,3,3,0,3,4,6,4)\n\n\ntypos &lt;- c(2,2,2,3,3,0,3,4,6,4)\ntypos\n\n [1] 2 2 2 3 3 0 3 4 6 4\n\n\n\nUtilizando el vector typos, selecciona el 4º elemento del vector.\n\n\ntypos[4]\n\n[1] 3\n\n\n\nSelecciona todos los elmentos del vector typos excepto el 2º y el 3º.\n\n\ntypos[-c(2,3)]\n\n[1] 2 3 3 0 3 4 6 4"
  },
  {
    "objectID": "Practica0.html#ficheros",
    "href": "Practica0.html#ficheros",
    "title": "Práctica 0: Introducción a R",
    "section": "",
    "text": "En primer lugar, debemos estar seguros de cuál es nuestro directorio de trabajo.\n\n\ngetwd()\n\n\nDescarga el fichero Bodyfat.txt desde MiAulario, léelo en R y almacénalo en un objeto llamado datos.\n\n\ndatos &lt;- read.table(\"BodyFat.txt\", header=TRUE)\n\nhead(datos)\n\n\nGuarda el fichero datos en el archivo Bodyfat.Rdata.\n\n\nsave(datos, file=\"BodyFat.Rdata\")"
  },
  {
    "objectID": "Practica4.html",
    "href": "Practica4.html",
    "title": "Práctica 4: Pruebas no-paramétricas",
    "section": "",
    "text": "Descripción\nEn esta práctica vamos a trabajar con el fichero de datos diabetes.\n\nEl fichero de datos contiene 19 variables medidas sobre 403 pacientes. Estos pacientes forman parte de un estudio con 1046 sujetos diseñado para investigar la prevalencia de la de obesidad, diabetes, y otros factores de riesgo cardiovasculares para Afroamericanos en Virginia, EEUU.\nSegún Dr John Hong, Diabetes Mellitus Tipo II está asociada con la obesidad. El índice cintura-cadera puede ser un predictor en diabetes y enfermedades de corazón.\nDiabetes Mellitus Tipo II está también asociada con hipertensión y ambos pueden ser parte del “Síndrome X”.\nLos 403 sujetos del estudio son aquellos a los que se les hizo un seguimiento de diabetes. La hemoglobina glicosilada &gt;7.0 se toma normalmente como diagnóstico positivo de diabetes.\n\nEl fichero original puede descargarse de la web: http://biostat.mc.vanderbilt.edu/wiki/Main/DataSets\nPara más información ver el paper: Willems JP, Saunders JT, DE Hunt, JB Schorling. Prevalence of coronary heart disease risk factors among rural blacks: A community-based study. Southern Medical Journal 90: 814-820; 1997. https://europepmc.org/abstract/med/9258308\nEstas son las variables que contiene el fichero (se han eliminado alguna del fichero original y se han reemplazado algunos valores perdidos):\n\n\n\nVariable\nDescripción\n\n\n\n\nid\nSubject ID\n\n\nchol\nTotal Cholesterol (mg/dL)\n\n\nstab.glu\nStabilized Glucose (mg/dL)\n\n\nhdl\nHigh Density Lipoprotein (mg/dL)\n\n\nratio\nCholesterol/HDL Ratio\n\n\nglyhb\nGlycosolated Hemoglobin (%)\n\n\nlocation\nBuckingham or Louisa\n\n\nage\nAge of patient (years)\n\n\ngender\nMale or Female\n\n\nheight\nHeight (inches)\n\n\nweight\nWeight (pounds)\n\n\nframe\nBody frame size (small, medium, large)\n\n\nbp.1s\nFirst Systolic Blood Pressure (mmHg)\n\n\nbp.1d\nFirst Diastolic Blood Pressure (mmHg)\n\n\nwaist\nWaistline (inches)\n\n\nhip\nHip measurement (inches)\n\n\n\nEn primer lugar, debemos leer el fichero diabetes en R:\n\nlibrary(PASWR2)\n\ndiabetes &lt;- read.table(\"diabetes.txt\", header=TRUE, sep=\"\", dec=\".\", stringsAsFactors=TRUE)\nhead(diabetes)\n\n    id chol stab.glu hdl ratio glyhb   location age gender height weight  frame\n1 1000  203       82  56   3.6  4.31 Buckingham  46 female     62    121 medium\n2 1001  165       97  24   6.9  4.44 Buckingham  29 female     64    218  large\n3 1002  228       92  37   6.2  4.64 Buckingham  58 female     61    256  large\n4 1003   78       93  12   6.5  4.63 Buckingham  67   male     67    119  large\n5 1005  249       90  28   8.9  7.72 Buckingham  64   male     68    183 medium\n6 1008  248       94  69   3.6  4.81 Buckingham  34   male     71    190  large\n  bp.1s bp.1d waist hip\n1   118    59    29  38\n2   112    68    46  48\n3   190    92    49  57\n4   110    50    33  38\n5   138    80    44  41\n6   132    86    36  42\n\n\n\n\n1. Pruebas no-paramétricas\n\n1.1. ¿Puede asumirse que la variable hdl en mujeres sigue una distribución normal? Contrasta al nivel de significación \\(\\alpha=0.05\\) si la mediana de la variable hdl en mujeres es superior a 47.\nDefinimos la variable \\[X=\\mbox{\"Nivel de 'hdl'  en mujeres\"}\\]\n\n## Seleccionamos los datos requeridos ##\npos &lt;- which(diabetes$gender==\"female\")\nhdl.female &lt;- diabetes$hdl[pos]\n\n## Comprobamos la condición de normalidad ##\neda(hdl.female)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n 234.000    0.000   14.000   41.000   52.111   47.500   50.825   59.000 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n 120.000   17.255  297.739    1.128   18.000  106.000    2.443    1.390 \nSW p-val \n   0.000 \n\n\nRealizamos el test de Wilcoxon (\\(\\alpha=0.05\\)): \\[\\begin{eqnarray*}\nH_0: \\, \\psi=47 \\\\\nH_1: \\, \\psi&gt;47 \\\\\n\\end{eqnarray*}\\]\n\nwilcox.test(hdl.female, mu=47, alternative=\"greater\")\n\n\n    Wilcoxon signed rank test with continuity correction\n\ndata:  hdl.female\nV = 16282, p-value = 0.001492\nalternative hypothesis: true location is greater than 47\n\n\n\n\n1.2. Contrasta al nivel de significación \\(\\alpha=0.05\\) si existen diferencias entre los niveles de hdl en hombres y en mujeres. Comprueba si puede asumirse normalidad y realiza el contraste adecuado.\nDefinimos las variables \\[X=\\mbox{\"Nivel de 'hdl'  en mujeres\"}\\] \\[Y=\\mbox{\"Nivel de 'hdl'  en hombres\"}\\]\n\n## Seleccionamos los datos requeridos ##\npos1 &lt;- which(diabetes$gender==\"male\")\nhdl.male &lt;- diabetes$hdl[pos1]\n\npos2 &lt;- which(diabetes$gender==\"female\")\nhdl.female &lt;- diabetes$hdl[pos2]\n\n# Comprobamos la condición de normalidad\neda(hdl.male)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n 169.000    0.000   12.000   35.000   48.139   44.000   47.173   59.000 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n 117.000   17.004  289.141    1.308   24.000  105.000    1.001    0.934 \nSW p-val \n   0.000 \n\neda(hdl.female)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n 234.000    0.000   14.000   41.000   52.111   47.500   50.825   59.000 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n 120.000   17.255  297.739    1.128   18.000  106.000    2.443    1.390 \nSW p-val \n   0.000 \n\n\nRealizamos el test de Mann-Withney (\\(\\alpha=0.05\\)): \\[\\begin{eqnarray*}\nH_0: \\, \\psi_X-\\psi_Y=0 \\\\\nH_1: \\, \\psi_X-\\psi_Y \\neq 0 \\\\\n\\end{eqnarray*}\\]\n\nwilcox.test(hdl.male, hdl.female, mu=0, alternative=\"two.sided\")\n\n\n    Wilcoxon rank sum test with continuity correction\n\ndata:  hdl.male and hdl.female\nW = 16630, p-value = 0.006439\nalternative hypothesis: true location shift is not equal to 0\n\n\n\n\n1.3. Considera el fichero PHENYL de la libreria PASWR2. Contrasta al nivel de significación \\(\\alpha=0.05\\) si existen diferencias en los niveles medios de la coenzima Q10 en el momento de comenzar el estudio (variable Q10.1) y al finalizar el estudio (variable Q10.4).\nSean \\[X=\\mbox{\"Nivel de la coenzima Q10 al comienzo del estudio\"}\\] \\[Y=\\mbox{\"Nivel de la coenzima Q10 al final del estudio\"}\\]\n\nhead(PHENYL)\n\n  Q10.1 Q10.2 Q10.3 Q10.4\n1  0.39  0.56  0.65  0.45\n2  0.33  0.32  0.44  0.37\n3  0.59  0.58  0.38  0.55\n4  0.86  0.51  0.53  0.47\n5  0.33  0.29  0.29  0.28\n6  0.49  0.37  0.33  0.39\n\n# NOTA: Se tratan de muestran emparejadas (mismos individuos)\nd &lt;- PHENYL$Q10.1-PHENYL$Q10.4\n\n# Comprobamos la condición de normalidad\neda(d)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n  46.000    0.000   -0.220   -0.048    0.122    0.100    0.120    0.298 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n   0.470    0.190    0.036    0.028    0.346    0.690   -1.172    0.305 \nSW p-val \n   0.022 \n\n\nRealizamos el test de Wilcoxon para muestras emparejadas (\\(\\alpha=0.05\\)): \\[\\begin{eqnarray*}\nH_0: \\, \\psi_D=0 \\\\\nH_1: \\, \\psi_D \\neq 0 \\\\\n\\end{eqnarray*}\\]\n\nwilcox.test(d, mu=0, alternative=\"two.sided\")\n\nWarning in wilcox.test.default(d, mu = 0, alternative = \"two.sided\"): cannot\ncompute exact p-value with ties\n\n\n\n    Wilcoxon signed rank test with continuity correction\n\ndata:  d\nV = 857.5, p-value = 0.0005439\nalternative hypothesis: true location is not equal to 0\n\n# or\nwilcox.test(PHENYL$Q10.1, PHENYL$Q10.4, mu=0, paired=TRUE, alternative=\"two.sided\")\n\nWarning in wilcox.test.default(PHENYL$Q10.1, PHENYL$Q10.4, mu = 0, paired =\nTRUE, : cannot compute exact p-value with ties\n\n\n\n    Wilcoxon signed rank test with continuity correction\n\ndata:  PHENYL$Q10.1 and PHENYL$Q10.4\nV = 857.5, p-value = 0.0005439\nalternative hypothesis: true location shift is not equal to 0\n\n\n\n\n1.4 Considera el fichero diabetes. Crea otro fichero llamado diabetes.mujeres que contenga únicamente a las mujeres de la muestra.\n\n## Seleccionamos los datos de la mujeres ##\npos &lt;- which(diabetes$gender==\"female\")\ndiabetes.female &lt;- diabetes[pos,]\n\n\nContrasta al nivel de significación \\(\\alpha=0.05\\) si existen diferencias entre los niveles medios de glucosa glicosilada (glyhb) según la constitución del cuerpo (frame) entre las mujeres.\n\n\n## Análisis exploratorio de los datos ##\nboxplot(glyhb ~ frame, data=diabetes)\n\n\n\n## Análisis de la varianza con la función aov() ##\nglyhb.aov &lt;- aov(glyhb~frame, data=diabetes.female)\nsummary(glyhb.aov)\n\n             Df Sum Sq Mean Sq F value  Pr(&gt;F)   \nframe         2   40.4  20.207     4.7 0.00998 **\nResiduals   231  993.1   4.299                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n## Comprobamos las hipótesis del modelo ##\nchecking.plots(glyhb.aov)\n\n\n\nr &lt;- rstandard(glyhb.aov)\nshapiro.test(r)             ## Normalidad de los errores\n\n\n    Shapiro-Wilk normality test\n\ndata:  r\nW = 0.7235, p-value &lt; 2.2e-16\n\nlibrary(car)\n\nLoading required package: carData\n\nleveneTest(glyhb.aov)       ## Test de Levene para homogeneidad de varianzas\n\nLevene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(&gt;F)\ngroup   2  1.0362 0.3564\n      231               \n\n## Como no se cumplen las hipótesis del modelo, realizamos el test de Kruskal-Wallis\nkruskal.test(glyhb~frame, data=diabetes.female)\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  glyhb by frame\nKruskal-Wallis chi-squared = 20.111, df = 2, p-value = 4.295e-05\n\n\n\nSi has detectado diferencias, averigua entre qué grupos existen diferencias estadísticamente significativas.\n\n\nlibrary(agricolae)\n\nkruskal(diabetes.female$glyhb, diabetes.female$frame, alpha=0.05, group=FALSE, console=TRUE)\n\n\nStudy: diabetes.female$glyhb ~ diabetes.female$frame\nKruskal-Wallis test's\nTies or no Ties\n\nCritical Value: 20.11077\nDegrees of freedom: 2\nPvalue Chisq  : 4.295381e-05 \n\ndiabetes.female$frame,  means of the ranks\n\n       diabetes.female.glyhb   r\nlarge              157.07143  42\nmedium             114.76423 123\nsmall               98.28986  69\n\nPost Hoc Analysis\n\nComparison between treatments mean of the ranks.\n\n               Difference pvalue Signif.       LCL      UCL\nlarge - medium   42.30720 0.0003     *** 19.424803 65.18960\nlarge - small    58.78157 0.0000     *** 33.723420 83.83973\nmedium - small   16.47437 0.0932       . -2.783587 35.73233\n\n\n\n\n\n2. Para entregar\n\n2.1. Contrasta al nivel de significación \\(\\alpha=0.05\\) si el peso medio de los hombres es al menos 4 libras (pounds) superior que el peso medio de las mujeres.\n\n\n2.2 Considera el fichero diabetes. Crea otro fichero llamado diabetes.B que contenga únicamente a los habitantes del condado de Buckingham.\n\nContrasta al nivel de significación \\(\\alpha=0.05\\) si existen diferencias entre los niveles medios de glucosa glicosilada (glyhb) según la constitución del cuerpo (frame) entre las mujeres.\nSi has detectado diferencias, averigua entre qué grupos existen diferencias estadísticamente significativas."
  },
  {
    "objectID": "Practica2.html",
    "href": "Practica2.html",
    "title": "Práctica 2: Estadística descriptiva",
    "section": "",
    "text": "Descripción\nEn esta práctica vamos a trabajar con el fichero de datos diabetes.\n\nEl fichero de datos contiene 19 variables medidas sobre 403 pacientes. Estos pacientes forman parte de un estudio con 1046 sujetos diseñado para investigar la prevalencia de la de obesidad, diabetes, y otros factores de riesgo cardiovasculares para Afroamericanos en Virginia, EEUU.\nSegún Dr John Hong, Diabetes Mellitus Tipo II está asociada con la obesidad. El índice cintura-cadera puede ser un predictor en diabetes y enfermedades de corazón.\nDiabetes Mellitus Tipo II está también asociada con hipertensión y ambos pueden ser parte del “Síndrome X”.\nLos 403 sujetos del estudio son aquellos a los que se les hizo un seguimiento de diabetes. La hemoglobina glicosilada &gt;7.0 se toma normalmente como diagnóstico positivo de diabetes.\n\nEl fichero original puede descargarse de la web: http://biostat.mc.vanderbilt.edu/wiki/Main/DataSets\nPara más información ver el paper: Willems JP, Saunders JT, DE Hunt, JB Schorling. Prevalence of coronary heart disease risk factors among rural blacks: A community-based study. Southern Medical Journal 90: 814-820; 1997. https://europepmc.org/abstract/med/9258308\nEstas son las variables que contiene el fichero (se han eliminado alguna del fichero original y se han reemplazado algunos valores perdidos):\n\n\n\nVariable\nDescripción\n\n\n\n\nid\nSubject ID\n\n\nchol\nTotal Cholesterol (mg/dL)\n\n\nstab.glu\nStabilized Glucose (mg/dL)\n\n\nhdl\nHigh Density Lipoprotein (mg/dL)\n\n\nratio\nCholesterol/HDL Ratio\n\n\nglyhb\nGlycosolated Hemoglobin (%)\n\n\nlocation\nBuckingham or Louisa\n\n\nage\nAge of patient (years)\n\n\ngender\nMale or Female\n\n\nheight\nHeight (inches)\n\n\nweight\nWeight (pounds)\n\n\nframe\nBody frame size (small, medium, large)\n\n\nbp.1s\nFirst Systolic Blood Pressure (mmHg)\n\n\nbp.1d\nFirst Diastolic Blood Pressure (mmHg)\n\n\nwaist\nWaistline (inches)\n\n\nhip\nHip measurement (inches)\n\n\n\n\n\n1. Estadística descriptiva unidimensional\n1.1. Descarga el fichero diabetes y léelo en R.\n\ndiabetes &lt;- read.table(\"diabetes.txt\", header=TRUE, sep=\"\", dec=\".\", stringsAsFactors=TRUE)\nhead(diabetes)\n\n    id chol stab.glu hdl ratio glyhb   location age gender height weight  frame\n1 1000  203       82  56   3.6  4.31 Buckingham  46 female     62    121 medium\n2 1001  165       97  24   6.9  4.44 Buckingham  29 female     64    218  large\n3 1002  228       92  37   6.2  4.64 Buckingham  58 female     61    256  large\n4 1003   78       93  12   6.5  4.63 Buckingham  67   male     67    119  large\n5 1005  249       90  28   8.9  7.72 Buckingham  64   male     68    183 medium\n6 1008  248       94  69   3.6  4.81 Buckingham  34   male     71    190  large\n  bp.1s bp.1d waist hip\n1   118    59    29  38\n2   112    68    46  48\n3   190    92    49  57\n4   110    50    33  38\n5   138    80    44  41\n6   132    86    36  42\n\n\n1.2. ¿Cuántas variables tiene el fichero diabetes?\n\n# Dimensión del fichero de datos \ndim(diabetes)\n\n[1] 403  16\n\n# Nº de filas (individuos) \nnrow(diabetes)\n\n[1] 403\n\n# Nº de columnas (variables) \nncol(diabetes)\n\n[1] 16\n\n\n1.3. ¿De qué tipo es cada variable?\n\nstr(diabetes)\n\n'data.frame':   403 obs. of  16 variables:\n $ id      : int  1000 1001 1002 1003 1005 1008 1011 1015 1016 1022 ...\n $ chol    : num  203 165 228 78 249 248 195 227 177 263 ...\n $ stab.glu: int  82 97 92 93 90 94 92 75 87 89 ...\n $ hdl     : num  56 24 37 12 28 69 41 44 49 40 ...\n $ ratio   : num  3.6 6.9 6.2 6.5 8.9 ...\n $ glyhb   : num  4.31 4.44 4.64 4.63 7.72 ...\n $ location: Factor w/ 2 levels \"Buckingham\",\"Louisa\": 1 1 1 1 1 1 1 1 1 1 ...\n $ age     : int  46 29 58 67 64 34 30 37 45 55 ...\n $ gender  : Factor w/ 2 levels \"female\",\"male\": 1 1 1 2 2 2 2 2 2 1 ...\n $ height  : num  62 64 61 67 68 71 69 59 69 63 ...\n $ weight  : num  121 218 256 119 183 190 191 170 166 202 ...\n $ frame   : Factor w/ 3 levels \"large\",\"medium\",..: 2 1 1 1 2 1 2 2 1 3 ...\n $ bp.1s   : num  118 112 190 110 138 ...\n $ bp.1d   : num  59 68 92 50 80 ...\n $ waist   : num  29 46 49 33 44 36 46 34 34 45 ...\n $ hip     : num  38 48 57 38 41 42 49 39 40 50 ...\n\n\n1.4. ¿Cuántas categorías tiene la variable frame?\n\nlevels(diabetes$frame)\n\n[1] \"large\"  \"medium\" \"small\" \n\n\nNOTA: Las categorías están ordenadas por orden alfabético\n\n# Es posible indicar el orden de las categorías \ndiabetes$frame &lt;- factor(diabetes$frame, levels=c(\"small\",\"medium\",\"large\"))\nlevels(diabetes$frame)\n\n[1] \"small\"  \"medium\" \"large\" \n\n\n1.5. Obtén una tabla de frecuencias absolutas y relativas para la variable frame.\n\ntable(diabetes$frame)\n\n\n small medium  large \n   104    196    103 \n\ntable(diabetes$frame)/nrow(diabetes)\n\n\n    small    medium     large \n0.2580645 0.4863524 0.2555831 \n\n\n1.6. Realiza una representación gráfica adecuada para la variable frame. ¿Qué información obtienes?\n\nX &lt;- table(diabetes$frame)\n\n# Diagrama de barras\nbarplot(X, xlab=\"Frame\", ylab=\"Frequency\", col=topo.colors(3))\nlegend(\"topright\", legend=levels(diabetes$frame), fill=topo.colors(3))\n\n\n\n# Diagrama de sectores\npie(X, labels=names(X), col=topo.colors(3))\nlegend(\"topleft\", legend=levels(diabetes$frame), fill=topo.colors(3))\n\n\n\n\n1.7. Calcula la moda de la variable frame. ¿Qué significa?\n1.8. ¿Qué representaciones gráficas te parecen adecuadas para la variable chol?\n1.9. Realiza un histograma y un diagrama de cajas de la variable chol. ¿Qué información obtienes de ellos?\n\npar(mfrow=c(1,2),pty=\"s\")\nhist(diabetes$chol, nclass=\"scott\", col=\"cyan\", main=\"Histograma\", xlab=\"Colesterol\")\nboxplot(diabetes$chol, col=\"pink\", main=\"Diagrama de caja\", xlab=\"Colesterol\")\n\n\n\n\n1.10. A la vista del diagrama de cajas y del histograma de la variable chol, qué puedes decir acerca de su simetría? ¿Qué crees que será mayor, la media o la mediana?\n1.11. Calcula el coeficiente de asimetría, la media y la mediana de la variable chol. ¿Confirma dicho valor lo observado en el histograma y el diagrama de cajas?\n\nsummary(diabetes$chol)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   78.0   179.0   204.0   207.8   230.0   443.0 \n\n# También podemos utilizar la función eda() de la librería PASWR2\nlibrary(PASWR2)\neda(diabetes$chol)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n 403.000    0.000   78.000  179.000  207.846  204.000  205.903  230.000 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n 443.000   44.390 1970.494    2.211   51.000  365.000    2.558    0.924 \nSW p-val \n   0.000 \n\n\n1.12. Calcula el mínimo, el máximo, los cuartiles y la desviación típica de la variable chol. ¿Entre qué valores se encuentra el 25% de las personas con el colesterol más alto? ¿Y el 75% de las personas con el colesterol más bajo? ¿Qué puedes decir acerca de la dispersión de la variable? ¿Dónde hay más dispersión, en el 25% de las personas con mayor colesterol o en el 25% de las personas con colesterol más bajo?\n1.13. Calcula el coeficiente de curtosis de la variable chol. ¿Qué indica?\n1.14. Según el diagrama de cajas, ¿existe alguna observación atípica? ¿Cuál es?\n\naux &lt;- boxplot(diabetes$chol)\n\n\n\n# Valores atípicos\naux$out\n\n[1]  78 443 318 347 342 404 307 337 322\n\n\n1.15. ¿Cuántos hombres y cuántas mujeres hay en la muestra?\n\ntable(diabetes$gender)\n\n\nfemale   male \n   234    169 \n\n\n1.16. ¿Cuántas personas residen en Buckingham? ¿Cuántas en Louisa?\n\ntable(diabetes$location)\n\n\nBuckingham     Louisa \n       200        203 \n\n\n1.17. ¿Puedes calcular la media y la mediana de la variable location?\n1.18. Realiza un diagrama de cajas de la variable chol según las categorías de la variable frame.\n\nboxplot(chol~frame, data=diabetes)\n\n\n\n\n1.19. Realiza un diagrama de cajas de la variable chol según las categorías de la variable frame y la variable gender.\n\nboxplot(chol~frame+gender, data=diabetes)\n\n\n\n\n1.20. Calcula la media, mediana, la desviación típica y los cuartiles de la variable chol según las categorías de la variable frame?\n\n# Aplicamos la función summary() para cada categoría de la variable 'frame'\ntapply(diabetes$chol, diabetes$frame, summary)\n\n$small\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  118.0   169.5   196.0   197.6   219.2   307.0 \n\n$medium\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  115.0   181.0   206.5   213.2   239.2   443.0 \n\n$large\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   78.0   181.5   206.0   208.0   231.5   347.0 \n\n# Aplicamos la función sd() para cada categoría de la variable 'frame'\ntapply(diabetes$chol, diabetes$frame, sd)\n\n   small   medium    large \n38.95477 46.87484 43.25211 \n\n\n1.21. Realiza un histograma de la variable chol según las categorías de la variable frame y la variable gender.\n\nlibrary(lattice)\nhistogram(~ chol | frame*gender, xlab=\"Colesterol\", type=\"density\", data=diabetes)\n\n\n\n\nNOTA: La sintáxis de esta función es muy particular\n1.22. Calcula la media, la mediana, los cuartiles y la desviación típica de la variable glyhb. Explica cómo está de dispersa utilizando el histograma, el diagrama de cajas, los cuartiles y la desviación típica.\n\neda(diabetes$glyhb)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n 403.000    0.000    2.680    4.390    5.590    4.870    5.313    5.590 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n  16.110    2.206    4.867    0.110    1.200   13.430    5.252    2.266 \nSW p-val \n   0.000 \n\npar(mfrow=c(1,2),pty=\"s\")\nhist(diabetes$glyhb, nclass=\"scott\", col=\"cyan\")\nboxplot(diabetes$glyhb, col=\"pink\")\n\n\n\n\n1.23. Compara la dispersión de las variables chol y glyhb. ¿Qué variable tiene la desviación típica más alta? ¿Puedes concluir que aquella variable con la desviación típica más alta es la más dispersa? ¿Por qué? ¿Qué medida crees que es la más adecuada?\n\neda(diabetes$chol)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n 403.000    0.000   78.000  179.000  207.846  204.000  205.903  230.000 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n 443.000   44.390 1970.494    2.211   51.000  365.000    2.558    0.924 \nSW p-val \n   0.000 \n\neda(diabetes$glyhb)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n 403.000    0.000    2.680    4.390    5.590    4.870    5.313    5.590 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n  16.110    2.206    4.867    0.110    1.200   13.430    5.252    2.266 \nSW p-val \n   0.000 \n\n# Para compara la dispersión de las variables debemos calcular el coeficiente de variación\nCV.col &lt;- sd(diabetes$chol)/mean(diabetes$chol)\nCV.col\n\n[1] 0.213573\n\nCV.glyhb &lt;- sd(diabetes$glyhb)/mean(diabetes$glyhb)\nCV.glyhb\n\n[1] 0.394656\n\n\n1.24. Considera la variable chol por sexo. Selecciona el hombre y la mujer con mayor nivel de colesterol. ¿Cuál de los dos destaca más en comparación a la media de su grupo?\n\n# Definimos un conjunto de datos para los hombres y otro para las mujeres\npos &lt;- which(diabetes$gender==\"male\")\ndiabetes.male &lt;- diabetes[pos,]\n\npos &lt;- which(diabetes$gender==\"female\")\ndiabetes.female &lt;- diabetes[pos,]\n\n# Calculamos los niveles de colesterol máximos \nx &lt;- max(diabetes.male$chol)\ny &lt;- max(diabetes.female$chol)\n\n# Tipificamos los valores \nx.tipif &lt;- (x-mean(diabetes.male$chol))/sd(diabetes.male$chol)\nx.tipif\n\n[1] 4.340132\n\ny.tipif &lt;- (y-mean(diabetes.female$chol))/sd(diabetes.female$chol)\ny.tipif\n\n[1] 5.36182\n\n\nComo x.tipif=4.340 &lt; y.tipif=5.362, el nivel de colesterol de la mujer destaca más respecto a su grupo.\n1.25. Crea una nueva variable denominada ratioWH definida como el cociente de la variable waist y la variable hip.\n\ndiabetes$ratioWH &lt;- diabetes$waist/diabetes$hip\nhead(diabetes)\n\n    id chol stab.glu hdl ratio glyhb   location age gender height weight  frame\n1 1000  203       82  56   3.6  4.31 Buckingham  46 female     62    121 medium\n2 1001  165       97  24   6.9  4.44 Buckingham  29 female     64    218  large\n3 1002  228       92  37   6.2  4.64 Buckingham  58 female     61    256  large\n4 1003   78       93  12   6.5  4.63 Buckingham  67   male     67    119  large\n5 1005  249       90  28   8.9  7.72 Buckingham  64   male     68    183 medium\n6 1008  248       94  69   3.6  4.81 Buckingham  34   male     71    190  large\n  bp.1s bp.1d waist hip   ratioWH\n1   118    59    29  38 0.7631579\n2   112    68    46  48 0.9583333\n3   190    92    49  57 0.8596491\n4   110    50    33  38 0.8684211\n5   138    80    44  41 1.0731707\n6   132    86    36  42 0.8571429\n\n\n1.26. Dibuja un histograma y un diagrama de cajas de la variable ratioWH.\n\npar(mfrow=c(1,2),pty=\"s\")\nhist(diabetes$ratioWH,nclass=\"scott\",col=\"cyan\")\nboxplot(diabetes$ratioWH,col=\"pink\")\n\n\n\n\n1.27. Calcula el mínimo, el máximo, los cuartiles y la desviación típica de la variable ratioWH. ¿Entre qué valores se encuentra el 25% de los valores más altos? ¿Y el 75% de los valores más bajos?\n\neda(diabetes$ratioWH)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n 403.000    0.000    0.682    0.830    0.881    0.881    0.879    0.925 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n   1.143    0.072    0.005    0.004    0.095    0.461    0.644    0.383 \nSW p-val \n   0.002 \n\nsummary(diabetes$ratioWH)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.6818  0.8298  0.8806  0.8809  0.9250  1.1429 \n\n\n\n\n2. Tablas de doble entrada\n2.1. ¿Cuántos hombres y cuántas mujeres hay en la localización Buckingham? ¿Cuántos en Louisa?\n\ntable(diabetes$gender,diabetes$location)\n\n        \n         Buckingham Louisa\n  female        114    120\n  male           86     83\n\n\n2.2. ¿Qué porcentaje de personas en la muestra tienen un body frame “small” y además son de Buckingham?\n\nX &lt;- table(diabetes$frame,diabetes$location)\nprop.table(X)\n\n        \n         Buckingham     Louisa\n  small  0.11910670 0.13895782\n  medium 0.22084367 0.26550868\n  large  0.15632754 0.09925558\n\n\n2.3. Dibuja un diagrama de barras donde representes las frecuencias de la variable location para cada una de las categorías de la variable frame?\n\nX &lt;- table(diabetes$location,diabetes$frame)\nX\n\n            \n             small medium large\n  Buckingham    48     89    63\n  Louisa        56    107    40\n\nbarplot(X, col=topo.colors(3),legend.text=TRUE)\n\n\n\nbarplot(t(X), col=topo.colors(3),legend.text=TRUE)\n\n\n\n\n2.4. Forma una tabla de doble entrada cruzando las variables gender y frame. ¿Cuántas mujeres tienen un body frame “medium”?\n\nY &lt;- table(diabetes$gender,diabetes$frame)\nY\n\n        \n         small medium large\n  female    69    123    42\n  male      35     73    61\n\n\n2.5. ¿Qué porcentaje de hombres tienen un body frame “large”?\n\nprop.table(Y)\n\n        \n              small     medium      large\n  female 0.17121588 0.30521092 0.10421836\n  male   0.08684864 0.18114144 0.15136476\n\nprop.table(Y,1)\n\n        \n             small    medium     large\n  female 0.2948718 0.5256410 0.1794872\n  male   0.2071006 0.4319527 0.3609467\n\n\n\n\n3. Covarianza y correlación\n3.1. Realiza un diagrama de dispersión de las variables weight y waist. ¿Crees que existe relación lineal entre ambas variables? Calcula la covarianza y el coeficiente de correlación lineal.\n\nplot(diabetes$weight,diabetes$waist)\nabline(lm(waist ~ weight, data=diabetes), col=\"red\")\n\n\n\ncov(diabetes$weight,diabetes$waist)\n\n[1] 194.8847\n\ncor(diabetes$weight,diabetes$waist)\n\n[1] 0.8463617\n\n\n3.2. Realiza un diagrama de dispersión de las variables chol y weight. ¿Crees que existe relación lineal entre ambas variables? Calcula la covarianza y el coeficiente de correlación lineal.\n\nplot(diabetes$weight, diabetes$chol)\nabline(lm(chol ~ weight, data=diabetes), col=\"red\")\n\n\n\ncov(diabetes$chol,diabetes$weight)\n\n[1] 118.4692\n\ncor(diabetes$chol,diabetes$weight)\n\n[1] 0.06623929\n\n\n3.3. Selecciona las personas del condado de Buckingham y realiza un diagrama de dispersión de las variables waist y hip. ¿Crees que existe relación lineal entre ambas variables? Calcula la covarianza y el coeficiente de correlación lineal.\n\npos &lt;- which(diabetes$location==\"Buckingham\")\ndiabetes.B &lt;- diabetes[pos,]\n\nplot(diabetes.B$waist,diabetes.B$hip)\nabline(lm(hip ~ waist, data=diabetes.B), col=\"red\")\n\n\n\ncov(diabetes.B$waist,diabetes.B$hip)\n\n[1] 32.66462\n\ncor(diabetes.B$waist,diabetes.B$hip)\n\n[1] 0.854653\n\n\n3.4. Selecciona las mujeres con body frame “medium” y realiza un diagrama de dispersión de las variables bp.1s y age. ¿Crees que existe relación lineal entre ambas variables? Calcula la covarianza y el coeficiente de correlación lineal.\n\npos &lt;- which(diabetes$gender==\"female\" & diabetes$frame ==\"medium\")\ndatos &lt;- diabetes[pos,]\n\nplot(datos$age,datos$bp.1s)\nabline(lm(bp.1s ~ age, data=diabetes.B), col=\"red\")\n\n\n\ncov(datos$bp.1s,datos$age)\n\n[1] 237.8738\n\ncor(datos$bp.1s,datos$age)\n\n[1] 0.5473436\n\n\nEXTRA: A fancy way of visualizing correlation a matrix\n\nlibrary(corrplot)\n\ndiabetes.X &lt;- diabetes[,c(\"chol\",\"stab.glu\",\"hdl\",\"glyhb\",\"age\",\"height\",\"weight\",\"bp.1s\",\"bp.1d\",\"waist\",\"hip\")]\ncor.matrix &lt;- cor(diabetes.X)\n\ncorrplot(cor.matrix, method=\"circle\", type=\"upper\")\n\n\n\ncorrplot(cor.matrix, method=\"number\", type=\"upper\")\n\n\n\n\n\n\n\n\n\n\n\n\n4. Para entregar\nConsidera la variable bp.1s:\n4.1. Realiza un histograma y un diagrama de cajas. Interpreta los gráficos obtenidos. ¿Qué puedes decir acerca de la simetría y la dispersión de la variable bp.1s?\n4.2. Calcula la media, mediana, cuartiles, desviación típica, coeficientes de asimetría y de curtosis, y los coeficientes de variación. Indica sus unidades e interpreta los estadísticos (en aquellos casos que sea posible).\n4.3. Dibuja un histograma y un diagrama de cajas en función de la variable sexo. Interpreta los gráficos obtenidos.\n4.4. Realiza un diagrama de dispersión de las variables bp.1s y bp.1d“. ¿Crees que existe relación lineal entre ellas? Calcula e interpreta la covarianza y el coeficiente de correlación lineal (indica sus unidades).\n4.5. Selecciona el hombre y la mujer con menor presión diastólica. ¿Cuál de los dos destaca más en comparación a la media de su grupo?"
  },
  {
    "objectID": "plantillas/Practica1_plantilla.html",
    "href": "plantillas/Practica1_plantilla.html",
    "title": "Práctica 1",
    "section": "",
    "text": "Con el fichero datos, visualiza en pantalla la variable fat.\n\n\nSelecciona las observaciones de las variable fat cuyo valor sea menor que 25 y guárdalas en un objeto llamado low.fat.\n\n\nUtiliza el comando table para averiguar cuántos hombres y mujeres hay en el fichero datos.\n\n\nHaz un summary del fichero datos.\n\n\nElimina la variable fat del fichero datos.\n\n\nElimina las observaciones 7, 9 y 15 del fichero datos.\n\n\nUtiliza la función eda() del paquete PASWR2 para realizar un análisis exploratorio de la variable fat."
  },
  {
    "objectID": "plantillas/Practica1_plantilla.html#realiza-los-siguientes-ejercicios",
    "href": "plantillas/Practica1_plantilla.html#realiza-los-siguientes-ejercicios",
    "title": "Práctica 1",
    "section": "",
    "text": "Con el fichero datos, visualiza en pantalla la variable fat.\n\n\nSelecciona las observaciones de las variable fat cuyo valor sea menor que 25 y guárdalas en un objeto llamado low.fat.\n\n\nUtiliza el comando table para averiguar cuántos hombres y mujeres hay en el fichero datos.\n\n\nHaz un summary del fichero datos.\n\n\nElimina la variable fat del fichero datos.\n\n\nElimina las observaciones 7, 9 y 15 del fichero datos.\n\n\nUtiliza la función eda() del paquete PASWR2 para realizar un análisis exploratorio de la variable fat."
  },
  {
    "objectID": "Practica1.html",
    "href": "Practica1.html",
    "title": "Práctica 1: Lectura y manejo de ficheros",
    "section": "",
    "text": "Carga la librería PASWR2 para trabajar con el fichero EPIDURAL.\n\nlibrary(PASWR2)\n\n\nVisualiza los primeros 6 registros del fichero EPIDURAL con el comando head().\nVisualiza los primeros 20 registros del fichero EPIDURAL con el comando head().\n\n\nhead(EPIDURAL, n=20)\n\n   doctor  kg  cm       ease           treatment oc complications\n1   Dr. B 116 172  Difficult Traditional Sitting  0          None\n2   Dr. C  86 176       Easy   Hamstring Stretch  0          None\n3   Dr. B  72 157  Difficult Traditional Sitting  0          None\n4   Dr. B  63 169       Easy   Hamstring Stretch  2          None\n5   Dr. B 114 163 Impossible Traditional Sitting  0          None\n6   Dr. B 121 163  Difficult   Hamstring Stretch  3          None\n7   Dr. D  90 170  Difficult   Hamstring Stretch  2   Paresthesia\n8   Dr. B  87 164  Difficult Traditional Sitting  6          None\n9   Dr. D  74 166       Easy   Hamstring Stretch  0          None\n10  Dr. C  91 175       Easy   Hamstring Stretch  1          None\n11  Dr. A  67 167       Easy Traditional Sitting  6          None\n12  Dr. C  65 155       Easy Traditional Sitting  2          None\n13  Dr. C  91 163  Difficult   Hamstring Stretch  2   Paresthesia\n14  Dr. C  48 152       Easy   Hamstring Stretch  0          None\n15  Dr. C  85 168       Easy   Hamstring Stretch  2   Paresthesia\n16  Dr. C  80 173       Easy   Hamstring Stretch  0          None\n17  Dr. D 114 168 Impossible   Hamstring Stretch  1          None\n18  Dr. D  75 157       Easy Traditional Sitting  0   Paresthesia\n19  Dr. D  59 152       Easy   Hamstring Stretch  0          None\n20  Dr. A  57 165       Easy   Hamstring Stretch  1          None\n\n\n\nCalcula cuántos registros y cuantas variables tiene el fichero EPIDURAL con el comando dim().\n\n\ndim(EPIDURAL)\n\n[1] 85  7\n\n\n\nCalcula cuántos registros y cuantas variables tiene el fichero EPIDURAL con el comando str().\n\n\nstr(EPIDURAL)\n\n'data.frame':   85 obs. of  7 variables:\n $ doctor       : Factor w/ 4 levels \"Dr. A\",\"Dr. B\",..: 2 3 2 2 2 2 4 2 4 3 ...\n $ kg           : int  116 86 72 63 114 121 90 87 74 91 ...\n $ cm           : int  172 176 157 169 163 163 170 164 166 175 ...\n $ ease         : Factor w/ 3 levels \"Difficult\",\"Easy\",..: 1 2 1 2 3 1 1 1 2 2 ...\n $ treatment    : Factor w/ 2 levels \"Hamstring Stretch\",..: 2 1 2 1 2 1 1 2 1 1 ...\n $ oc           : int  0 0 0 2 0 3 2 6 0 1 ...\n $ complications: Factor w/ 5 levels \"Failure - person got dizzy\",..: 3 3 3 3 3 3 4 3 3 3 ...\n\n\n\n\n\n\nSelecciona la variable doctor del fichero EPIDURAL y visualízala en pantalla.\n\n\nEPIDURAL$doctor\n\n [1] Dr. B Dr. C Dr. B Dr. B Dr. B Dr. B Dr. D Dr. B Dr. D Dr. C Dr. A Dr. C\n[13] Dr. C Dr. C Dr. C Dr. C Dr. D Dr. D Dr. D Dr. A Dr. A Dr. C Dr. C Dr. B\n[25] Dr. B Dr. D Dr. D Dr. A Dr. B Dr. B Dr. D Dr. C Dr. C Dr. A Dr. A Dr. A\n[37] Dr. A Dr. B Dr. D Dr. D Dr. A Dr. D Dr. D Dr. D Dr. A Dr. C Dr. A Dr. A\n[49] Dr. C Dr. A Dr. C Dr. C Dr. B Dr. D Dr. D Dr. B Dr. D Dr. A Dr. A Dr. B\n[61] Dr. B Dr. B Dr. C Dr. C Dr. D Dr. A Dr. D Dr. C Dr. A Dr. A Dr. A Dr. A\n[73] Dr. C Dr. B Dr. C Dr. C Dr. B Dr. B Dr. B Dr. D Dr. D Dr. B Dr. A Dr. A\n[85] Dr. A\nLevels: Dr. A Dr. B Dr. C Dr. D\n\n\n\nSelecciona la variable kg del fichero EPIDURAL y visualízala en pantalla.\n\n\nEPIDURAL$kg\n\n [1] 116  86  72  63 114 121  90  87  74  91  67  65  91  48  85  80 114  75  59\n[20]  57 105  83  71 108  98  74 134  83  86  76  82  59  75  61 106  81 103 113\n[39]  60  90 142  83  83  89  67  90  71  66  95  70  94  85  86 131  67  97  93\n[58]  90  84  59 112  86  74  92 168  80  79  84  63  85  79  79  77  93  57  96\n[77]  79  69  72 104  89  86 103  72  94\n\n\n\nSelecciona la variable cm del fichero EPIDURAL y visualízala en pantalla.\n\n\nEPIDURAL$cm\n\n [1] 172 176 157 169 163 163 170 164 166 175 167 155 163 152 168 173 168 157 152\n[20] 165 165 168 152 175 176 155 169 170 175 165 173 168 173 163 165 163 161 166\n[39] 165 171 170 160 160 173 160 168 163 160 170 165 185 163 165 175 159 162 160\n[58] 163 164 157 170 170 168 163 168 157 163 160 163 165 168 160 157 170 160 180\n[77] 160 157 170 169 172 156 170 160 165\n\n\n\nCrea una nueva variable llamada ratio definida como el cociente entre kg/cm. Añádela al fichero EPIDURAL\n\n\nEPIDURAL$ratio &lt;- EPIDURAL$kg/EPIDURAL$cm\n\nhead(EPIDURAL)\n\n  doctor  kg  cm       ease           treatment oc complications     ratio\n1  Dr. B 116 172  Difficult Traditional Sitting  0          None 0.6744186\n2  Dr. C  86 176       Easy   Hamstring Stretch  0          None 0.4886364\n3  Dr. B  72 157  Difficult Traditional Sitting  0          None 0.4585987\n4  Dr. B  63 169       Easy   Hamstring Stretch  2          None 0.3727811\n5  Dr. B 114 163 Impossible Traditional Sitting  0          None 0.6993865\n6  Dr. B 121 163  Difficult   Hamstring Stretch  3          None 0.7423313\n\n\n\nSelecciona la paciente número 19 del fichero EPIDURAL. Visualízala por pantalla y averigua cuánto pesa y cuánto mide.\n\n\nEPIDURAL[19, ]\n\n   doctor kg  cm ease         treatment oc complications     ratio\n19  Dr. D 59 152 Easy Hamstring Stretch  0          None 0.3881579\n\n\n\nElimina la paciente 1 del fichero EPIDURAL.\n\n\nhead(EPIDURAL[-1, ])\n\n  doctor  kg  cm       ease           treatment oc complications     ratio\n2  Dr. C  86 176       Easy   Hamstring Stretch  0          None 0.4886364\n3  Dr. B  72 157  Difficult Traditional Sitting  0          None 0.4585987\n4  Dr. B  63 169       Easy   Hamstring Stretch  2          None 0.3727811\n5  Dr. B 114 163 Impossible Traditional Sitting  0          None 0.6993865\n6  Dr. B 121 163  Difficult   Hamstring Stretch  3          None 0.7423313\n7  Dr. D  90 170  Difficult   Hamstring Stretch  2   Paresthesia 0.5294118\n\n\n\nElimina la variable doctor del fichero EPIDURAL.\n\n\nhead(EPIDURAL[,-1])\n\n   kg  cm       ease           treatment oc complications     ratio\n1 116 172  Difficult Traditional Sitting  0          None 0.6744186\n2  86 176       Easy   Hamstring Stretch  0          None 0.4886364\n3  72 157  Difficult Traditional Sitting  0          None 0.4585987\n4  63 169       Easy   Hamstring Stretch  2          None 0.3727811\n5 114 163 Impossible Traditional Sitting  0          None 0.6993865\n6 121 163  Difficult   Hamstring Stretch  3          None 0.7423313\n\n\n\n¿Qué individuos tienen valores de la variable kg menores que 85 kg?\n\n\npos &lt;- which(EPIDURAL$kg&lt;85)\nEPIDURAL[pos,]\n\n   doctor kg  cm      ease           treatment oc              complications\n3   Dr. B 72 157 Difficult Traditional Sitting  0                       None\n4   Dr. B 63 169      Easy   Hamstring Stretch  2                       None\n9   Dr. D 74 166      Easy   Hamstring Stretch  0                       None\n11  Dr. A 67 167      Easy Traditional Sitting  6                       None\n12  Dr. C 65 155      Easy Traditional Sitting  2                       None\n14  Dr. C 48 152      Easy   Hamstring Stretch  0                       None\n16  Dr. C 80 173      Easy   Hamstring Stretch  0                       None\n18  Dr. D 75 157      Easy Traditional Sitting  0                Paresthesia\n19  Dr. D 59 152      Easy   Hamstring Stretch  0                       None\n20  Dr. A 57 165      Easy   Hamstring Stretch  1                       None\n22  Dr. C 83 168      Easy Traditional Sitting  1                       None\n23  Dr. C 71 152      Easy Traditional Sitting  4                       None\n26  Dr. D 74 155      Easy   Hamstring Stretch  0                       None\n28  Dr. A 83 170      Easy Traditional Sitting  1                       None\n30  Dr. B 76 165 Difficult Traditional Sitting  0                    Wet Tap\n31  Dr. D 82 173      Easy   Hamstring Stretch  0                       None\n32  Dr. C 59 168      Easy Traditional Sitting  0                       None\n33  Dr. C 75 173      Easy Traditional Sitting NA Failure - person got dizzy\n34  Dr. A 61 163      Easy Traditional Sitting  1                       None\n36  Dr. A 81 163      Easy Traditional Sitting  1                       None\n39  Dr. D 60 165      Easy Traditional Sitting  0                       None\n42  Dr. D 83 160      Easy Traditional Sitting  0                       None\n43  Dr. D 83 160      Easy Traditional Sitting  0                       None\n45  Dr. A 67 160      Easy Traditional Sitting  1                       None\n47  Dr. A 71 163      Easy Traditional Sitting  1                       None\n48  Dr. A 66 160      Easy   Hamstring Stretch  1                       None\n50  Dr. A 70 165      Easy   Hamstring Stretch  4                       None\n55  Dr. D 67 159      Easy Traditional Sitting  0                       None\n59  Dr. A 84 164 Difficult Traditional Sitting  1                       None\n60  Dr. B 59 157      Easy   Hamstring Stretch  0                       None\n63  Dr. C 74 168      Easy Traditional Sitting  0                       None\n66  Dr. A 80 157 Difficult Traditional Sitting  5                       None\n67  Dr. D 79 163      Easy   Hamstring Stretch  0                       None\n68  Dr. C 84 160      Easy   Hamstring Stretch  0                       None\n69  Dr. A 63 163      Easy Traditional Sitting  0                       None\n71  Dr. A 79 168      Easy   Hamstring Stretch  0                       None\n72  Dr. A 79 160      Easy Traditional Sitting  3                       None\n73  Dr. C 77 157      Easy Traditional Sitting  0                       None\n75  Dr. C 57 160      Easy   Hamstring Stretch  3                       None\n77  Dr. B 79 160 Difficult Traditional Sitting  0                       None\n78  Dr. B 69 157      Easy Traditional Sitting  1                       None\n79  Dr. B 72 170      Easy   Hamstring Stretch  0                       None\n84  Dr. A 72 160      Easy Traditional Sitting  0                       None\n       ratio\n3  0.4585987\n4  0.3727811\n9  0.4457831\n11 0.4011976\n12 0.4193548\n14 0.3157895\n16 0.4624277\n18 0.4777070\n19 0.3881579\n20 0.3454545\n22 0.4940476\n23 0.4671053\n26 0.4774194\n28 0.4882353\n30 0.4606061\n31 0.4739884\n32 0.3511905\n33 0.4335260\n34 0.3742331\n36 0.4969325\n39 0.3636364\n42 0.5187500\n43 0.5187500\n45 0.4187500\n47 0.4355828\n48 0.4125000\n50 0.4242424\n55 0.4213836\n59 0.5121951\n60 0.3757962\n63 0.4404762\n66 0.5095541\n67 0.4846626\n68 0.5250000\n69 0.3865031\n71 0.4702381\n72 0.4937500\n73 0.4904459\n75 0.3562500\n77 0.4937500\n78 0.4394904\n79 0.4235294\n84 0.4500000\n\n\n\n¿Qué individuos tienen valores de la variable cm mayores que 170 cm?\n\n\npos &lt;- which(EPIDURAL$cm&gt;170)\nEPIDURAL[pos,]\n\n   doctor  kg  cm       ease           treatment oc              complications\n1   Dr. B 116 172  Difficult Traditional Sitting  0                       None\n2   Dr. C  86 176       Easy   Hamstring Stretch  0                       None\n10  Dr. C  91 175       Easy   Hamstring Stretch  1                       None\n16  Dr. C  80 173       Easy   Hamstring Stretch  0                       None\n24  Dr. B 108 175 Impossible Traditional Sitting  5                       None\n25  Dr. B  98 176       Easy Traditional Sitting  1                       None\n29  Dr. B  86 175       Easy Traditional Sitting  0                       None\n31  Dr. D  82 173       Easy   Hamstring Stretch  0                       None\n33  Dr. C  75 173       Easy Traditional Sitting NA Failure - person got dizzy\n40  Dr. D  90 171       Easy   Hamstring Stretch  1                       None\n44  Dr. D  89 173       Easy   Hamstring Stretch  0                       None\n51  Dr. C  94 185       Easy Traditional Sitting  0                       None\n54  Dr. D 131 175 Impossible Traditional Sitting  0                       None\n76  Dr. C  96 180       Easy Traditional Sitting  0                       None\n81  Dr. D  89 172  Difficult Traditional Sitting  0                       None\n       ratio\n1  0.6744186\n2  0.4886364\n10 0.5200000\n16 0.4624277\n24 0.6171429\n25 0.5568182\n29 0.4914286\n31 0.4739884\n33 0.4335260\n40 0.5263158\n44 0.5144509\n51 0.5081081\n54 0.7485714\n76 0.5333333\n81 0.5174419\n\n\n\n¿Qué individuos tienen valores de la variable cm mayores que 170 cm o menores que 165 cm?\n\n\npos &lt;- which(EPIDURAL$cm&gt;170 | EPIDURAL$cm&lt;165)\nEPIDURAL[pos,]\n\n   doctor  kg  cm       ease           treatment oc              complications\n1   Dr. B 116 172  Difficult Traditional Sitting  0                       None\n2   Dr. C  86 176       Easy   Hamstring Stretch  0                       None\n3   Dr. B  72 157  Difficult Traditional Sitting  0                       None\n5   Dr. B 114 163 Impossible Traditional Sitting  0                       None\n6   Dr. B 121 163  Difficult   Hamstring Stretch  3                       None\n8   Dr. B  87 164  Difficult Traditional Sitting  6                       None\n10  Dr. C  91 175       Easy   Hamstring Stretch  1                       None\n12  Dr. C  65 155       Easy Traditional Sitting  2                       None\n13  Dr. C  91 163  Difficult   Hamstring Stretch  2                Paresthesia\n14  Dr. C  48 152       Easy   Hamstring Stretch  0                       None\n16  Dr. C  80 173       Easy   Hamstring Stretch  0                       None\n18  Dr. D  75 157       Easy Traditional Sitting  0                Paresthesia\n19  Dr. D  59 152       Easy   Hamstring Stretch  0                       None\n23  Dr. C  71 152       Easy Traditional Sitting  4                       None\n24  Dr. B 108 175 Impossible Traditional Sitting  5                       None\n25  Dr. B  98 176       Easy Traditional Sitting  1                       None\n26  Dr. D  74 155       Easy   Hamstring Stretch  0                       None\n29  Dr. B  86 175       Easy Traditional Sitting  0                       None\n31  Dr. D  82 173       Easy   Hamstring Stretch  0                       None\n33  Dr. C  75 173       Easy Traditional Sitting NA Failure - person got dizzy\n34  Dr. A  61 163       Easy Traditional Sitting  1                       None\n36  Dr. A  81 163       Easy Traditional Sitting  1                       None\n37  Dr. A 103 161       Easy   Hamstring Stretch  1                       None\n40  Dr. D  90 171       Easy   Hamstring Stretch  1                       None\n42  Dr. D  83 160       Easy Traditional Sitting  0                       None\n43  Dr. D  83 160       Easy Traditional Sitting  0                       None\n44  Dr. D  89 173       Easy   Hamstring Stretch  0                       None\n45  Dr. A  67 160       Easy Traditional Sitting  1                       None\n47  Dr. A  71 163       Easy Traditional Sitting  1                       None\n48  Dr. A  66 160       Easy   Hamstring Stretch  1                       None\n51  Dr. C  94 185       Easy Traditional Sitting  0                       None\n52  Dr. C  85 163       Easy   Hamstring Stretch  0                       None\n54  Dr. D 131 175 Impossible Traditional Sitting  0                       None\n55  Dr. D  67 159       Easy Traditional Sitting  0                       None\n56  Dr. B  97 162  Difficult Traditional Sitting  4                       None\n57  Dr. D  93 160       Easy Traditional Sitting  0                       None\n58  Dr. A  90 163       Easy Traditional Sitting  0                       None\n59  Dr. A  84 164  Difficult Traditional Sitting  1                       None\n60  Dr. B  59 157       Easy   Hamstring Stretch  0                       None\n64  Dr. C  92 163       Easy Traditional Sitting  1                       None\n66  Dr. A  80 157  Difficult Traditional Sitting  5                       None\n67  Dr. D  79 163       Easy   Hamstring Stretch  0                       None\n68  Dr. C  84 160       Easy   Hamstring Stretch  0                       None\n69  Dr. A  63 163       Easy Traditional Sitting  0                       None\n72  Dr. A  79 160       Easy Traditional Sitting  3                       None\n73  Dr. C  77 157       Easy Traditional Sitting  0                       None\n75  Dr. C  57 160       Easy   Hamstring Stretch  3                       None\n76  Dr. C  96 180       Easy Traditional Sitting  0                       None\n77  Dr. B  79 160  Difficult Traditional Sitting  0                       None\n78  Dr. B  69 157       Easy Traditional Sitting  1                       None\n81  Dr. D  89 172  Difficult Traditional Sitting  0                       None\n82  Dr. B  86 156 Impossible Traditional Sitting  0                       None\n84  Dr. A  72 160       Easy Traditional Sitting  0                       None\n       ratio\n1  0.6744186\n2  0.4886364\n3  0.4585987\n5  0.6993865\n6  0.7423313\n8  0.5304878\n10 0.5200000\n12 0.4193548\n13 0.5582822\n14 0.3157895\n16 0.4624277\n18 0.4777070\n19 0.3881579\n23 0.4671053\n24 0.6171429\n25 0.5568182\n26 0.4774194\n29 0.4914286\n31 0.4739884\n33 0.4335260\n34 0.3742331\n36 0.4969325\n37 0.6397516\n40 0.5263158\n42 0.5187500\n43 0.5187500\n44 0.5144509\n45 0.4187500\n47 0.4355828\n48 0.4125000\n51 0.5081081\n52 0.5214724\n54 0.7485714\n55 0.4213836\n56 0.5987654\n57 0.5812500\n58 0.5521472\n59 0.5121951\n60 0.3757962\n64 0.5644172\n66 0.5095541\n67 0.4846626\n68 0.5250000\n69 0.3865031\n72 0.4937500\n73 0.4904459\n75 0.3562500\n76 0.5333333\n77 0.4937500\n78 0.4394904\n81 0.5174419\n82 0.5512821\n84 0.4500000\n\n\n\n¿Qué individuos tienen valores de la variable cm mayores que 165 cm y menores que 170 cm?\n\n\npos &lt;- which(EPIDURAL$cm&gt;165 & EPIDURAL$cm&lt;170)\nEPIDURAL[pos,]\n\n   doctor  kg  cm       ease           treatment oc complications     ratio\n4   Dr. B  63 169       Easy   Hamstring Stretch  2          None 0.3727811\n9   Dr. D  74 166       Easy   Hamstring Stretch  0          None 0.4457831\n11  Dr. A  67 167       Easy Traditional Sitting  6          None 0.4011976\n15  Dr. C  85 168       Easy   Hamstring Stretch  2   Paresthesia 0.5059524\n17  Dr. D 114 168 Impossible   Hamstring Stretch  1          None 0.6785714\n22  Dr. C  83 168       Easy Traditional Sitting  1          None 0.4940476\n27  Dr. D 134 169  Difficult Traditional Sitting  1          None 0.7928994\n32  Dr. C  59 168       Easy Traditional Sitting  0          None 0.3511905\n38  Dr. B 113 166  Difficult   Hamstring Stretch  5          None 0.6807229\n46  Dr. C  90 168  Difficult   Hamstring Stretch  0   Paresthesia 0.5357143\n63  Dr. C  74 168       Easy Traditional Sitting  0          None 0.4404762\n65  Dr. D 168 168 Impossible   Hamstring Stretch  2          None 1.0000000\n71  Dr. A  79 168       Easy   Hamstring Stretch  0          None 0.4702381\n80  Dr. D 104 169  Difficult Traditional Sitting  2          None 0.6153846\n\n\n\n\n\n\nCrea un nuevo fichero llamado EPIDURAL2 con aquellas pacientes que pesan menos de 85 kg. ¿Cuántos registros tiene el fichero EPIDURAL2?\n\n\npos &lt;- which(EPIDURAL$kg&lt;85)\nEPIDURAL2 &lt;- EPIDURAL[pos, ]\n\nhead(EPIDURAL2)\n\n   doctor kg  cm      ease           treatment oc complications     ratio\n3   Dr. B 72 157 Difficult Traditional Sitting  0          None 0.4585987\n4   Dr. B 63 169      Easy   Hamstring Stretch  2          None 0.3727811\n9   Dr. D 74 166      Easy   Hamstring Stretch  0          None 0.4457831\n11  Dr. A 67 167      Easy Traditional Sitting  6          None 0.4011976\n12  Dr. C 65 155      Easy Traditional Sitting  2          None 0.4193548\n14  Dr. C 48 152      Easy   Hamstring Stretch  0          None 0.3157895\n\ndim(EPIDURAL2)\n\n[1] 43  8\n\n\n\nCrea un nuevo fichero llamado EPIDURAL3 con aquellas pacientes que miden más de 170 cm. ¿Cuántos registros tiene el fichero EPIDURAL3?\n\n\npos &lt;- which(EPIDURAL$cm&gt;170)\nEPIDURAL3 &lt;- EPIDURAL[pos, ]\n\nhead(EPIDURAL3)\n\n   doctor  kg  cm       ease           treatment oc complications     ratio\n1   Dr. B 116 172  Difficult Traditional Sitting  0          None 0.6744186\n2   Dr. C  86 176       Easy   Hamstring Stretch  0          None 0.4886364\n10  Dr. C  91 175       Easy   Hamstring Stretch  1          None 0.5200000\n16  Dr. C  80 173       Easy   Hamstring Stretch  0          None 0.4624277\n24  Dr. B 108 175 Impossible Traditional Sitting  5          None 0.6171429\n25  Dr. B  98 176       Easy Traditional Sitting  1          None 0.5568182\n\ndim(EPIDURAL3)\n\n[1] 15  8\n\n\n\nCrea un nuevo fichero llamado EPIDURAL4 con aquellas pacientes atendidas por el Doctor A. ¿Cuántos registros tiene el fichero EPIDURAL4?\n\n\npos &lt;- which(EPIDURAL$doctor==\"Dr. A\")\nEPIDURAL4 &lt;- EPIDURAL[pos, ]\n\nhead(EPIDURAL4)\n\n   doctor  kg  cm      ease           treatment oc          complications\n11  Dr. A  67 167      Easy Traditional Sitting  6                   None\n20  Dr. A  57 165      Easy   Hamstring Stretch  1                   None\n21  Dr. A 105 165 Difficult   Hamstring Stretch 10 Failure - too many OCs\n28  Dr. A  83 170      Easy Traditional Sitting  1                   None\n34  Dr. A  61 163      Easy Traditional Sitting  1                   None\n35  Dr. A 106 165      Easy Traditional Sitting  2                   None\n       ratio\n11 0.4011976\n20 0.3454545\n21 0.6363636\n28 0.4882353\n34 0.3742331\n35 0.6424242\n\ndim(EPIDURAL4)\n\n[1] 23  8"
  },
  {
    "objectID": "Practica1.html#trabajar-con-ficheros",
    "href": "Practica1.html#trabajar-con-ficheros",
    "title": "Práctica 1: Lectura y manejo de ficheros",
    "section": "",
    "text": "Carga la librería PASWR2 para trabajar con el fichero EPIDURAL.\n\nlibrary(PASWR2)\n\n\nVisualiza los primeros 6 registros del fichero EPIDURAL con el comando head().\nVisualiza los primeros 20 registros del fichero EPIDURAL con el comando head().\n\n\nhead(EPIDURAL, n=20)\n\n   doctor  kg  cm       ease           treatment oc complications\n1   Dr. B 116 172  Difficult Traditional Sitting  0          None\n2   Dr. C  86 176       Easy   Hamstring Stretch  0          None\n3   Dr. B  72 157  Difficult Traditional Sitting  0          None\n4   Dr. B  63 169       Easy   Hamstring Stretch  2          None\n5   Dr. B 114 163 Impossible Traditional Sitting  0          None\n6   Dr. B 121 163  Difficult   Hamstring Stretch  3          None\n7   Dr. D  90 170  Difficult   Hamstring Stretch  2   Paresthesia\n8   Dr. B  87 164  Difficult Traditional Sitting  6          None\n9   Dr. D  74 166       Easy   Hamstring Stretch  0          None\n10  Dr. C  91 175       Easy   Hamstring Stretch  1          None\n11  Dr. A  67 167       Easy Traditional Sitting  6          None\n12  Dr. C  65 155       Easy Traditional Sitting  2          None\n13  Dr. C  91 163  Difficult   Hamstring Stretch  2   Paresthesia\n14  Dr. C  48 152       Easy   Hamstring Stretch  0          None\n15  Dr. C  85 168       Easy   Hamstring Stretch  2   Paresthesia\n16  Dr. C  80 173       Easy   Hamstring Stretch  0          None\n17  Dr. D 114 168 Impossible   Hamstring Stretch  1          None\n18  Dr. D  75 157       Easy Traditional Sitting  0   Paresthesia\n19  Dr. D  59 152       Easy   Hamstring Stretch  0          None\n20  Dr. A  57 165       Easy   Hamstring Stretch  1          None\n\n\n\nCalcula cuántos registros y cuantas variables tiene el fichero EPIDURAL con el comando dim().\n\n\ndim(EPIDURAL)\n\n[1] 85  7\n\n\n\nCalcula cuántos registros y cuantas variables tiene el fichero EPIDURAL con el comando str().\n\n\nstr(EPIDURAL)\n\n'data.frame':   85 obs. of  7 variables:\n $ doctor       : Factor w/ 4 levels \"Dr. A\",\"Dr. B\",..: 2 3 2 2 2 2 4 2 4 3 ...\n $ kg           : int  116 86 72 63 114 121 90 87 74 91 ...\n $ cm           : int  172 176 157 169 163 163 170 164 166 175 ...\n $ ease         : Factor w/ 3 levels \"Difficult\",\"Easy\",..: 1 2 1 2 3 1 1 1 2 2 ...\n $ treatment    : Factor w/ 2 levels \"Hamstring Stretch\",..: 2 1 2 1 2 1 1 2 1 1 ...\n $ oc           : int  0 0 0 2 0 3 2 6 0 1 ...\n $ complications: Factor w/ 5 levels \"Failure - person got dizzy\",..: 3 3 3 3 3 3 4 3 3 3 ...\n\n\n\n\n\n\nSelecciona la variable doctor del fichero EPIDURAL y visualízala en pantalla.\n\n\nEPIDURAL$doctor\n\n [1] Dr. B Dr. C Dr. B Dr. B Dr. B Dr. B Dr. D Dr. B Dr. D Dr. C Dr. A Dr. C\n[13] Dr. C Dr. C Dr. C Dr. C Dr. D Dr. D Dr. D Dr. A Dr. A Dr. C Dr. C Dr. B\n[25] Dr. B Dr. D Dr. D Dr. A Dr. B Dr. B Dr. D Dr. C Dr. C Dr. A Dr. A Dr. A\n[37] Dr. A Dr. B Dr. D Dr. D Dr. A Dr. D Dr. D Dr. D Dr. A Dr. C Dr. A Dr. A\n[49] Dr. C Dr. A Dr. C Dr. C Dr. B Dr. D Dr. D Dr. B Dr. D Dr. A Dr. A Dr. B\n[61] Dr. B Dr. B Dr. C Dr. C Dr. D Dr. A Dr. D Dr. C Dr. A Dr. A Dr. A Dr. A\n[73] Dr. C Dr. B Dr. C Dr. C Dr. B Dr. B Dr. B Dr. D Dr. D Dr. B Dr. A Dr. A\n[85] Dr. A\nLevels: Dr. A Dr. B Dr. C Dr. D\n\n\n\nSelecciona la variable kg del fichero EPIDURAL y visualízala en pantalla.\n\n\nEPIDURAL$kg\n\n [1] 116  86  72  63 114 121  90  87  74  91  67  65  91  48  85  80 114  75  59\n[20]  57 105  83  71 108  98  74 134  83  86  76  82  59  75  61 106  81 103 113\n[39]  60  90 142  83  83  89  67  90  71  66  95  70  94  85  86 131  67  97  93\n[58]  90  84  59 112  86  74  92 168  80  79  84  63  85  79  79  77  93  57  96\n[77]  79  69  72 104  89  86 103  72  94\n\n\n\nSelecciona la variable cm del fichero EPIDURAL y visualízala en pantalla.\n\n\nEPIDURAL$cm\n\n [1] 172 176 157 169 163 163 170 164 166 175 167 155 163 152 168 173 168 157 152\n[20] 165 165 168 152 175 176 155 169 170 175 165 173 168 173 163 165 163 161 166\n[39] 165 171 170 160 160 173 160 168 163 160 170 165 185 163 165 175 159 162 160\n[58] 163 164 157 170 170 168 163 168 157 163 160 163 165 168 160 157 170 160 180\n[77] 160 157 170 169 172 156 170 160 165\n\n\n\nCrea una nueva variable llamada ratio definida como el cociente entre kg/cm. Añádela al fichero EPIDURAL\n\n\nEPIDURAL$ratio &lt;- EPIDURAL$kg/EPIDURAL$cm\n\nhead(EPIDURAL)\n\n  doctor  kg  cm       ease           treatment oc complications     ratio\n1  Dr. B 116 172  Difficult Traditional Sitting  0          None 0.6744186\n2  Dr. C  86 176       Easy   Hamstring Stretch  0          None 0.4886364\n3  Dr. B  72 157  Difficult Traditional Sitting  0          None 0.4585987\n4  Dr. B  63 169       Easy   Hamstring Stretch  2          None 0.3727811\n5  Dr. B 114 163 Impossible Traditional Sitting  0          None 0.6993865\n6  Dr. B 121 163  Difficult   Hamstring Stretch  3          None 0.7423313\n\n\n\nSelecciona la paciente número 19 del fichero EPIDURAL. Visualízala por pantalla y averigua cuánto pesa y cuánto mide.\n\n\nEPIDURAL[19, ]\n\n   doctor kg  cm ease         treatment oc complications     ratio\n19  Dr. D 59 152 Easy Hamstring Stretch  0          None 0.3881579\n\n\n\nElimina la paciente 1 del fichero EPIDURAL.\n\n\nhead(EPIDURAL[-1, ])\n\n  doctor  kg  cm       ease           treatment oc complications     ratio\n2  Dr. C  86 176       Easy   Hamstring Stretch  0          None 0.4886364\n3  Dr. B  72 157  Difficult Traditional Sitting  0          None 0.4585987\n4  Dr. B  63 169       Easy   Hamstring Stretch  2          None 0.3727811\n5  Dr. B 114 163 Impossible Traditional Sitting  0          None 0.6993865\n6  Dr. B 121 163  Difficult   Hamstring Stretch  3          None 0.7423313\n7  Dr. D  90 170  Difficult   Hamstring Stretch  2   Paresthesia 0.5294118\n\n\n\nElimina la variable doctor del fichero EPIDURAL.\n\n\nhead(EPIDURAL[,-1])\n\n   kg  cm       ease           treatment oc complications     ratio\n1 116 172  Difficult Traditional Sitting  0          None 0.6744186\n2  86 176       Easy   Hamstring Stretch  0          None 0.4886364\n3  72 157  Difficult Traditional Sitting  0          None 0.4585987\n4  63 169       Easy   Hamstring Stretch  2          None 0.3727811\n5 114 163 Impossible Traditional Sitting  0          None 0.6993865\n6 121 163  Difficult   Hamstring Stretch  3          None 0.7423313\n\n\n\n¿Qué individuos tienen valores de la variable kg menores que 85 kg?\n\n\npos &lt;- which(EPIDURAL$kg&lt;85)\nEPIDURAL[pos,]\n\n   doctor kg  cm      ease           treatment oc              complications\n3   Dr. B 72 157 Difficult Traditional Sitting  0                       None\n4   Dr. B 63 169      Easy   Hamstring Stretch  2                       None\n9   Dr. D 74 166      Easy   Hamstring Stretch  0                       None\n11  Dr. A 67 167      Easy Traditional Sitting  6                       None\n12  Dr. C 65 155      Easy Traditional Sitting  2                       None\n14  Dr. C 48 152      Easy   Hamstring Stretch  0                       None\n16  Dr. C 80 173      Easy   Hamstring Stretch  0                       None\n18  Dr. D 75 157      Easy Traditional Sitting  0                Paresthesia\n19  Dr. D 59 152      Easy   Hamstring Stretch  0                       None\n20  Dr. A 57 165      Easy   Hamstring Stretch  1                       None\n22  Dr. C 83 168      Easy Traditional Sitting  1                       None\n23  Dr. C 71 152      Easy Traditional Sitting  4                       None\n26  Dr. D 74 155      Easy   Hamstring Stretch  0                       None\n28  Dr. A 83 170      Easy Traditional Sitting  1                       None\n30  Dr. B 76 165 Difficult Traditional Sitting  0                    Wet Tap\n31  Dr. D 82 173      Easy   Hamstring Stretch  0                       None\n32  Dr. C 59 168      Easy Traditional Sitting  0                       None\n33  Dr. C 75 173      Easy Traditional Sitting NA Failure - person got dizzy\n34  Dr. A 61 163      Easy Traditional Sitting  1                       None\n36  Dr. A 81 163      Easy Traditional Sitting  1                       None\n39  Dr. D 60 165      Easy Traditional Sitting  0                       None\n42  Dr. D 83 160      Easy Traditional Sitting  0                       None\n43  Dr. D 83 160      Easy Traditional Sitting  0                       None\n45  Dr. A 67 160      Easy Traditional Sitting  1                       None\n47  Dr. A 71 163      Easy Traditional Sitting  1                       None\n48  Dr. A 66 160      Easy   Hamstring Stretch  1                       None\n50  Dr. A 70 165      Easy   Hamstring Stretch  4                       None\n55  Dr. D 67 159      Easy Traditional Sitting  0                       None\n59  Dr. A 84 164 Difficult Traditional Sitting  1                       None\n60  Dr. B 59 157      Easy   Hamstring Stretch  0                       None\n63  Dr. C 74 168      Easy Traditional Sitting  0                       None\n66  Dr. A 80 157 Difficult Traditional Sitting  5                       None\n67  Dr. D 79 163      Easy   Hamstring Stretch  0                       None\n68  Dr. C 84 160      Easy   Hamstring Stretch  0                       None\n69  Dr. A 63 163      Easy Traditional Sitting  0                       None\n71  Dr. A 79 168      Easy   Hamstring Stretch  0                       None\n72  Dr. A 79 160      Easy Traditional Sitting  3                       None\n73  Dr. C 77 157      Easy Traditional Sitting  0                       None\n75  Dr. C 57 160      Easy   Hamstring Stretch  3                       None\n77  Dr. B 79 160 Difficult Traditional Sitting  0                       None\n78  Dr. B 69 157      Easy Traditional Sitting  1                       None\n79  Dr. B 72 170      Easy   Hamstring Stretch  0                       None\n84  Dr. A 72 160      Easy Traditional Sitting  0                       None\n       ratio\n3  0.4585987\n4  0.3727811\n9  0.4457831\n11 0.4011976\n12 0.4193548\n14 0.3157895\n16 0.4624277\n18 0.4777070\n19 0.3881579\n20 0.3454545\n22 0.4940476\n23 0.4671053\n26 0.4774194\n28 0.4882353\n30 0.4606061\n31 0.4739884\n32 0.3511905\n33 0.4335260\n34 0.3742331\n36 0.4969325\n39 0.3636364\n42 0.5187500\n43 0.5187500\n45 0.4187500\n47 0.4355828\n48 0.4125000\n50 0.4242424\n55 0.4213836\n59 0.5121951\n60 0.3757962\n63 0.4404762\n66 0.5095541\n67 0.4846626\n68 0.5250000\n69 0.3865031\n71 0.4702381\n72 0.4937500\n73 0.4904459\n75 0.3562500\n77 0.4937500\n78 0.4394904\n79 0.4235294\n84 0.4500000\n\n\n\n¿Qué individuos tienen valores de la variable cm mayores que 170 cm?\n\n\npos &lt;- which(EPIDURAL$cm&gt;170)\nEPIDURAL[pos,]\n\n   doctor  kg  cm       ease           treatment oc              complications\n1   Dr. B 116 172  Difficult Traditional Sitting  0                       None\n2   Dr. C  86 176       Easy   Hamstring Stretch  0                       None\n10  Dr. C  91 175       Easy   Hamstring Stretch  1                       None\n16  Dr. C  80 173       Easy   Hamstring Stretch  0                       None\n24  Dr. B 108 175 Impossible Traditional Sitting  5                       None\n25  Dr. B  98 176       Easy Traditional Sitting  1                       None\n29  Dr. B  86 175       Easy Traditional Sitting  0                       None\n31  Dr. D  82 173       Easy   Hamstring Stretch  0                       None\n33  Dr. C  75 173       Easy Traditional Sitting NA Failure - person got dizzy\n40  Dr. D  90 171       Easy   Hamstring Stretch  1                       None\n44  Dr. D  89 173       Easy   Hamstring Stretch  0                       None\n51  Dr. C  94 185       Easy Traditional Sitting  0                       None\n54  Dr. D 131 175 Impossible Traditional Sitting  0                       None\n76  Dr. C  96 180       Easy Traditional Sitting  0                       None\n81  Dr. D  89 172  Difficult Traditional Sitting  0                       None\n       ratio\n1  0.6744186\n2  0.4886364\n10 0.5200000\n16 0.4624277\n24 0.6171429\n25 0.5568182\n29 0.4914286\n31 0.4739884\n33 0.4335260\n40 0.5263158\n44 0.5144509\n51 0.5081081\n54 0.7485714\n76 0.5333333\n81 0.5174419\n\n\n\n¿Qué individuos tienen valores de la variable cm mayores que 170 cm o menores que 165 cm?\n\n\npos &lt;- which(EPIDURAL$cm&gt;170 | EPIDURAL$cm&lt;165)\nEPIDURAL[pos,]\n\n   doctor  kg  cm       ease           treatment oc              complications\n1   Dr. B 116 172  Difficult Traditional Sitting  0                       None\n2   Dr. C  86 176       Easy   Hamstring Stretch  0                       None\n3   Dr. B  72 157  Difficult Traditional Sitting  0                       None\n5   Dr. B 114 163 Impossible Traditional Sitting  0                       None\n6   Dr. B 121 163  Difficult   Hamstring Stretch  3                       None\n8   Dr. B  87 164  Difficult Traditional Sitting  6                       None\n10  Dr. C  91 175       Easy   Hamstring Stretch  1                       None\n12  Dr. C  65 155       Easy Traditional Sitting  2                       None\n13  Dr. C  91 163  Difficult   Hamstring Stretch  2                Paresthesia\n14  Dr. C  48 152       Easy   Hamstring Stretch  0                       None\n16  Dr. C  80 173       Easy   Hamstring Stretch  0                       None\n18  Dr. D  75 157       Easy Traditional Sitting  0                Paresthesia\n19  Dr. D  59 152       Easy   Hamstring Stretch  0                       None\n23  Dr. C  71 152       Easy Traditional Sitting  4                       None\n24  Dr. B 108 175 Impossible Traditional Sitting  5                       None\n25  Dr. B  98 176       Easy Traditional Sitting  1                       None\n26  Dr. D  74 155       Easy   Hamstring Stretch  0                       None\n29  Dr. B  86 175       Easy Traditional Sitting  0                       None\n31  Dr. D  82 173       Easy   Hamstring Stretch  0                       None\n33  Dr. C  75 173       Easy Traditional Sitting NA Failure - person got dizzy\n34  Dr. A  61 163       Easy Traditional Sitting  1                       None\n36  Dr. A  81 163       Easy Traditional Sitting  1                       None\n37  Dr. A 103 161       Easy   Hamstring Stretch  1                       None\n40  Dr. D  90 171       Easy   Hamstring Stretch  1                       None\n42  Dr. D  83 160       Easy Traditional Sitting  0                       None\n43  Dr. D  83 160       Easy Traditional Sitting  0                       None\n44  Dr. D  89 173       Easy   Hamstring Stretch  0                       None\n45  Dr. A  67 160       Easy Traditional Sitting  1                       None\n47  Dr. A  71 163       Easy Traditional Sitting  1                       None\n48  Dr. A  66 160       Easy   Hamstring Stretch  1                       None\n51  Dr. C  94 185       Easy Traditional Sitting  0                       None\n52  Dr. C  85 163       Easy   Hamstring Stretch  0                       None\n54  Dr. D 131 175 Impossible Traditional Sitting  0                       None\n55  Dr. D  67 159       Easy Traditional Sitting  0                       None\n56  Dr. B  97 162  Difficult Traditional Sitting  4                       None\n57  Dr. D  93 160       Easy Traditional Sitting  0                       None\n58  Dr. A  90 163       Easy Traditional Sitting  0                       None\n59  Dr. A  84 164  Difficult Traditional Sitting  1                       None\n60  Dr. B  59 157       Easy   Hamstring Stretch  0                       None\n64  Dr. C  92 163       Easy Traditional Sitting  1                       None\n66  Dr. A  80 157  Difficult Traditional Sitting  5                       None\n67  Dr. D  79 163       Easy   Hamstring Stretch  0                       None\n68  Dr. C  84 160       Easy   Hamstring Stretch  0                       None\n69  Dr. A  63 163       Easy Traditional Sitting  0                       None\n72  Dr. A  79 160       Easy Traditional Sitting  3                       None\n73  Dr. C  77 157       Easy Traditional Sitting  0                       None\n75  Dr. C  57 160       Easy   Hamstring Stretch  3                       None\n76  Dr. C  96 180       Easy Traditional Sitting  0                       None\n77  Dr. B  79 160  Difficult Traditional Sitting  0                       None\n78  Dr. B  69 157       Easy Traditional Sitting  1                       None\n81  Dr. D  89 172  Difficult Traditional Sitting  0                       None\n82  Dr. B  86 156 Impossible Traditional Sitting  0                       None\n84  Dr. A  72 160       Easy Traditional Sitting  0                       None\n       ratio\n1  0.6744186\n2  0.4886364\n3  0.4585987\n5  0.6993865\n6  0.7423313\n8  0.5304878\n10 0.5200000\n12 0.4193548\n13 0.5582822\n14 0.3157895\n16 0.4624277\n18 0.4777070\n19 0.3881579\n23 0.4671053\n24 0.6171429\n25 0.5568182\n26 0.4774194\n29 0.4914286\n31 0.4739884\n33 0.4335260\n34 0.3742331\n36 0.4969325\n37 0.6397516\n40 0.5263158\n42 0.5187500\n43 0.5187500\n44 0.5144509\n45 0.4187500\n47 0.4355828\n48 0.4125000\n51 0.5081081\n52 0.5214724\n54 0.7485714\n55 0.4213836\n56 0.5987654\n57 0.5812500\n58 0.5521472\n59 0.5121951\n60 0.3757962\n64 0.5644172\n66 0.5095541\n67 0.4846626\n68 0.5250000\n69 0.3865031\n72 0.4937500\n73 0.4904459\n75 0.3562500\n76 0.5333333\n77 0.4937500\n78 0.4394904\n81 0.5174419\n82 0.5512821\n84 0.4500000\n\n\n\n¿Qué individuos tienen valores de la variable cm mayores que 165 cm y menores que 170 cm?\n\n\npos &lt;- which(EPIDURAL$cm&gt;165 & EPIDURAL$cm&lt;170)\nEPIDURAL[pos,]\n\n   doctor  kg  cm       ease           treatment oc complications     ratio\n4   Dr. B  63 169       Easy   Hamstring Stretch  2          None 0.3727811\n9   Dr. D  74 166       Easy   Hamstring Stretch  0          None 0.4457831\n11  Dr. A  67 167       Easy Traditional Sitting  6          None 0.4011976\n15  Dr. C  85 168       Easy   Hamstring Stretch  2   Paresthesia 0.5059524\n17  Dr. D 114 168 Impossible   Hamstring Stretch  1          None 0.6785714\n22  Dr. C  83 168       Easy Traditional Sitting  1          None 0.4940476\n27  Dr. D 134 169  Difficult Traditional Sitting  1          None 0.7928994\n32  Dr. C  59 168       Easy Traditional Sitting  0          None 0.3511905\n38  Dr. B 113 166  Difficult   Hamstring Stretch  5          None 0.6807229\n46  Dr. C  90 168  Difficult   Hamstring Stretch  0   Paresthesia 0.5357143\n63  Dr. C  74 168       Easy Traditional Sitting  0          None 0.4404762\n65  Dr. D 168 168 Impossible   Hamstring Stretch  2          None 1.0000000\n71  Dr. A  79 168       Easy   Hamstring Stretch  0          None 0.4702381\n80  Dr. D 104 169  Difficult Traditional Sitting  2          None 0.6153846\n\n\n\n\n\n\nCrea un nuevo fichero llamado EPIDURAL2 con aquellas pacientes que pesan menos de 85 kg. ¿Cuántos registros tiene el fichero EPIDURAL2?\n\n\npos &lt;- which(EPIDURAL$kg&lt;85)\nEPIDURAL2 &lt;- EPIDURAL[pos, ]\n\nhead(EPIDURAL2)\n\n   doctor kg  cm      ease           treatment oc complications     ratio\n3   Dr. B 72 157 Difficult Traditional Sitting  0          None 0.4585987\n4   Dr. B 63 169      Easy   Hamstring Stretch  2          None 0.3727811\n9   Dr. D 74 166      Easy   Hamstring Stretch  0          None 0.4457831\n11  Dr. A 67 167      Easy Traditional Sitting  6          None 0.4011976\n12  Dr. C 65 155      Easy Traditional Sitting  2          None 0.4193548\n14  Dr. C 48 152      Easy   Hamstring Stretch  0          None 0.3157895\n\ndim(EPIDURAL2)\n\n[1] 43  8\n\n\n\nCrea un nuevo fichero llamado EPIDURAL3 con aquellas pacientes que miden más de 170 cm. ¿Cuántos registros tiene el fichero EPIDURAL3?\n\n\npos &lt;- which(EPIDURAL$cm&gt;170)\nEPIDURAL3 &lt;- EPIDURAL[pos, ]\n\nhead(EPIDURAL3)\n\n   doctor  kg  cm       ease           treatment oc complications     ratio\n1   Dr. B 116 172  Difficult Traditional Sitting  0          None 0.6744186\n2   Dr. C  86 176       Easy   Hamstring Stretch  0          None 0.4886364\n10  Dr. C  91 175       Easy   Hamstring Stretch  1          None 0.5200000\n16  Dr. C  80 173       Easy   Hamstring Stretch  0          None 0.4624277\n24  Dr. B 108 175 Impossible Traditional Sitting  5          None 0.6171429\n25  Dr. B  98 176       Easy Traditional Sitting  1          None 0.5568182\n\ndim(EPIDURAL3)\n\n[1] 15  8\n\n\n\nCrea un nuevo fichero llamado EPIDURAL4 con aquellas pacientes atendidas por el Doctor A. ¿Cuántos registros tiene el fichero EPIDURAL4?\n\n\npos &lt;- which(EPIDURAL$doctor==\"Dr. A\")\nEPIDURAL4 &lt;- EPIDURAL[pos, ]\n\nhead(EPIDURAL4)\n\n   doctor  kg  cm      ease           treatment oc          complications\n11  Dr. A  67 167      Easy Traditional Sitting  6                   None\n20  Dr. A  57 165      Easy   Hamstring Stretch  1                   None\n21  Dr. A 105 165 Difficult   Hamstring Stretch 10 Failure - too many OCs\n28  Dr. A  83 170      Easy Traditional Sitting  1                   None\n34  Dr. A  61 163      Easy Traditional Sitting  1                   None\n35  Dr. A 106 165      Easy Traditional Sitting  2                   None\n       ratio\n11 0.4011976\n20 0.3454545\n21 0.6363636\n28 0.4882353\n34 0.3742331\n35 0.6424242\n\ndim(EPIDURAL4)\n\n[1] 23  8"
  },
  {
    "objectID": "Practica1.html#lectura-de-ficheros-externos",
    "href": "Practica1.html#lectura-de-ficheros-externos",
    "title": "Práctica 1: Lectura y manejo de ficheros",
    "section": "2. Lectura de ficheros externos",
    "text": "2. Lectura de ficheros externos\n\nDescarga el fichero Bodyfat.txt desde MiAulario, léelo en R y almacénalo en un objeto llamado datos. Imprímelo por pantalla.\n\n\ndatos &lt;- read.table(\"BodyFat.txt\", header=TRUE)\ndatos\n\n   age  fat sex\n1   23  9.5   M\n2   23 27.9   F\n3   27  7.8   M\n4   27 17.8   M\n5   39 31.4   F\n6   41 25.9   F\n7   45 27.4   M\n8   49 25.2   F\n9   50 31.1   F\n10  53 34.7   F\n11  53 42.0   F\n12  54 29.1   F\n13  56 32.5   F\n14  57 30.3   F\n15  58 33.0   F\n16  58 33.8   F\n17  60 41.1   F\n18  61 34.5   F\n\n\n\nDescarga el fichero Bodyfat.xlsx desde MiAulario, léelo en R y almacénalo en un objeto llamado datos2. Imprímelo por pantalla.\n\n\nlibrary(xlsx)\n\ndatos2 &lt;- read.xlsx(\"Bodyfat.xlsx\", sheetIndex=\"Hoja1\")\ndatos2\n\n   age  fat sex\n1   23  9.5   M\n2   23 27.9   F\n3   27  7.8   M\n4   27 17.8   M\n5   39 31.4   F\n6   41 25.9   F\n7   45 27.4   M\n8   49 25.2   F\n9   50 31.1   F\n10  53 34.7   F\n11  53 42.0   F\n12  54 29.1   F\n13  56 32.5   F\n14  57 30.3   F\n15  58 33.0   F\n16  58 33.8   F\n17  60 41.1   F\n18  61 34.5   F"
  },
  {
    "objectID": "Practica1.html#realiza-los-siguientes-ejercicios",
    "href": "Practica1.html#realiza-los-siguientes-ejercicios",
    "title": "Práctica 1: Lectura y manejo de ficheros",
    "section": "3. Realiza los siguientes ejercicios",
    "text": "3. Realiza los siguientes ejercicios\n\nCon el fichero datos, visualiza en pantalla la variable fat.\n\n\ndatos$fat\n\n [1]  9.5 27.9  7.8 17.8 31.4 25.9 27.4 25.2 31.1 34.7 42.0 29.1 32.5 30.3 33.0\n[16] 33.8 41.1 34.5\n\n\n\nSelecciona las observaciones de las variable fat cuyo valor sea menor que 25 y guárdalas en un objeto llamado low.fat.\n\n\npos &lt;- which(datos$fat&lt;25)\nlow.fat &lt;- datos[pos,\"fat\"]\n\nlow.fat\n\n[1]  9.5  7.8 17.8\n\n\n\nUtiliza el comando table para averiguar cuántos hombres y mujeres hay en el fichero datos.\n\n\ntable(datos$sex)\n\n\n F  M \n14  4 \n\n\n\nHaz un summary del fichero datos.\n\n\nsummary(datos)\n\n      age             fat            sex           \n Min.   :23.00   Min.   : 7.80   Length:18         \n 1st Qu.:39.50   1st Qu.:26.27   Class :character  \n Median :51.50   Median :30.70   Mode  :character  \n Mean   :46.33   Mean   :28.61                     \n 3rd Qu.:56.75   3rd Qu.:33.60                     \n Max.   :61.00   Max.   :42.00                     \n\n\n\nElimina la variable fat del fichero datos.\n\n\ndatos[,-2]\n\n   age sex\n1   23   M\n2   23   F\n3   27   M\n4   27   M\n5   39   F\n6   41   F\n7   45   M\n8   49   F\n9   50   F\n10  53   F\n11  53   F\n12  54   F\n13  56   F\n14  57   F\n15  58   F\n16  58   F\n17  60   F\n18  61   F\n\n\n\nElimina las observaciones 7, 9 y 15 del fichero datos.\n\n\ndatos[-c(7,9,15),]\n\n   age  fat sex\n1   23  9.5   M\n2   23 27.9   F\n3   27  7.8   M\n4   27 17.8   M\n5   39 31.4   F\n6   41 25.9   F\n8   49 25.2   F\n10  53 34.7   F\n11  53 42.0   F\n12  54 29.1   F\n13  56 32.5   F\n14  57 30.3   F\n16  58 33.8   F\n17  60 41.1   F\n18  61 34.5   F\n\n\n\nUtiliza la función eda() del paquete PASWR2 para realizar un análisis exploratorio de la variable fat.\n\n\neda(datos$fat)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n  18.000    0.000    7.800   26.275   28.611   30.700   28.611   33.600 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n  42.000    9.144   83.620    2.155    7.325   34.200    0.141   -0.888 \nSW p-val \n   0.043 \n\n\nDescargar plantilla RMarkdown"
  },
  {
    "objectID": "Practica3.html",
    "href": "Practica3.html",
    "title": "Práctica 3: Contrastes de hipótesis paramétricos y análisis de la varianza",
    "section": "",
    "text": "Descripción\nEn esta práctica vamos a trabajar con el fichero de datos diabetes.\n\nEl fichero de datos contiene 19 variables medidas sobre 403 pacientes. Estos pacientes forman parte de un estudio con 1046 sujetos diseñado para investigar la prevalencia de la de obesidad, diabetes, y otros factores de riesgo cardiovasculares para Afroamericanos en Virginia, EEUU.\nSegún Dr John Hong, Diabetes Mellitus Tipo II está asociada con la obesidad. El índice cintura-cadera puede ser un predictor en diabetes y enfermedades de corazón.\nDiabetes Mellitus Tipo II está también asociada con hipertensión y ambos pueden ser parte del “Síndrome X”.\nLos 403 sujetos del estudio son aquellos a los que se les hizo un seguimiento de diabetes. La hemoglobina glicosilada &gt;7.0 se toma normalmente como diagnóstico positivo de diabetes.\n\nEl fichero original puede descargarse de la web: http://biostat.mc.vanderbilt.edu/wiki/Main/DataSets\nPara más información ver el paper: Willems JP, Saunders JT, DE Hunt, JB Schorling. Prevalence of coronary heart disease risk factors among rural blacks: A community-based study. Southern Medical Journal 90: 814-820; 1997. https://europepmc.org/abstract/med/9258308\nEstas son las variables que contiene el fichero (se han eliminado alguna del fichero original y se han reemplazado algunos valores perdidos):\n\n\n\nVariable\nDescripción\n\n\n\n\nid\nSubject ID\n\n\nchol\nTotal Cholesterol (mg/dL)\n\n\nstab.glu\nStabilized Glucose (mg/dL)\n\n\nhdl\nHigh Density Lipoprotein (mg/dL)\n\n\nratio\nCholesterol/HDL Ratio\n\n\nglyhb\nGlycosolated Hemoglobin (%)\n\n\nlocation\nBuckingham or Louisa\n\n\nage\nAge of patient (years)\n\n\ngender\nMale or Female\n\n\nheight\nHeight (inches)\n\n\nweight\nWeight (pounds)\n\n\nframe\nBody frame size (small, medium, large)\n\n\nbp.1s\nFirst Systolic Blood Pressure (mmHg)\n\n\nbp.1d\nFirst Diastolic Blood Pressure (mmHg)\n\n\nwaist\nWaistline (inches)\n\n\nhip\nHip measurement (inches)\n\n\n\nEn primer lugar, cargamos la librería PASWR2 y leemos el fichero diabetes en R:\n\nlibrary(PASWR2)\n\ndiabetes &lt;- read.table(\"diabetes.txt\", header=TRUE, sep=\"\", dec=\".\", stringsAsFactors=TRUE)\nhead(diabetes)\n\n    id chol stab.glu hdl ratio glyhb   location age gender height weight  frame\n1 1000  203       82  56   3.6  4.31 Buckingham  46 female     62    121 medium\n2 1001  165       97  24   6.9  4.44 Buckingham  29 female     64    218  large\n3 1002  228       92  37   6.2  4.64 Buckingham  58 female     61    256  large\n4 1003   78       93  12   6.5  4.63 Buckingham  67   male     67    119  large\n5 1005  249       90  28   8.9  7.72 Buckingham  64   male     68    183 medium\n6 1008  248       94  69   3.6  4.81 Buckingham  34   male     71    190  large\n  bp.1s bp.1d waist hip\n1   118    59    29  38\n2   112    68    46  48\n3   190    92    49  57\n4   110    50    33  38\n5   138    80    44  41\n6   132    86    36  42\n\n\n\n\n1. Contraste paramétricos\n\n1.1. Contrasta al nivel de significación \\(\\alpha=0.05\\) si el nivel medio de colesterol en los hombres del condado de Buckingham es superior a 200mg/dL. Justifica si puedes asumir normalidad.\nDefimos la variable \\[X=\\mbox{\"Nivel de colesterol (mg/dL) en los hombres del condado de Buckingham\"}\\]\n\n## Seleccionamos los datos ##\npos &lt;- which(diabetes$gender==\"male\" & diabetes$location==\"Buckingham\")\nchol.manB &lt;- diabetes$chol[pos]  \n\n## Comprobamos la condición de normalidad ##\neda(chol.manB)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n  86.000    0.000   78.000  174.000  203.603  197.500  202.536  230.750 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n 347.000   44.598 1988.956    4.809   56.750  269.000    0.677    0.402 \nSW p-val \n   0.208 \n\n\nRealizamos el contraste de hipótesis (\\(\\alpha=0.05\\)) \\[\\begin{eqnarray*}\nH_0: \\, \\mu=200 \\\\\nH_1: \\, \\mu&gt;200 \\\\\n\\end{eqnarray*}\\]\n\nt.test(chol.manB, mu=200, conf.level=0.95, alternative=\"greater\")\n\n\n    One Sample t-test\n\ndata:  chol.manB\nt = 0.74918, df = 85, p-value = 0.2279\nalternative hypothesis: true mean is greater than 200\n95 percent confidence interval:\n 195.6054      Inf\nsample estimates:\nmean of x \n 203.6029 \n\n\nInterpretación: Como el p-valor=0.228\\(&gt; \\alpha=0.05 \\Rightarrow\\) No rechazar \\(H_0\\).\nEs decir, con un nivel de significación de 5%, no podemos afirmar que el nivel medio de colesterol en los hombres del condado de Buckingham es superior a 200mg/dL.\n\n\n1.2. Calcula la potencia del contraste anterior si el verdadero nivel medio de colesterol en los hombres del condado de Buckingham es 210 mg/dL. ¿Cuantas observaciones necesitarías en tu muestra para obtener una potencia de 0.9?\n\npower.t.test(n=length(chol.manB), delta=210-200, sd=sd(chol.manB),\n             sig.level=0.05, type=\"one.sample\", alternative=\"two.sided\")\n\n\n     One-sample t test power calculation \n\n              n = 86\n          delta = 10\n             sd = 44.59771\n      sig.level = 0.05\n          power = 0.5382013\n    alternative = two.sided\n\n\nInterpretación: Si el verdadero nivel medio de colesterol en los hombres del condado de Buckingham es 210 mg/dL, la probabilidad de rechazar la hipótesis nula en el test anterior (\\(H1: \\, \\mu&gt;200\\)) es de 0.538.\n\npower.t.test(power=0.9, delta=210-200, sd=sd(chol.manB),\n             sig.level=0.05, type=\"one.sample\", alternative=\"two.sided\")\n\n\n     One-sample t test power calculation \n\n              n = 210.9181\n          delta = 10\n             sd = 44.59771\n      sig.level = 0.05\n          power = 0.9\n    alternative = two.sided\n\n\nInterpretación: Si el verdadero nivel medio de colesterol en los hombres del condado de Buckingham es 210 mg/dL, el tamaño de muestra necesario para obtener una potencia de 0.9 en el test anterior es \\(n \\geq 211\\).\n\n\n1.3. Contrasta al nivel de significación \\(\\alpha=0.10\\), si la presión diastólica media de los hombres es distinta a la presión diastólica media de las mujeres.\nDefinimos las variables \\[X=\\mbox{\"Presión diastólica (mmHg) de los hombres\"}\\] \\[Y=\\mbox{\"Presión diastólica (mmHg) de la mujeres\"}\\]\n\nComprueba que las dos muestras provienen de poblaciones normales.\n\n\n## Seleccionamos los datos de los hombres ##\npos1 &lt;- which(diabetes$gender==\"male\")\nbp1d.male &lt;- diabetes$bp.1d[pos1]\n\neda(bp1d.male)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n 169.000    0.000   50.000   76.000   84.465   82.000   84.200   92.000 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n 122.000   13.504  182.347    1.039   16.000   72.000    0.124    0.351 \nSW p-val \n   0.058 \n\n## Seleccionamos los datos de las mujeres ##\npos2 &lt;- which(diabetes$gender==\"female\")\nbp1d.female &lt;-diabetes$bp.1d[pos2]\n\neda(bp1d.female)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n 234.000    0.000   48.000   72.000   82.496   82.000   82.269   90.000 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n 124.000   13.474  181.535    0.881   18.000   76.000   -0.014    0.216 \nSW p-val \n   0.232 \n\n\n\n¿Podemos asumir que las varianzas son iguales?\n\n\n## Gráfico exploratorio ##\nboxplot(bp.1d ~ gender, data=diabetes)\n\n\n\n## Test para la igualdad de varianzas ##\nvar.test(bp1d.male, bp1d.female, ratio=1, alternative=\"two.sided\")\n\n\n    F test to compare two variances\n\ndata:  bp1d.male and bp1d.female\nF = 1.0045, num df = 168, denom df = 233, p-value = 0.969\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.7605823 1.3352151\nsample estimates:\nratio of variances \n          1.004471 \n\n\nComo p-valor=0.969&gt;0.05, no podemos rechazar la hipótesis nula de igualdad de varianzas.\n\nRealiza el correspondiente test de medias. \\[\\begin{eqnarray*}\nH_0: \\, \\mu_X-\\mu_Y=0 \\\\\nH_1: \\, \\mu_X-\\mu_Y \\neq 0 \\\\\n\\end{eqnarray*}\\]\n\n\nt.test(bp1d.male, bp1d.female, mu=0, var.equal=TRUE, alternative=\"two.sided\", conf.level=0.9)\n\n\n    Two Sample t-test\n\ndata:  bp1d.male and bp1d.female\nt = 1.4469, df = 401, p-value = 0.1487\nalternative hypothesis: true difference in means is not equal to 0\n90 percent confidence interval:\n -0.2747344  4.2142710\nsample estimates:\nmean of x mean of y \n 84.46534  82.49558 \n\n\nInterpretación: Como el p-valor=0.149\\(&gt; \\alpha=0.10 \\Rightarrow\\) No rechazar \\(H_0\\).\nEs decir, con un nivel de significación de 10%, no podemos afirmar que la presión diastólica media de los hombres sea distinta a la presión diastólica media de las mujeres.\n\n\n1.4. Se dispone de dos aparatos, uno nuevo y otro antiguo, para medir los niveles de glucosa en sangre. Los médicos sospechan que el nuevo aparato proporciona niveles de glucosa en sangre superiores al antiguo. Se dispone de una muestra con 15 pacientes diabéticos a los que se les ha medido los niveles de glucosa con los dos aparatos. Las medidas se encuentran en el fichero GLUCOSE de la librería PASWR2.\n\n## Cargamos los datos ##\ndata(GLUCOSE)\nprint(GLUCOSE)\n\n   patient    old    new\n1        1 182.47 195.64\n2        2 175.53 196.31\n3        3 181.71 190.33\n4        4 179.03 192.90\n5        5 177.28 193.24\n6        6 177.49 193.05\n7        7 179.54 193.87\n8        8 185.12 196.39\n9        9 179.04 195.25\n10      10 180.50 194.48\n11      11 182.15 197.33\n12      12 183.55 193.81\n13      13 180.86 198.03\n14      14 180.82 193.31\n15      15 178.88 198.43\n\n\n\n¿Son las muestras independientes?\n\nSean \\[X=\\mbox{\"Nivel de glucosa (mg/dL) en sangre con el aparato nuevo\"}\\] \\[Y=\\mbox{\"Nivel de glucosa (mg/dL) en sangre con el aparato viejo\"}\\]\n\n## Las muestras NO son independientes (mismos individuos) ##\nd &lt;- GLUCOSE$new - GLUCOSE$old\n\n\nComprueba si puede asumirse la hipótesis de normalidad.\n\n\neda(d)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n  15.000    0.000    8.620   12.830   14.560   14.330   14.560   16.085 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n  20.780    3.253   10.582    0.840    3.255   12.160   -0.677    0.105 \nSW p-val \n   0.994 \n\n\n\nContrasta al nivel de significación \\(\\alpha=0.05\\) si el nuevo aparato proporciona mediciones más altas que el antiguo.\n\n\\[\\begin{eqnarray*}\nH_0: \\, \\mu_D=0 \\\\\nH_1: \\, \\mu_D&gt;0 \\\\\n\\end{eqnarray*}\\]\n\nt.test(d, mu=0, alternative=\"greater\")\n\n\n    One Sample t-test\n\ndata:  d\nt = 17.335, df = 14, p-value = 3.701e-11\nalternative hypothesis: true mean is greater than 0\n95 percent confidence interval:\n 13.08064      Inf\nsample estimates:\nmean of x \n    14.56 \n\n# or\nt.test(GLUCOSE$new, GLUCOSE$old, mu=0, paired=TRUE, alternative=\"greater\")\n\n\n    Paired t-test\n\ndata:  GLUCOSE$new and GLUCOSE$old\nt = 17.335, df = 14, p-value = 3.701e-11\nalternative hypothesis: true mean difference is greater than 0\n95 percent confidence interval:\n 13.08064      Inf\nsample estimates:\nmean difference \n          14.56 \n\n\nInterpretación: Como el p-valor\\(\\approx 0 &lt; \\alpha=0.05 \\Rightarrow\\) Rechazar \\(H_0\\).\nEs decir, con un nivel de significación de 5%, existen evidencias estadísticas para afirmar que el nuevo aparato proporciona mediciones más altas (en media) que el antiguo.\n\n\n1.5. Contrasta al nivel de significación \\(\\alpha=0.05\\) si la proporción de hombres con hemoglobina glicosilada (glyhb) por encima del 6% es superior a 0.2.\n\nCalcula el número de hombres en la muestra con glyhb por encima del 6% y el total de hombre de la muestra.\n\nDefinimos la variable \\[X=\\mbox{\"Número de hombres con hemoglobina glicosilada por encima del 6%\"} \\sim ~ Bin(n,\\pi)\\]\n\n## Casos favorables ##\nx &lt;- sum(diabetes$gender==\"male\" & diabetes$glyhb&gt;6)\nx\n\n[1] 39\n\n## Casos totales ##\nn &lt;- sum(diabetes$gender==\"male\")\nn\n\n[1] 169\n\n\n\nRealiza un test exacto y un test aproximado para la proporción. \\[\\begin{eqnarray*}\nH_0: \\, \\pi=0.2 \\\\\nH_1: \\, \\pi&gt;0.2 \\\\\n\\end{eqnarray*}\\]\n\n\n## Test exacto \nbinom.test(x, n, p=0.2, alternative=\"greater\", conf.level=0.95)\n\n\n    Exact binomial test\n\ndata:  x and n\nnumber of successes = 39, number of trials = 169, p-value = 0.182\nalternative hypothesis: true probability of success is greater than 0.2\n95 percent confidence interval:\n 0.1783787 1.0000000\nsample estimates:\nprobability of success \n             0.2307692 \n\n## Test aproximado\nprop.test(x, n, p=0.2, alternative=\"greater\", conf.level=0.95)\n\n\n    1-sample proportions test with continuity correction\n\ndata:  x out of n, null probability 0.2\nX-squared = 0.81694, df = 1, p-value = 0.183\nalternative hypothesis: true p is greater than 0.2\n95 percent confidence interval:\n 0.1792768 1.0000000\nsample estimates:\n        p \n0.2307692 \n\n\nInterpretación: Como el p-valor&gt;\\(\\alpha=0.05 \\Rightarrow\\) No rechazar \\(H_0\\).\nEs decir, con un nivel de significación de 5%, no podemos afirmar que la proporción de hombres con hemoglobina glicosilada por encima del 6% sea superior a 0.2.\n\n\n1.6. Contrasta al nivel de significación \\(\\alpha=0.05\\) si la proporción de hombres con colesterol por debajo de 200mg/dL es superior a la proporción de mujeres con colesterol por debajo de 200mg/dL.\n\nCalcula el número de hombres en la muestra con colesterol por debajo de 200mg/dL y el total de hombres de la muestra.\n\nSea \\[X=\\mbox{\"Número de hombres con colesterl por debajo de 200 mg/dL} \\sim Bin(n_X,\\pi_X)\\]\n\n## Casos favorables ##\nx &lt;- sum(diabetes$gender==\"male\" & diabetes$chol&lt;200)\nx\n\n[1] 79\n\n## Casos totales ##\nnx &lt;- sum(diabetes$gender==\"male\")\nnx\n\n[1] 169\n\n\n\nCalcula el número de mujeres en la muestra con colesterol por debajo de 200mg/dL y el total de hombres de la muestra.\n\nSea \\[Y=\\mbox{\"Número de mujeres con colesterol por debajo de 200 mg/dL} \\sim Bin(n_Y,\\pi_Y)\\]\n\n## Casos favorables ##\ny &lt;- sum(diabetes$gender==\"female\" & diabetes$chol&lt;200)\ny\n\n[1] 105\n\n## Casos totales ##\nny &lt;- sum(diabetes$gender==\"female\")\nny\n\n[1] 234\n\n\n\nRealiza un test para la diferencia de proporciones. \\[\\begin{eqnarray*}\nH_0: \\, \\pi_X-\\pi_Y=0 \\\\\nH_1: \\, \\pi_X-\\pi_Y \\neq 0 \\\\\n\\end{eqnarray*}\\]\n\n\nprop.test(c(x,y), c(nx,ny), alternative=\"greater\", conf.level=0.95)\n\n\n    2-sample test for equality of proportions with continuity correction\n\ndata:  c(x, y) out of c(nx, ny)\nX-squared = 0.073608, df = 1, p-value = 0.3931\nalternative hypothesis: greater\n95 percent confidence interval:\n -0.06909495  1.00000000\nsample estimates:\n   prop 1    prop 2 \n0.4674556 0.4487179 \n\n\nInterpretación: Como el p-valor\\(=0.393&gt;\\alpha=0.05 \\Rightarrow\\) No rechazar \\(H_0\\).\nEs decir, con un nivel de significación de 5%, no podemos afirmar que la proporción de hombres con colesterol por debajo de 200mg/dL sea superior a la proporción de mujeres con colesterol por debajo de 200mg/dL.\n\n\n\n2. Análisis de la varianza\n\n2.1. Contrasta al nivel de significación \\(\\alpha=0.10\\) si el tamaño del cuerpo (frame) influye en la presión diastólica (bp.1d) de las mujeres.\n\nCrea un nuevo fichero llamado diabetes.female solo con las mujeres.\n\n\npos &lt;- which(diabetes$gender==\"female\")\ndiabetes.female &lt;- diabetes[pos,]\n\nhead(diabetes.female)\n\n     id chol stab.glu hdl ratio glyhb   location age gender height weight\n1  1000  203       82  56   3.6  4.31 Buckingham  46 female     62    121\n2  1001  165       97  24   6.9  4.44 Buckingham  29 female     64    218\n3  1002  228       92  37   6.2  4.64 Buckingham  58 female     61    256\n10 1022  263       89  40   6.6  5.78 Buckingham  55 female     63    202\n11 1024  242       82  54   4.5  4.77     Louisa  60 female     65    156\n12 1029  215      128  34   6.3  4.97     Louisa  38 female     58    195\n    frame bp.1s bp.1d waist hip\n1  medium   118    59    29  38\n2   large   112    68    46  48\n3   large   190    92    49  57\n10  small   108    72    45  50\n11 medium   130    90    39  45\n12 medium   102    68    42  50\n\n\n\nExploración gráfica: representa los diagrama de caja de la variable bp.1d según la variable frame.\n\n\nboxplot(bp.1d ~ frame, data=diabetes.female)\n\n\n\n\n\nRealiza el análisis de varianza con la función aov().\n\n\nbp.aov &lt;- aov(bp.1d ~ frame, data=diabetes.female)\nsummary(bp.aov)\n\n             Df Sum Sq Mean Sq F value Pr(&gt;F)  \nframe         2    921   460.7   2.572 0.0786 .\nResiduals   231  41376   179.1                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nComprueba si pueden asumirse las hipótesis del modelo.\n\n\nchecking.plots(bp.aov)\n\n\n\n## Normalidad de los errores\nr &lt;- rstandard(bp.aov)\nshapiro.test(r)\n\n\n    Shapiro-Wilk normality test\n\ndata:  r\nW = 0.98986, p-value = 0.1008\n\n## Test de Levene para homogeneidad de varianzas\nlibrary(car)\nleveneTest(bp.aov)\n\nLevene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(&gt;F)\ngroup   2  1.8214 0.1641\n      231               \n\n\n\nUtiliza un test de Tukey para averiguar entre qué niveles de la variable frame existen diferencias significativas en los niveles medios de la variable bp.1d.\n\n\nbp.mc &lt;- TukeyHSD(bp.aov, conf.level=0.9)\nbp.mc\n\n  Tukey multiple comparisons of means\n    90% family-wise confidence level\n\nFit: aov(formula = bp.1d ~ frame, data = diabetes.female)\n\n$frame\n                  diff       lwr        upr     p adj\nmedium-large  2.121373 -2.811945  7.0546917 0.6491061\nsmall-large  -2.423910 -7.826310  2.9784887 0.6247892\nsmall-medium -4.545284 -8.697193 -0.3933743 0.0639277\n\n## Graficos de intervalos de confianza del test de Tukey\nplot(bp.mc)\n\n\n\n\n\n\n\n3. Para entregar\n3.1. Contrasta al nivel de significación \\(\\alpha=0.10\\), si la circunferencia de cadera media de los hombres es inferior a la circunferencia de cadera media de las mujeres.\n\nComprueba si las dos muestras provienen de poblaciones normales.\nRealiza el correspondiente test de medias.\n\n3.2. Se estudió la eficacia de la sulfinpirazona en prevenir la muerte después de sufrir infarto de miocardio. Para ello se consideraron pacientes que habían sufrido infarto de miocardio. A un grupo se les proporcionó sulfinpirazona y a otro grupo se les suministró placebo. En la siguiente tabla se muestra el número de pacientes de cada grupo que murieron y que superaron el infarto.\n\n\n\n\nDeath (all causes)\nSurvivors\n\n\n\n\nSulphinpyrazole\n41\n692\n\n\nPlacebo\n60\n682\n\n\n\nContrasta al nivel de significación \\(\\alpha=0.05\\) si la proporción de muertes de pacientes que tomaron sulfinpirazona es inferior a la de pacientes que tomaron un placebo.\n3.3. Considera el fichero diabetes. Crea un nuevo fichero que contenga únicamente a las mujeres del condado de Louisa.\n\nContrasta al nivel de significación \\(\\alpha=0.05\\) si existen diferencias entre los niveles medios de la variable hdl según la constitución del cuerpo frame en las mujeres del condado de Louisa.\nSi has detectado diferencias, averigua entre qué grupos existen diferencias estadísticamente significativas."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Programa",
    "section": "",
    "text": "Fecha\nTítulo\n\n\n\n\n09-octubre\nPráctica 0: Introducción a R\n\n\n09-octubre\nPráctica 1: Lectura y manejo de ficheros\n\n\n23-octubre\nPráctica 2: Estadística descriptiva\n\n\n31-octubre\nPráctica 3: Contrastes de hipótesis paramétricos y análisis de la varianza\n\n\n06-noviembre\nPráctica 4: Pruebas no-paramétricas\n\n\n11-noviembre\nPráctica repaso: Bloque I\n\n\n14-noviembre\nPráctica 5: Regresión lineal\n\n\n27-noviembre\nPráctica 6: Medidas de asociación, Odds Ratio y Riesgos Relativos\n\n\n11-diciembre\nPráctica 7: Regresión logística\n\n\n19-diciembre\nPráctica 8: Análisis de superviviencia"
  },
  {
    "objectID": "index.html#bioestadística-curso-2023-24.",
    "href": "index.html#bioestadística-curso-2023-24.",
    "title": "Programa",
    "section": "",
    "text": "Fecha\nTítulo\n\n\n\n\n09-octubre\nPráctica 0: Introducción a R\n\n\n09-octubre\nPráctica 1: Lectura y manejo de ficheros\n\n\n23-octubre\nPráctica 2: Estadística descriptiva\n\n\n31-octubre\nPráctica 3: Contrastes de hipótesis paramétricos y análisis de la varianza\n\n\n06-noviembre\nPráctica 4: Pruebas no-paramétricas\n\n\n11-noviembre\nPráctica repaso: Bloque I\n\n\n14-noviembre\nPráctica 5: Regresión lineal\n\n\n27-noviembre\nPráctica 6: Medidas de asociación, Odds Ratio y Riesgos Relativos\n\n\n11-diciembre\nPráctica 7: Regresión logística\n\n\n19-diciembre\nPráctica 8: Análisis de superviviencia"
  },
  {
    "objectID": "index.html#bibliografía",
    "href": "index.html#bibliografía",
    "title": "Programa",
    "section": "Bibliografía",
    "text": "Bibliografía\nPara la realización de esta práctica, puede consultarse el texto:\nUgarte, M.D., Militino, A.F., and Arnholt, A.T. (2016). Probability and Statistics with R (Second Edition). Chapman and Hall."
  },
  {
    "objectID": "PracticaRepasoI.html",
    "href": "PracticaRepasoI.html",
    "title": "Práctica repaso: Bloque I",
    "section": "",
    "text": "En esta práctica vamos a trabajar con el fichero de datos ZBS_2021.csv. Este fichero contiene información sobre algunas Zonas Básicas de Salud de Navarra. En concreto, se dispone de información de las siguientes variables:\n\n\n\n\n\n\n\nVariable\nDescripción\n\n\n\n\nZBS\nZona Básica de Salud\n\n\nRegion\nRegión geográfica\n\n\nCOVID19\nCasos acumulados de COVID-19\n\n\nDiabeticos\nNúmero de diabéticos diagnosticados\n\n\nPob\nPoblación total\n\n\nPob14\nPoblación mayor de 14 años\n\n\nPob90\nPoblación mayor de 90 años\n\n\nExtranjeros\nPoblación nacida en el extranjero\n\n\nSexo\nSexo mayoritario en la ZBS\n\n\nNatalidad\nTasas de natalidad (nacimientos por cada mil habitantes)\n\n\nTasa_paro\nTasa de desempleo (%)\n\n\nEsperanza\nEsperanza de vida (años)\n\n\nPobreza\nRiesgo de pobreza\n\n\nIndice\nÍndice de envejecimiento (%)\n\n\n\nEn primer lugar, debemos leer el fichero ZBS_2021.csv en R utilizando el asistente \\[\\mbox{Import Dataset -&gt; Front text (base)}\\] y seleccionando la opción Strings as factors.\n\nZBS_2021 &lt;- read.delim2(\"ZBS_2021.csv\", stringsAsFactors=TRUE, header=TRUE)\nhead(ZBS_2021)\n\n  ZBS Region COVID19 Diabeticos  Pob Pob14 Pob90 Extranjeros    Sexo Natalidad\n1   1  Norte    1193        616 9208  7944   114         967 Hombres       8.2\n2   2  Norte    1234        297 6531  5491    91         417 Hombres       9.6\n3   3  Norte    1059        454 8102  6765   112         747 Hombres      10.4\n4   4  Norte     587        213 3948  3315    24         179 Hombres      11.8\n5   5  Norte    1260        412 8360  7067    89         653 Hombres       8.0\n6   6  Norte    1000        404 8289  7071   131         711 Hombres       8.7\n  Tasa_paro Esperanza Pobreza Indice\n1     14.49      82.2    Baja   30.8\n2      7.22      82.9    Baja   36.0\n3      7.43      83.1    Baja   33.1\n4      6.90      81.9    Baja   38.1\n5      5.89      82.0    Baja   34.6\n6      5.15      81.2    Baja   37.1"
  },
  {
    "objectID": "PracticaRepasoI.html#descripción",
    "href": "PracticaRepasoI.html#descripción",
    "title": "Práctica repaso: Bloque I",
    "section": "",
    "text": "En esta práctica vamos a trabajar con el fichero de datos ZBS_2021.csv. Este fichero contiene información sobre algunas Zonas Básicas de Salud de Navarra. En concreto, se dispone de información de las siguientes variables:\n\n\n\n\n\n\n\nVariable\nDescripción\n\n\n\n\nZBS\nZona Básica de Salud\n\n\nRegion\nRegión geográfica\n\n\nCOVID19\nCasos acumulados de COVID-19\n\n\nDiabeticos\nNúmero de diabéticos diagnosticados\n\n\nPob\nPoblación total\n\n\nPob14\nPoblación mayor de 14 años\n\n\nPob90\nPoblación mayor de 90 años\n\n\nExtranjeros\nPoblación nacida en el extranjero\n\n\nSexo\nSexo mayoritario en la ZBS\n\n\nNatalidad\nTasas de natalidad (nacimientos por cada mil habitantes)\n\n\nTasa_paro\nTasa de desempleo (%)\n\n\nEsperanza\nEsperanza de vida (años)\n\n\nPobreza\nRiesgo de pobreza\n\n\nIndice\nÍndice de envejecimiento (%)\n\n\n\nEn primer lugar, debemos leer el fichero ZBS_2021.csv en R utilizando el asistente \\[\\mbox{Import Dataset -&gt; Front text (base)}\\] y seleccionando la opción Strings as factors.\n\nZBS_2021 &lt;- read.delim2(\"ZBS_2021.csv\", stringsAsFactors=TRUE, header=TRUE)\nhead(ZBS_2021)\n\n  ZBS Region COVID19 Diabeticos  Pob Pob14 Pob90 Extranjeros    Sexo Natalidad\n1   1  Norte    1193        616 9208  7944   114         967 Hombres       8.2\n2   2  Norte    1234        297 6531  5491    91         417 Hombres       9.6\n3   3  Norte    1059        454 8102  6765   112         747 Hombres      10.4\n4   4  Norte     587        213 3948  3315    24         179 Hombres      11.8\n5   5  Norte    1260        412 8360  7067    89         653 Hombres       8.0\n6   6  Norte    1000        404 8289  7071   131         711 Hombres       8.7\n  Tasa_paro Esperanza Pobreza Indice\n1     14.49      82.2    Baja   30.8\n2      7.22      82.9    Baja   36.0\n3      7.43      83.1    Baja   33.1\n4      6.90      81.9    Baja   38.1\n5      5.89      82.0    Baja   34.6\n6      5.15      81.2    Baja   37.1"
  },
  {
    "objectID": "PracticaRepasoI.html#estadística-descriptiva-univariante",
    "href": "PracticaRepasoI.html#estadística-descriptiva-univariante",
    "title": "Práctica repaso: Bloque I",
    "section": "1. Estadística Descriptiva Univariante",
    "text": "1. Estadística Descriptiva Univariante\n\n## Cargamos los paquetes necesarios ##\nlibrary(PASWR2)\nlibrary(car)\n\n\n1.1. ¿Cuántas observaciones tiene el fichero?\n\ndim(ZBS_2021)\n\n[1] 165  14\n\nncol(ZBS_2021)\n\n[1] 14\n\n\n\n\n1.2. ¿Cuántas variables tiene? ¿De qué tipo es cada una?\n\nstr(ZBS_2021)\n\n'data.frame':   165 obs. of  14 variables:\n $ ZBS        : int  1 2 3 4 5 6 7 8 9 10 ...\n $ Region     : Factor w/ 3 levels \"Centro\",\"Norte\",..: 2 2 2 2 2 2 2 1 2 2 ...\n $ COVID19    : int  1193 1234 1059 587 1260 1000 740 327 216 386 ...\n $ Diabeticos : int  616 297 454 213 412 404 329 121 88 269 ...\n $ Pob        : int  9208 6531 8102 3948 8360 8289 5461 2997 1923 4073 ...\n $ Pob14      : int  7944 5491 6765 3315 7067 7071 4540 2593 1716 3427 ...\n $ Pob90      : int  114 91 112 24 89 131 53 49 56 73 ...\n $ Extranjeros: int  967 417 747 179 653 711 446 122 125 389 ...\n $ Sexo       : Factor w/ 2 levels \"Hombres\",\"Mujeres\": 1 1 1 1 1 1 1 1 1 1 ...\n $ Natalidad  : num  8.2 9.6 10.4 11.8 8 8.7 8.3 6.4 3.9 9.9 ...\n $ Tasa_paro  : num  14.49 7.22 7.43 6.9 5.89 ...\n $ Esperanza  : num  82.2 82.9 83.1 81.9 82 81.2 81.6 82.4 82 82 ...\n $ Pobreza    : Factor w/ 2 levels \"Alta\",\"Baja\": 2 2 2 2 2 2 2 2 2 1 ...\n $ Indice     : num  30.8 36 33.1 38.1 34.6 37.1 32 35.6 51 30.7 ...\n\n\n\n\n1.3. ¿Cuántas categorías tiene la variable Region?\n\nlevels(ZBS_2021$Region)\n\n[1] \"Centro\" \"Norte\"  \"Sur\"   \n\n\n\n\n1.4. Obtén una tabla de frecuencias absolutas y relativas para la variable Region.\n\ntable(ZBS_2021$Region)\n\n\nCentro  Norte    Sur \n    71     33     61 \n\ntable(ZBS_2021$Region)/nrow(ZBS_2021)\n\n\n  Centro    Norte      Sur \n0.430303 0.200000 0.369697 \n\n\n\n\n1.5. Realiza una representación gráfica adecuada para la variable Region. Calcula las medidas de tendencia central adecuadas para esta variable.\n\nTabla &lt;- table(ZBS_2021$Region)\n\npar(mfrow=c(1,2), pty=\"s\")\npie(Tabla, main=\"Region\")\nbarplot(Tabla, main=\"Region\")\n\n\n\n\n\n\n1.6. Realiza un histograma y un diagrama de cajas de la variable Diabeticos. A la vista de estas representaciones gráficas, ¿qué puedes decir acerca de la simetría de esta variable? ¿Qué crees que será mayor, la media o la mediana?\n\npar(mfrow=c(1,2), pty=\"s\")\nhist(ZBS_2021$Diabeticos, main=\"Nº de diabéticos\", xlab=\"\")\nboxplot(ZBS_2021$Diabeticos, main=\"Nº de diabéticos\")\n\n\n\n\n\n\n1.7. Calcula el coeficiente de asimetría, la media y la mediana de la variable Diabeticos. ¿Confirman dichos valores lo observado en el histograma y el diagrama de cajas?\n\neda(ZBS_2021$Diabeticos)\n\n\n\n\n  Size (n)    Missing    Minimum     1st Qu       Mean     Median     TrMean \n   165.000      0.000     33.000    333.000    664.018    686.000    644.604 \n    3rd Qu        Max      Stdev        Var    SE Mean     I.Q.R.      Range \n   893.000   1917.000    402.128 161707.055     31.306    560.000   1884.000 \n  Kurtosis   Skewness   SW p-val \n    -0.060      0.540      0.000 \n\n\n\n\n1.8. Calcula e interpreta el coeficiente de curtosis de la variable Indice.\n\neda(ZBS_2021$Indice)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n 165.000    0.000    9.100   28.700   34.396   33.600   34.208   38.600 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n  65.400   11.766  138.431    0.916    9.900   56.300    0.338    0.399 \nSW p-val \n   0.000 \n\n\n\n\n1.9. Compara la dispersión de las variables Pob14 y Pob90.\n\nCV.Pob14 &lt;- sd(ZBS_2021$Pob14)/mean(ZBS_2021$Pob14)\nCV.Pob14\n\n[1] 0.5576343\n\nCV.Pob90 &lt;- sd(ZBS_2021$Pob90)/mean(ZBS_2021$Pob90)\nCV.Pob90\n\n[1] 0.6823854"
  },
  {
    "objectID": "PracticaRepasoI.html#estadística-descriptiva-bivariante",
    "href": "PracticaRepasoI.html#estadística-descriptiva-bivariante",
    "title": "Práctica repaso: Bloque I",
    "section": "2. Estadística Descriptiva Bivariante",
    "text": "2. Estadística Descriptiva Bivariante\n\n2.1. Realiza un diagrama de cajas de la esperanza de vida en función de la variable Pobreza. ¿Qué observas?\n\nboxplot(ZBS_2021$Esperanza ~ ZBS_2021$Pobreza)\n\n\n\n\n\n\n2.2. Calcula y compara los valores del percentil 75 de la esperanza de vida en función de la variable Pobreza.\n\ntapply(ZBS_2021$Esperanza, ZBS_2021$Pobreza, summary)\n\n$Alta\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  81.10   82.30   82.70   82.79   83.30   84.70 \n\n$Baja\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  80.80   82.80   83.40   83.41   84.12   85.80 \n\n\n\n\n2.3. Realiza un diagrama de cajas de la variable Natalidad por tipo de región geográfica. Compara la asimetria de la variable en los distintos grupos.\n\nboxplot(ZBS_2021$Natalidad ~ ZBS_2021$Region)\n\n\n\ntapply(ZBS_2021$Natalidad, ZBS_2021$Region, eda)\n\n\n\n\n\n\n\n\n\n\n$Centro\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n  71.000    0.000    2.500    6.950    8.592    8.500    8.457    9.800 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n  17.800    2.763    7.634    0.328    2.850   15.300    3.028    0.954 \nSW p-val \n   0.000 \n\n$Norte\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n  33.000    0.000    3.900    7.600    8.318    8.300    8.345    9.800 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n  11.900    2.183    4.767    0.380    2.200    8.000   -0.391   -0.522 \nSW p-val \n   0.032 \n\n$Sur\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n  61.000    0.000    4.100    7.700    8.226    8.300    8.282    9.700 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n  11.400    2.068    4.277    0.265    2.000    7.300   -0.452   -0.604 \nSW p-val \n   0.000 \n\n\n\n\n2.4. Selecciona únicamente las zonas básicas de salud situadas en la región del Sur. Compara la tasa de desempleo media en función del sexo mayoritario de la zona.\n\npos &lt;- which(ZBS_2021$Region==\"Sur\")\nZBS.Sur &lt;- ZBS_2021[pos,]\n\ntapply(ZBS.Sur$Tasa_paro, ZBS.Sur$Sexo, mean)\n\n Hombres  Mujeres \n10.80404 11.01071 \n\n\n\n\n2.5. Realiza una tabla de contingencia para las variables Region y Pobreza.\n\nX &lt;- table(ZBS_2021$Region, ZBS_2021$Pobreza)\nX\n\n        \n         Alta Baja\n  Centro   24   47\n  Norte     4   29\n  Sur      37   24\n\n\n\n¿Que porcentaje de zonas básicas de salud se encuentran en la región del norte y tienen riesgo alto de pobreza?\n\n\nprop.table(X)\n\n        \n               Alta       Baja\n  Centro 0.14545455 0.28484848\n  Norte  0.02424242 0.17575758\n  Sur    0.22424242 0.14545455\n\n\n\nEntre las zonas básicas de salud del centro, ¿que porcentaje tienen riesgo bajo de pobreza?\n\n\nprop.table(X,1)\n\n        \n              Alta      Baja\n  Centro 0.3380282 0.6619718\n  Norte  0.1212121 0.8787879\n  Sur    0.6065574 0.3934426\n\n\n\nEntre las zonas básicas de con riesgo alto de pobreza, ¿que porcentaje pertecen al sur?\n\n\nprop.table(X,2)\n\n        \n               Alta       Baja\n  Centro 0.36923077 0.47000000\n  Norte  0.06153846 0.29000000\n  Sur    0.56923077 0.24000000\n\n\n\n\n2.6. Realiza un diagrama de dispersión de las variables Pob y Extranjeros. Calcula e interpreta el coeficiente de correlación lineal entre ambas variables. ¿Crées que sería adecuado utilizar otro tipo de relación no lineal para medir la asociación entre estas variables?\n\nplot(ZBS_2021$Pob, ZBS_2021$Extranjeros)\nabline(lm(Extranjeros ~ Pob, data=ZBS_2021), col=\"red\")\n\n\n\ncor(ZBS_2021$Pob, ZBS_2021$Extranjeros)\n\n[1] 0.8907831\n\n\n\n\n2.7. ¿Existe una relación lineal entre la tasa de natalidad y el índice de envejecimiento de las zonas básicas de salud? Realiza el análisis estadístico adecuado e interpreta los resultados obtenidos.\n\nplot(ZBS_2021$Natalidad, ZBS_2021$Indice)\nabline(lm(Indice ~ Natalidad, data=ZBS_2021), col=\"red\")\n\n\n\ncov(ZBS_2021$Natalidad, ZBS_2021$Indice)\n\n[1] -18.18322\n\ncor(ZBS_2021$Natalidad, ZBS_2021$Indice)\n\n[1] -0.6427229"
  },
  {
    "objectID": "PracticaRepasoI.html#contrastes-paramétricos-y-no-paramétricos",
    "href": "PracticaRepasoI.html#contrastes-paramétricos-y-no-paramétricos",
    "title": "Práctica repaso: Bloque I",
    "section": "3. Contrastes Paramétricos y No-Paramétricos",
    "text": "3. Contrastes Paramétricos y No-Paramétricos\n\n3.1. Contrasta al nivel de significación de \\(\\alpha=0.05\\) si la esperanza de vida media en las zonas básicas de salud de Navarra es superior 83 años. Justifica si puedes asumir normalidad. ¿Qué contraste es más adecuado en este caso?\n\n## X=\"Esperanza de vida en las ZBS de Navarra\"\n## H0: mu=83\n## H1: mu&gt;83\n\neda(ZBS_2021$Esperanza)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n 165.000    0.000   80.800   82.400   83.165   83.100   83.157   83.800 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n  85.800    0.950    0.902    0.074    1.400    5.000   -0.217    0.147 \nSW p-val \n   0.806 \n\nt.test(ZBS_2021$Esperanza, mu=83, alternative=\"greater\", conf.level=0.95)\n\n\n    One Sample t-test\n\ndata:  ZBS_2021$Esperanza\nt = 2.2291, df = 164, p-value = 0.01358\nalternative hypothesis: true mean is greater than 83\n95 percent confidence interval:\n 83.04251      Inf\nsample estimates:\nmean of x \n 83.16485 \n\n\n\n\n3.2. Contrasta al nivel de significación de \\(\\alpha=0.01\\) si la tasa de desempleo media de las zonas básicas de salud situadas en el norte de Navarra es inferior al 8%. Justifica si puedes asumir normalidad. ¿Qué contraste es más adecuado en este caso?\n\n## X=\"Número de peatones fallecidos en el Sudeste Asiático\"\n## H0: mu=15\n## H1: mu&gt;15\n\npos &lt;- which(ZBS_2021$Region==\"Norte\")\nZBS.Norte &lt;- ZBS_2021[pos, ]\n\neda(ZBS.Norte$Tasa_paro)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n  33.000    0.000    5.150    5.950    7.953    7.200    7.828    7.710 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n  14.650    2.966    8.796    0.516    1.760    9.500    0.283    1.348 \nSW p-val \n   0.000 \n\nwilcox.test(ZBS.Norte$Tasa_paro, mu=8, alternative=\"less\", conf.level=0.95)\n\nWarning in wilcox.test.default(ZBS.Norte$Tasa_paro, mu = 8, alternative =\n\"less\", : cannot compute exact p-value with ties\n\n\n\n    Wilcoxon signed rank test with continuity correction\n\ndata:  ZBS.Norte$Tasa_paro\nV = 183, p-value = 0.04153\nalternative hypothesis: true location is less than 8\n\n\n\n\n3.3. Contrasta al nivel de significación de \\(\\alpha=0.05\\) si existen diferencias significativas en la esperanza de vida media entre las zonas básicas de salud situadas en el norte y en el sur de Navarra. Realiza el contraste de hipótesis que consideres adecuado.\n\n## X=\"Esperanza de vida de las ZBS del norte de Navarra\"\n## Y=\"Esperanza de vida de las ZBS del sur de Navarra\"\n## H0: muX - muY = 0\n## H1: muX - muY != 0\n\npos &lt;- which(ZBS_2021$Region==\"Norte\")\nZBS.Norte &lt;- ZBS_2021[pos, ]\n\npos &lt;- which(ZBS_2021$Region==\"Sur\")\nZBS.Sur &lt;- ZBS_2021[pos, ]\n\neda(ZBS.Norte$Esperanza)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n  33.000    0.000   81.200   82.200   82.861   82.900   82.852   83.400 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n  84.800    0.895    0.801    0.156    1.200    3.600   -0.748    0.294 \nSW p-val \n   0.652 \n\neda(ZBS.Sur$Esperanza)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n  61.000    0.000   81.100   82.600   83.213   83.300   83.229   83.700 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n  84.800    0.829    0.686    0.106    1.100    3.700   -0.299   -0.244 \nSW p-val \n   0.645 \n\nt.test(ZBS.Norte$Esperanza, ZBS.Sur$Esperanza, mu=0, alternative=\"two.sided\", conf.level=0.95)\n\n\n    Welch Two Sample t-test\n\ndata:  ZBS.Norte$Esperanza and ZBS.Sur$Esperanza\nt = -1.87, df = 61.494, p-value = 0.06624\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -0.7293811  0.0243637\nsample estimates:\nmean of x mean of y \n 82.86061  83.21311 \n\n\n\n\n3.4. Contrasta al nivel de significación de \\(\\alpha=0.05\\) si el índice de envejecimiento medio entre las zonas básicas de salud con sexo mayoritario de hombres es al menos 2 puntos superior al índice de envejecimiento de las zonas básicas de salud con sexo mayoritario de mujeres. Realiza el contraste de hipótesis que consideres adecuado.\n\n## X=\"Índice de envejecimiento de las ZBS con sexo mayoritario de hombres\"\n## Y=\"Índice de envejecimiento de las ZBS con sexo mayoritario de mujeres\"\n## H0: muX - muY = 0\n## H1: muX - muY != 0\n\npos &lt;- which(ZBS_2021$Sexo==\"Hombres\")\nZBS.Hombres &lt;- ZBS_2021[pos, ]\n\npos &lt;- which(ZBS_2021$Sexo==\"Mujeres\")\nZBS.Mujeres &lt;- ZBS_2021[pos, ]\n\neda(ZBS.Hombres$Indice)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n  98.000    0.000   18.100   30.900   36.491   35.200   36.096   39.675 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n  65.400   11.123  123.726    1.124    8.775   47.300    0.355    0.617 \nSW p-val \n   0.000 \n\neda(ZBS.Mujeres$Indice)\n\n\n\n\nSize (n)  Missing  Minimum   1st Qu     Mean   Median   TrMean   3rd Qu \n  67.000    0.000    9.100   24.800   31.331   31.500   31.103   34.900 \n     Max    Stdev      Var  SE Mean   I.Q.R.    Range Kurtosis Skewness \n  58.600   12.087  146.091    1.477   10.100   49.500    0.097    0.324 \nSW p-val \n   0.004 \n\nwilcox.test(ZBS.Hombres$Indice, ZBS.Mujeres$Indice, mu=2, alternative=\"greater\", conf.level=0.95)\n\n\n    Wilcoxon rank sum test with continuity correction\n\ndata:  ZBS.Hombres$Indice and ZBS.Mujeres$Indice\nW = 3865, p-value = 0.02683\nalternative hypothesis: true location shift is greater than 2\n\n\n\n\n3.5. Contrasta al nivel de significación de \\(\\alpha=0.05\\) si existen diferencias entre los niveles medios del índice de envejecimiento según la región geográfica de las zonas básicas de salud de Navarra. Si has detectado diferencias, averigua entre qué grupos existen diferencias estadísticamente significativas.\n\nboxplot(ZBS_2021$Indice ~ ZBS_2021$Region)            #### Gráfico descriptivo\n\n\n\nIndice.aov &lt;- aov(Indice ~ Region, data=ZBS_2021)     #### Analisis de varianza\nsummary(Indice.aov)\n\n             Df Sum Sq Mean Sq F value   Pr(&gt;F)    \nRegion        2   3462  1730.9   14.57 1.51e-06 ***\nResiduals   162  19241   118.8                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nchecking.plots(Indice.aov)                            #### Validación con procedimientos graficos de la libreria PASWR \n\n\n\nr &lt;- rstandard(Indice.aov)                            #### Normalidad de los residuos\nshapiro.test(r)\n\n\n    Shapiro-Wilk normality test\n\ndata:  r\nW = 0.93851, p-value = 1.507e-06\n\nleveneTest(ZBS_2021$Indice ~ ZBS_2021$Region)         #### Test de Levene para homogeneidad de varianzas\n\nLevene's Test for Homogeneity of Variance (center = median)\n       Df F value  Pr(&gt;F)  \ngroup   2  3.4837 0.03301 *\n      162                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nkruskal.test(Indice ~ Region, data=ZBS_2021)          #### Test no-paramétrico (Kruskall-Wallis)\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  Indice by Region\nKruskal-Wallis chi-squared = 27.887, df = 2, p-value = 8.8e-07\n\nlibrary(agricolae)\nkruskal(ZBS_2021$Indice, ZBS_2021$Region, alpha=0.05, group=FALSE, console=TRUE)\n\n\nStudy: ZBS_2021$Indice ~ ZBS_2021$Region\nKruskal-Wallis test's\nTies or no Ties\n\nCritical Value: 27.88671\nDegrees of freedom: 2\nPvalue Chisq  : 8.799885e-07 \n\nZBS_2021$Region,  means of the ranks\n\n       ZBS_2021.Indice  r\nCentro        60.73239 71\nNorte        105.84848 33\nSur           96.55738 61\n\nPost Hoc Analysis\n\nComparison between treatments mean of the ranks.\n\n               Difference pvalue Signif.        LCL       UCL\nCentro - Norte -45.116090 0.0000     *** -63.334508 -26.89767\nCentro - Sur   -35.824983 0.0000     *** -50.921369 -20.72860\nNorte - Sur      9.291108 0.3276          -9.395142  27.97736"
  },
  {
    "objectID": "Practica5.html",
    "href": "Practica5.html",
    "title": "Bioestadística. Máster Universitario en Investigación en Ciencias de la Salud",
    "section": "",
    "text": "knitr::opts_chunk$set(echo = TRUE)"
  },
  {
    "objectID": "Practica5.html#práctica-5---regresión",
    "href": "Practica5.html#práctica-5---regresión",
    "title": "Bioestadística. Máster Universitario en Investigación en Ciencias de la Salud",
    "section": "Práctica 5 - Regresión",
    "text": "Práctica 5 - Regresión\n\nEmplea el fichero bloodpress1.txt para ajustar un modelo de regresión lineal que permita estimar la presión sistólica en hombres según la edad.\n\n\nlibrary(PASWR2)\n\nWarning: package 'PASWR2' was built under R version 4.2.3\n\n\nLoading required package: lattice\n\n\nLoading required package: ggplot2\n\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\ndatos&lt;-read.table(\"bloodpres1.txt\",header=TRUE)\ndatos.male&lt;-datos[datos$sex==\"M\",]          \nplot(datos.male$age,datos.male$sbp)\n\n\n\nmodel.male&lt;-lm(sbp~age,data=datos.male)     #### Ajustamos la recta\n\n• Proporciona una explicación para los coeficientes\n\nsummary(model.male)\n\n\nCall:\nlm(formula = sbp ~ age, data = datos.male)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-20.647  -3.128   1.681   3.912  17.280 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 110.0385     4.4892   24.51  &lt; 2e-16 ***\nage           0.9614     0.0913   10.53 7.98e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.479 on 38 degrees of freedom\nMultiple R-squared:  0.7447,    Adjusted R-squared:  0.738 \nF-statistic: 110.9 on 1 and 38 DF,  p-value: 7.985e-13\n\n\n• Representa gráficamente la línea ajustada\n\nplot(datos.male$age,datos.male$sbp)\nabline(model.male,col=2,lwd=3)\n\n\n\nchecking.plots(model.male)\n\n\n\nr&lt;-rstandard(model.male)\nshapiro.test(r)\n\n\n    Shapiro-Wilk normality test\n\ndata:  r\nW = 0.93985, p-value = 0.03418\n\n\n• Obtén la predicción para cinco hombres de 20, 29, 46, 58 y 65 años de edad\n\npredicitons&lt;-predict(model.male,newdata=data.frame(age=c(20,29,46,58,65)),se.fit=TRUE,interval=\"prediction\")\npredicitons\n\n$fit\n       fit      lwr      upr\n1 129.2656 111.1885 147.3426\n2 137.9178 120.2262 155.6093\n3 154.2607 136.8814 171.6401\n4 165.7970 148.2983 183.2956\n5 172.5264 154.8297 190.2232\n\n$se.fit\n       1        2        3        4        5 \n2.800134 2.115626 1.343340 1.679256 2.126238 \n\n$df\n[1] 38\n\n$residual.scale\n[1] 8.479221\n\n\n\nEmplea el fichero bloodpress1.txt para ajustar un modelo de regresión lineal que permita estimar la presión sistólica en mujeres según la edad.\n\n\ndatos.female&lt;-datos[datos$sex==\"F\",]  \nplot(datos.female$age,datos.female$sbp)\n\n\n\nmodel.female&lt;-lm(sbp~age,data=datos.female)     #### Ajustamos la recta\n\n• Proporciona una explicación para los coeficientes\n\nsummary(model.female) \n\n\nCall:\nlm(formula = sbp ~ age, data = datos.female)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-19.354  -4.797   1.254   4.747  21.153 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  97.0771     5.5276  17.562 2.67e-16 ***\nage           0.9493     0.1161   8.174 8.88e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 9.563 on 27 degrees of freedom\nMultiple R-squared:  0.7122,    Adjusted R-squared:  0.7015 \nF-statistic: 66.81 on 1 and 27 DF,  p-value: 8.876e-09\n\n\n• Representa gráficamente la línea ajustada\n\nplot(datos.female$age,datos.female$sbp)\nabline(model.female,col=2,lwd=3)\n\n\n\nchecking.plots(model.female)\n\n\n\nr&lt;-rstandard(model.female)\nshapiro.test(r)\n\n\n    Shapiro-Wilk normality test\n\ndata:  r\nW = 0.96328, p-value = 0.3948\n\n\n• Obtén la predicción para cinco mujeres de 23, 26, 32, 55 y 62 años de edad\n\npredicitons&lt;-predict(model.female,newdata=data.frame(age=c(23,26,32,55,62)),se.fit=TRUE,interval=\"prediction\")\npredicitons\n\n$fit\n       fit      lwr      upr\n1 118.9115  98.2724 139.5506\n2 121.7595 101.2909 142.2281\n3 127.4554 107.2561 147.6547\n4 149.2898 129.1922 169.3874\n5 155.9351 135.5735 176.2966\n\n$se.fit\n       1        2        3        4        5 \n3.118275 2.838810 2.336169 2.117572 2.649644 \n\n$df\n[1] 27\n\n$residual.scale\n[1] 9.56333"
  },
  {
    "objectID": "Practica6.html",
    "href": "Practica6.html",
    "title": "Bioestadística. Máster Universitario en Investigación en Ciencias de la Salud",
    "section": "",
    "text": "Se estudió la eficacia de la sulfinpirazona en prevenir la muerte después de sufrir infarto de miocardio. Para ello se consideraron pacientes que habían sufrido infarto de miocardio. A un grupo se les proporcionó sulfinpirazona y a otro grupo se les suministró placebo. En la siguiente tabla se muestra el número de pacientes de cada grupo que murieron y que superaron el infarto.\n\n\n\n\n\nDeath (all causes)\nSurvivors\n\n\n\n\nSulphinpyrazole\n41\n692\n\n\nPlacebo\n60\n682\n\n\n\n\nCalcula un intervalo de confianza para la diferencia de proporciones de muertes en el grupo placebo y en grupo que tomaron sulfinpirazona.\n\n\nn1&lt;-41      ### Numero muertes con sulfinpirazona\nN1&lt;-41+692  ### Numero pacientes tratados con sulfinpirazona\nN1\n\n[1] 733\n\nn2&lt;-60      ### Numero muertes con placebo          \nN2&lt;-60+682  ### Numero pacientes tratados con placebo \nN2\n\n[1] 742\n\nprop.test(c(n2,n1),c(N2,N1),alternative=\"two.sided\",correct=TRUE)\n\n\n    2-sample test for equality of proportions with continuity correction\n\ndata:  c(n2, n1) out of c(N2, N1)\nX-squared = 3.2121, df = 1, p-value = 0.0731\nalternative hypothesis: two.sided\n95 percent confidence interval:\n -0.002148155  0.052004191\nsample estimates:\n    prop 1     prop 2 \n0.08086253 0.05593452 \n\n\n\nEstima e interpreta el riesgo relativo de morir habiendo tomado placebo res\\-pecto a haber tomado sulfinpirazona y proporciona un intervalo de confianza para dicho riesgo.\n\n\nsulfin&lt;-data.frame(Muerto=c(60,41), Vivos=c(682,692))\nsulfin\n\n  Muerto Vivos\n1     60   682\n2     41   692\n\np1&lt;-60/(60+682)\np2&lt;-41/(41+692)\nN1&lt;-60+682\nN2&lt;-41+692\nriesgo&lt;-p1/p2\nriesgo\n\n[1] 1.445664\n\nexp(log(p1/p2)-1.96*sqrt((1-p1)/(N1*p1)+(1-p2)/(N2*p2)))\n\n[1] 0.9848799\n\nexp(log(p1/p2)+1.96*sqrt((1-p1)/(N1*p1)+(1-p2)/(N2*p2)))\n\n[1] 2.122031\n\n\n\nEstima e interpreta el odds de fallecer en los dos grupos.\n\n\nodds.placebo&lt;-p1/(1-p1)\nodds.placebo\n\n[1] 0.08797654\n\nodds.sulfin&lt;-p2/(1-p2)\nodds.sulfin\n\n[1] 0.05924855\n\n\n\nEstima e interpreta el odds ratio.\n\n\nodds.ratio&lt;-odds.placebo/odds.sulfin\nodds.ratio\n\n[1] 1.484872\n\nsource(\"odds.R\")\nodds(sulfin)\n\n[1] \"fila 1 vs fila 2\"\n     oddsratio conf.int.i.OR conf.int.s.OR  log.odds\n[1,]  1.484872     0.9844733       2.23962 0.3953288\n     relative.risk conf.int.i.RR conf.int.s.RR\n[1,]      1.445664     0.9848868      2.122016\n\n\n\nUtiliza el test exacto de Fisher para decidir si hay independencia.\n\n\nfisher.test(sulfin)\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  sulfin\np-value = 0.06356\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 0.9666812 2.2988176\nsample estimates:\nodds ratio \n  1.484468 \n\n\n\nUtiliza el test de la \\(\\chi^2\\) para contrastar independencia.\n\n\nchisq.test(sulfin)\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  sulfin\nX-squared = 3.2121, df = 1, p-value = 0.0731\n\n\n\nDisponemos de una muestra de 582 hombres y 509 mujeres. A todas las personas se les somete a un tratamiento para bajar la presión sanguínea. El objetivo del estudio es determinar si el tratamiento es igualmente eficaz en ambos géneros, es decir, nos interesa determinar si la variable género y la variable eficacia del tratamiento son independientes.\n\n\n\n\n\n\n\n\n\n\nSí se observa una reducción en la presión\nNo se observa una reducción en la presión\n\n\n\n\nHombre\n435\n147\n\n\nMujer\n375\n134\n\n\n\n\nCalcula un intervalo de confianza para la diferencia de proporciones entre los hombres y las mujeres que reducen la presión.\n\n\nn1&lt;-435      ### Numero de hombres reduccion presión \nN1&lt;-435+147  ### Numero total hombres\nN1\n\n[1] 582\n\nn2&lt;-375      ### Numero de mujeres reduccion presión           \nN2&lt;-375+134  ### Numero total mujeres\nN2\n\n[1] 509\n\nprop.test(c(n2,n1),c(N2,N1),alternative=\"two.sided\",correct=TRUE)\n\n\n    2-sample test for equality of proportions with continuity correction\n\ndata:  c(n2, n1) out of c(N2, N1)\nX-squared = 0.11103, df = 1, p-value = 0.739\nalternative hypothesis: two.sided\n95 percent confidence interval:\n -0.06458148  0.04321353\nsample estimates:\n   prop 1    prop 2 \n0.7367387 0.7474227 \n\n\n\nEstima el riesgo relativo de que el tratamiento sea eficaz en los hombres respecto a las mujeres y proporciona un intervalo de confianza para dicho riesgo.\n\n\np1&lt;-n1/N1\np2&lt;-n2/N2\nriesgo&lt;-p1/p2\nriesgo\n\n[1] 1.014502\n\nexp(log(p1/p2)-1.96*sqrt((1-p1)/(N1*p1)+(1-p2)/(N2*p2)))\n\n[1] 0.9457296\n\nexp(log(p1/p2)+1.96*sqrt((1-p1)/(N1*p1)+(1-p2)/(N2*p2)))\n\n[1] 1.088275\n\n\n\nEstima el odds de reducir la presión en los dos grupos.\n\n\nodds.hombre&lt;-p1/(1-p1)\nodds.hombre\n\n[1] 2.959184\n\nodds.mujer&lt;-p2/(1-p2)\nodds.mujer\n\n[1] 2.798507\n\n\n\nEstima el odds ratio.\n\n\nodds.ratio&lt;-odds.hombre/odds.mujer\nodds.ratio\n\n[1] 1.057415\n\npresion&lt;-data.frame(si=c(435,375), no=c(147,134))\npresion\n\n   si  no\n1 435 147\n2 375 134\n\nsource(\"odds.R\")\nodds(presion)\n\n[1] \"fila 1 vs fila 2\"\n     oddsratio conf.int.i.OR conf.int.s.OR   log.odds\n[1,]  1.057415     0.8057579       1.38767 0.05582722\n     relative.risk conf.int.i.RR conf.int.s.RR\n[1,]      1.014502     0.9457309      1.088273\n\n\n\nUtiliza el test exacto de Fisher para decidir si hay independencia.\n\n\nfisher.test(presion)\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  presion\np-value = 0.7287\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 0.7979867 1.4004250\nsample estimates:\nodds ratio \n  1.057334 \n\n\n\nUtiliza el test de la \\(\\chi^2\\) para contrastar independencia.\n\n\nchisq.test(presion)\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  presion\nX-squared = 0.11103, df = 1, p-value = 0.739"
  },
  {
    "objectID": "Practica6.html#práctica-6---medidas-de-asociación",
    "href": "Practica6.html#práctica-6---medidas-de-asociación",
    "title": "Bioestadística. Máster Universitario en Investigación en Ciencias de la Salud",
    "section": "",
    "text": "Se estudió la eficacia de la sulfinpirazona en prevenir la muerte después de sufrir infarto de miocardio. Para ello se consideraron pacientes que habían sufrido infarto de miocardio. A un grupo se les proporcionó sulfinpirazona y a otro grupo se les suministró placebo. En la siguiente tabla se muestra el número de pacientes de cada grupo que murieron y que superaron el infarto.\n\n\n\n\n\nDeath (all causes)\nSurvivors\n\n\n\n\nSulphinpyrazole\n41\n692\n\n\nPlacebo\n60\n682\n\n\n\n\nCalcula un intervalo de confianza para la diferencia de proporciones de muertes en el grupo placebo y en grupo que tomaron sulfinpirazona.\n\n\nn1&lt;-41      ### Numero muertes con sulfinpirazona\nN1&lt;-41+692  ### Numero pacientes tratados con sulfinpirazona\nN1\n\n[1] 733\n\nn2&lt;-60      ### Numero muertes con placebo          \nN2&lt;-60+682  ### Numero pacientes tratados con placebo \nN2\n\n[1] 742\n\nprop.test(c(n2,n1),c(N2,N1),alternative=\"two.sided\",correct=TRUE)\n\n\n    2-sample test for equality of proportions with continuity correction\n\ndata:  c(n2, n1) out of c(N2, N1)\nX-squared = 3.2121, df = 1, p-value = 0.0731\nalternative hypothesis: two.sided\n95 percent confidence interval:\n -0.002148155  0.052004191\nsample estimates:\n    prop 1     prop 2 \n0.08086253 0.05593452 \n\n\n\nEstima e interpreta el riesgo relativo de morir habiendo tomado placebo res\\-pecto a haber tomado sulfinpirazona y proporciona un intervalo de confianza para dicho riesgo.\n\n\nsulfin&lt;-data.frame(Muerto=c(60,41), Vivos=c(682,692))\nsulfin\n\n  Muerto Vivos\n1     60   682\n2     41   692\n\np1&lt;-60/(60+682)\np2&lt;-41/(41+692)\nN1&lt;-60+682\nN2&lt;-41+692\nriesgo&lt;-p1/p2\nriesgo\n\n[1] 1.445664\n\nexp(log(p1/p2)-1.96*sqrt((1-p1)/(N1*p1)+(1-p2)/(N2*p2)))\n\n[1] 0.9848799\n\nexp(log(p1/p2)+1.96*sqrt((1-p1)/(N1*p1)+(1-p2)/(N2*p2)))\n\n[1] 2.122031\n\n\n\nEstima e interpreta el odds de fallecer en los dos grupos.\n\n\nodds.placebo&lt;-p1/(1-p1)\nodds.placebo\n\n[1] 0.08797654\n\nodds.sulfin&lt;-p2/(1-p2)\nodds.sulfin\n\n[1] 0.05924855\n\n\n\nEstima e interpreta el odds ratio.\n\n\nodds.ratio&lt;-odds.placebo/odds.sulfin\nodds.ratio\n\n[1] 1.484872\n\nsource(\"odds.R\")\nodds(sulfin)\n\n[1] \"fila 1 vs fila 2\"\n     oddsratio conf.int.i.OR conf.int.s.OR  log.odds\n[1,]  1.484872     0.9844733       2.23962 0.3953288\n     relative.risk conf.int.i.RR conf.int.s.RR\n[1,]      1.445664     0.9848868      2.122016\n\n\n\nUtiliza el test exacto de Fisher para decidir si hay independencia.\n\n\nfisher.test(sulfin)\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  sulfin\np-value = 0.06356\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 0.9666812 2.2988176\nsample estimates:\nodds ratio \n  1.484468 \n\n\n\nUtiliza el test de la \\(\\chi^2\\) para contrastar independencia.\n\n\nchisq.test(sulfin)\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  sulfin\nX-squared = 3.2121, df = 1, p-value = 0.0731\n\n\n\nDisponemos de una muestra de 582 hombres y 509 mujeres. A todas las personas se les somete a un tratamiento para bajar la presión sanguínea. El objetivo del estudio es determinar si el tratamiento es igualmente eficaz en ambos géneros, es decir, nos interesa determinar si la variable género y la variable eficacia del tratamiento son independientes.\n\n\n\n\n\n\n\n\n\n\nSí se observa una reducción en la presión\nNo se observa una reducción en la presión\n\n\n\n\nHombre\n435\n147\n\n\nMujer\n375\n134\n\n\n\n\nCalcula un intervalo de confianza para la diferencia de proporciones entre los hombres y las mujeres que reducen la presión.\n\n\nn1&lt;-435      ### Numero de hombres reduccion presión \nN1&lt;-435+147  ### Numero total hombres\nN1\n\n[1] 582\n\nn2&lt;-375      ### Numero de mujeres reduccion presión           \nN2&lt;-375+134  ### Numero total mujeres\nN2\n\n[1] 509\n\nprop.test(c(n2,n1),c(N2,N1),alternative=\"two.sided\",correct=TRUE)\n\n\n    2-sample test for equality of proportions with continuity correction\n\ndata:  c(n2, n1) out of c(N2, N1)\nX-squared = 0.11103, df = 1, p-value = 0.739\nalternative hypothesis: two.sided\n95 percent confidence interval:\n -0.06458148  0.04321353\nsample estimates:\n   prop 1    prop 2 \n0.7367387 0.7474227 \n\n\n\nEstima el riesgo relativo de que el tratamiento sea eficaz en los hombres respecto a las mujeres y proporciona un intervalo de confianza para dicho riesgo.\n\n\np1&lt;-n1/N1\np2&lt;-n2/N2\nriesgo&lt;-p1/p2\nriesgo\n\n[1] 1.014502\n\nexp(log(p1/p2)-1.96*sqrt((1-p1)/(N1*p1)+(1-p2)/(N2*p2)))\n\n[1] 0.9457296\n\nexp(log(p1/p2)+1.96*sqrt((1-p1)/(N1*p1)+(1-p2)/(N2*p2)))\n\n[1] 1.088275\n\n\n\nEstima el odds de reducir la presión en los dos grupos.\n\n\nodds.hombre&lt;-p1/(1-p1)\nodds.hombre\n\n[1] 2.959184\n\nodds.mujer&lt;-p2/(1-p2)\nodds.mujer\n\n[1] 2.798507\n\n\n\nEstima el odds ratio.\n\n\nodds.ratio&lt;-odds.hombre/odds.mujer\nodds.ratio\n\n[1] 1.057415\n\npresion&lt;-data.frame(si=c(435,375), no=c(147,134))\npresion\n\n   si  no\n1 435 147\n2 375 134\n\nsource(\"odds.R\")\nodds(presion)\n\n[1] \"fila 1 vs fila 2\"\n     oddsratio conf.int.i.OR conf.int.s.OR   log.odds\n[1,]  1.057415     0.8057579       1.38767 0.05582722\n     relative.risk conf.int.i.RR conf.int.s.RR\n[1,]      1.014502     0.9457309      1.088273\n\n\n\nUtiliza el test exacto de Fisher para decidir si hay independencia.\n\n\nfisher.test(presion)\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  presion\np-value = 0.7287\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 0.7979867 1.4004250\nsample estimates:\nodds ratio \n  1.057334 \n\n\n\nUtiliza el test de la \\(\\chi^2\\) para contrastar independencia.\n\n\nchisq.test(presion)\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  presion\nX-squared = 0.11103, df = 1, p-value = 0.739"
  },
  {
    "objectID": "Practica7.html",
    "href": "Practica7.html",
    "title": "Bioestadística. Máster Universitario en Investigación en Ciencias de la Salud",
    "section": "",
    "text": "Para estudiar la posible relación entre el número de satélites (cangrejos macho a su alrededor) y la anchura del caparazón de los cangrejos hembra tipo herradura, se realizó un experimento con 8 cangrejos hembra a los que se midió:\n\n\nLa anchura de los caparazones (x), medida en cm.\nEl número total de cangrejos macho que se utilizaron en el experimento para cada hembra (n)\nEl número de satélites o cangrejos macho que se situaron alrededor de cada hembra.\n\nEl objetivo es modelizar la proporción de satélites en función de la anchura del caparazón, para averiguar si el número de satélites depende de la anchura del caparazón.\nLos datos se recogen en la siguiente tabla:\n\n\n\nAnchura(x)\nSatélites\nTotal (n)\n\n\n\n\n23.25\n5\n14\n\n\n23.75\n4\n14\n\n\n24.75\n17\n28\n\n\n25.75\n21\n39\n\n\n26.75\n15\n22\n\n\n27.75\n20\n24\n\n\n28.75\n15\n18\n\n\n29.25\n14\n14\n\n\n\nIntroduce los datos en R en un data.frame con el nombre cangrejos y define una nueva variable llamada prop que indique la proporción de satélites para cada anchura.\n\n#### Creamos el conjunto de datos\n anchura&lt;-c(23.25,23.75,24.75,25.75,26.75,27.75,28.75,29.25)\n satelites&lt;-c(5,4,17,21,15,20,15,14)\n total&lt;-c(14,14,28,39,22,24,18,14)\n prop&lt;-satelites/total\n cangrejos&lt;-data.frame(anchura,satelites,total,prop)\n cangrejos\n\n  anchura satelites total      prop\n1   23.25         5    14 0.3571429\n2   23.75         4    14 0.2857143\n3   24.75        17    28 0.6071429\n4   25.75        21    39 0.5384615\n5   26.75        15    22 0.6818182\n6   27.75        20    24 0.8333333\n7   28.75        15    18 0.8333333\n8   29.25        14    14 1.0000000\n\n\n\nAjusta el modelo probabilístico lineal\n\n\\[\\pi(x)=\\alpha + \\beta x\\]\ndonde la y corresponde a la variable prop y la x corresponde a la anchura del caparazón del cangrejo.\n\n### Ajuste del modelo\ncangrejos.lm&lt;-lm(prop~anchura,weights=total,data=cangrejos)\nsummary(cangrejos.lm) \n\n\nCall:\nlm(formula = prop ~ anchura, data = cangrejos, weights = total)\n\nWeighted Residuals:\n     Min       1Q   Median       3Q      Max \n-0.39848 -0.28671 -0.00139  0.18904  0.60386 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -2.00206    0.39604  -5.055  0.00232 ** \nanchura      0.10081    0.01507   6.692  0.00054 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3641 on 6 degrees of freedom\nMultiple R-squared:  0.8818,    Adjusted R-squared:  0.8621 \nF-statistic: 44.78 on 1 and 6 DF,  p-value: 0.0005402\n\n\nResponde a las siguientes preguntas\n\n¿Cuáles son las estimaciones de los coeficientes? ¿son estadísticamente significativos?\n\n\\(\\alpha\\) =-2.00206 es estadísticamente significativo, dado que su p-valor es pequeño\n\\(\\beta\\) =0.10081 es estadísticamente significativo, dado que su p-valor es también pequeño\n\n¿Cuál es el coeficiente de determinación y cuál es su significado?\n\n\\(R^2\\)= 0.8818. Significa que el 88,18% de la variabilidad total es explicada por el modelo de regresión\n¿El modelo ajustado es estadísticamente significativo?\n\nanova(cangrejos.lm)\n\nAnalysis of Variance Table\n\nResponse: prop\n          Df Sum Sq Mean Sq F value    Pr(&gt;F)    \nanchura    1 5.9365  5.9365  44.778 0.0005402 ***\nResiduals  6 0.7955  0.1326                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nSí, el modelo es estadísticamente significativo. La función anova() presenta el análisis de la varianza con la descomposición de la variabilidad total en sus fuentes de variación y nos indica que la variable anchura es estadísticamente significativa\n\n¿Cuáles son las predicciones de la proporción de satélites para cada valor de la anchura observada?\n\n\n### Predicciones \nround(fitted(cangrejos.lm),3)    ### predicciones de proporciones redondeadas a 3 decimales\n\n    1     2     3     4     5     6     7     8 \n0.342 0.392 0.493 0.594 0.695 0.795 0.896 0.947 \n\nfitted(cangrejos.lm)*total       ## predicciones del número  esperado de cangrejos\n\n       1        2        3        4        5        6        7        8 \n 4.78529  5.49097 13.80466 23.15957 15.28222 19.09099 16.13285 13.25345 \n\ndata.frame(cangrejos,pred.prop=fitted(cangrejos.lm),pred.total.sat=fitted(cangrejos.lm)*total)\n\n  anchura satelites total      prop pred.prop pred.total.sat\n1   23.25         5    14 0.3571429 0.3418064        4.78529\n2   23.75         4    14 0.2857143 0.3922122        5.49097\n3   24.75        17    28 0.6071429 0.4930236       13.80466\n4   25.75        21    39 0.5384615 0.5938350       23.15957\n5   26.75        15    22 0.6818182 0.6946465       15.28222\n6   27.75        20    24 0.8333333 0.7954579       19.09099\n7   28.75        15    18 0.8333333 0.8962694       16.13285\n8   29.25        14    14 1.0000000 0.9466751       13.25345\n\n\n\nCuál es el número esperado de satélites por hembra?\n\n\n mean(fitted(cangrejos.lm)*total)\n\n[1] 13.875\n\n\nEl número esperado o medio de satélites por hembra es de 13.875.\n\nRepresenta gráficamente las proporciones observadas y las predicciones lineales de las proporciones de satélites por cada anchura del caparazón\n\n\nplot(cangrejos$anchura, cangrejos$prop)     #### representación gráfica\nabline(cangrejos.lm, col=3,lwd=2)           ### recta de regrésión\n\n\n\n\n\n\nAjusta el modelo logístico\n\n\\[\n\\mbox{logit}\\, [\\pi(x)]=\\mbox{log}\\,\n\\left(\\frac{\\pi(x)}{1-\\pi(x)}\\right)= \\beta_0 + \\beta_1 x\n\\]\ndonde la \\(\\pi\\) corresponde a la proporción de satélites por anchura de caparazón, y x corresponde a la anchura del cangrejo\n\n## Ajuste del modelo logístico \ncangrejos.glm &lt;-glm(prop~anchura,family=binomial, weights=total,data=cangrejos)       \nsummary(cangrejos.glm)\n\n\nCall:\nglm(formula = prop ~ anchura, family = binomial, data = cangrejos, \n    weights = total)\n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept) -12.4421     2.7150  -4.583 4.59e-06 ***\nanchura       0.5011     0.1051   4.767 1.87e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 34.0340  on 7  degrees of freedom\nResidual deviance:  6.4542  on 6  degrees of freedom\nAIC: 33.636\n\nNumber of Fisher Scoring iterations: 4\n\n\n\n¿Cuáles son las estimaciones de los coeficientes? ¿son estadísticamente significativos?\n\n\nconfint(cangrejos.glm)\n\nWaiting for profiling to be done...\n\n\n                 2.5 %     97.5 %\n(Intercept) -18.027915 -7.3310864\nanchura       0.303846  0.7180261\n\nanova(cangrejos.glm,test=\"Chi\")\n\nAnalysis of Deviance Table\n\nModel: binomial, link: logit\n\nResponse: prop\n\nTerms added sequentially (first to last)\n\n        Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    \nNULL                        7     34.034              \nanchura  1    27.58         6      6.454 1.507e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nSí, tanto el intercept \\(\\alpha\\) como el \\(\\beta\\) son estadísticamente significativos\n\n¿Cuál es la tasa incremental de cambio a los 26 cms? ¿Qué significa?\n\n\nsource(\"tasa.incremental.R\")\n\ntasa.incremental(cangrejos.glm,26,27,3)\n\n[1] \"x1=\"         \"26\"          \"x2=\"         \"27\"          \"incremento=\"\n[6] \"1\"          \n[1] \"pi.x1.1=probabilidad de éxito en x1\"\n[1] \"pi.x2.1=probabilidad de éxito en x2\"\n[1] \"odds.x1.1=odds en x1\"\n[1] \"odds.x2.1=odds en x2\"\n[1] \"tasa.inc.p=tasa incremental de cambio de probabilidad x1 a x2\"\n[1] \"tasa.inc.odds=tasa incremental de cambio de odds(x1) a odds(x2)\"\n\n\n           pi.x1.1 tasa.inc.p.anchura            pi.x2.1          odds.x1.1 \n             0.643              0.115              0.748              1.799 \n   tasa.inc.odds.1          odds.x2.1 \n             1.651              2.970 \n\n## manual\n\npigorro26&lt;-predict(cangrejos.glm,data.frame(anchura=26),type=\"response\")\nbeta&lt;-coef(cangrejos.glm)[2]\ntasa26&lt;-beta*pigorro26*(1-pigorro26)\ntasa26\n\n anchura \n0.115072 \n\n\nInterpretación: Esto significa que cuando la anchura del caparazón aumenta de 26 a 27 cm, la proporción de satélites por hembra aumenta 0.001223.\n\n¿Cuál es la tasa incremental de cambio de probabilidad de que se acerquen cangrejos macho y la tasa de crecimiento en los odds para pasar de 23 a 24, de 24 a 25, de 25 a 26 y de 26 a 27 cm en la anchura del caparazón? ¿Qué significan?\n\n\ntasa.incremental(cangrejos.glm,23,24,decimales=4)\n\n[1] \"x1=\"         \"23\"          \"x2=\"         \"24\"          \"incremento=\"\n[6] \"1\"          \n[1] \"pi.x1.1=probabilidad de éxito en x1\"\n[1] \"pi.x2.1=probabilidad de éxito en x2\"\n[1] \"odds.x1.1=odds en x1\"\n[1] \"odds.x2.1=odds en x2\"\n[1] \"tasa.inc.p=tasa incremental de cambio de probabilidad x1 a x2\"\n[1] \"tasa.inc.odds=tasa incremental de cambio de odds(x1) a odds(x2)\"\n\n\n           pi.x1.1 tasa.inc.p.anchura            pi.x2.1          odds.x1.1 \n            0.2858             0.1023             0.3977             0.4001 \n   tasa.inc.odds.1          odds.x2.1 \n            1.6506             0.6604 \n\ntasa.incremental(cangrejos.glm,24,25,decimales=4)\n\n[1] \"x1=\"         \"24\"          \"x2=\"         \"25\"          \"incremento=\"\n[6] \"1\"          \n[1] \"pi.x1.1=probabilidad de éxito en x1\"\n[1] \"pi.x2.1=probabilidad de éxito en x2\"\n[1] \"odds.x1.1=odds en x1\"\n[1] \"odds.x2.1=odds en x2\"\n[1] \"tasa.inc.p=tasa incremental de cambio de probabilidad x1 a x2\"\n[1] \"tasa.inc.odds=tasa incremental de cambio de odds(x1) a odds(x2)\"\n\n\n           pi.x1.1 tasa.inc.p.anchura            pi.x2.1          odds.x1.1 \n            0.3977             0.1200             0.5215             0.6604 \n   tasa.inc.odds.1          odds.x2.1 \n            1.6506             1.0900 \n\ntasa.incremental(cangrejos.glm,25,26,decimales=4)\n\n[1] \"x1=\"         \"25\"          \"x2=\"         \"26\"          \"incremento=\"\n[6] \"1\"          \n[1] \"pi.x1.1=probabilidad de éxito en x1\"\n[1] \"pi.x2.1=probabilidad de éxito en x2\"\n[1] \"odds.x1.1=odds en x1\"\n[1] \"odds.x2.1=odds en x2\"\n[1] \"tasa.inc.p=tasa incremental de cambio de probabilidad x1 a x2\"\n[1] \"tasa.inc.odds=tasa incremental de cambio de odds(x1) a odds(x2)\"\n\n\n           pi.x1.1 tasa.inc.p.anchura            pi.x2.1          odds.x1.1 \n            0.5215             0.1251             0.6427             1.0900 \n   tasa.inc.odds.1          odds.x2.1 \n            1.6506             1.7991 \n\ntasa.incremental(cangrejos.glm,26,27,decimales=4)\n\n[1] \"x1=\"         \"26\"          \"x2=\"         \"27\"          \"incremento=\"\n[6] \"1\"          \n[1] \"pi.x1.1=probabilidad de éxito en x1\"\n[1] \"pi.x2.1=probabilidad de éxito en x2\"\n[1] \"odds.x1.1=odds en x1\"\n[1] \"odds.x2.1=odds en x2\"\n[1] \"tasa.inc.p=tasa incremental de cambio de probabilidad x1 a x2\"\n[1] \"tasa.inc.odds=tasa incremental de cambio de odds(x1) a odds(x2)\"\n\n\n           pi.x1.1 tasa.inc.p.anchura            pi.x2.1          odds.x1.1 \n            0.6427             0.1151             0.7481             1.7991 \n   tasa.inc.odds.1          odds.x2.1 \n            1.6506             2.9695 \n\n\nInterpretación (seguid el ejemplo anterior)\n\n¿Cuánto crece el odds estimado por cada cm de aumento del caparazón?\n\n\nexp(beta)\n\n anchura \n1.650584 \n\n\nInterpretación: Por cada incremento de una unidad (un cm) en la anchura del caparazón el odds estimado crece odds crece un 65%\n\n¿Cuáles son las predicciones de la proporción de satélites para cada valor de la anchura observada?\n\n\nfitted(cangrejos.glm) #### proporciones pronosticadas por el modelo de regresión logística\n\n        1         2         3         4         5         6         7         8 \n0.3119907 0.3681261 0.4902175 0.6134872 0.7237468 0.8121823 0.8771142 0.9016724 \n\nfitted(cangrejos.glm)*total #### número esperado medio de satélites por el modelo de regresión logística\n\n        1         2         3         4         5         6         7         8 \n 4.367870  5.153766 13.726090 23.926000 15.922429 19.492375 15.788056 12.623414 \n\ndata.frame(cangrejos,pred.prop=fitted(cangrejos.glm),pred.total.sat=fitted(cangrejos.glm)*total)\n\n  anchura satelites total      prop pred.prop pred.total.sat\n1   23.25         5    14 0.3571429 0.3119907       4.367870\n2   23.75         4    14 0.2857143 0.3681261       5.153766\n3   24.75        17    28 0.6071429 0.4902175      13.726090\n4   25.75        21    39 0.5384615 0.6134872      23.926000\n5   26.75        15    22 0.6818182 0.7237468      15.922429\n6   27.75        20    24 0.8333333 0.8121823      19.492375\n7   28.75        15    18 0.8333333 0.8771142      15.788056\n8   29.25        14    14 1.0000000 0.9016724      12.623414\n\n\n\nRepresenta gráficamente las proporciones observadas y las predicciones lineales y logísticas de las proporciones de satélites por cada anchura del caparazón\n\n\nplot(anchura, prop)\nlines(anchura, fitted(cangrejos.lm), col=5,lwd=3)\nlines(anchura, fitted(cangrejos.glm), col=4,lwd=3)\nlegend(23.5,0.9,c(\"logit\",\"lineal\"),col=c(5,4),lwd=c(3,3))"
  },
  {
    "objectID": "Practica7.html#práctica-7---regresión-logística",
    "href": "Practica7.html#práctica-7---regresión-logística",
    "title": "Bioestadística. Máster Universitario en Investigación en Ciencias de la Salud",
    "section": "",
    "text": "Para estudiar la posible relación entre el número de satélites (cangrejos macho a su alrededor) y la anchura del caparazón de los cangrejos hembra tipo herradura, se realizó un experimento con 8 cangrejos hembra a los que se midió:\n\n\nLa anchura de los caparazones (x), medida en cm.\nEl número total de cangrejos macho que se utilizaron en el experimento para cada hembra (n)\nEl número de satélites o cangrejos macho que se situaron alrededor de cada hembra.\n\nEl objetivo es modelizar la proporción de satélites en función de la anchura del caparazón, para averiguar si el número de satélites depende de la anchura del caparazón.\nLos datos se recogen en la siguiente tabla:\n\n\n\nAnchura(x)\nSatélites\nTotal (n)\n\n\n\n\n23.25\n5\n14\n\n\n23.75\n4\n14\n\n\n24.75\n17\n28\n\n\n25.75\n21\n39\n\n\n26.75\n15\n22\n\n\n27.75\n20\n24\n\n\n28.75\n15\n18\n\n\n29.25\n14\n14\n\n\n\nIntroduce los datos en R en un data.frame con el nombre cangrejos y define una nueva variable llamada prop que indique la proporción de satélites para cada anchura.\n\n#### Creamos el conjunto de datos\n anchura&lt;-c(23.25,23.75,24.75,25.75,26.75,27.75,28.75,29.25)\n satelites&lt;-c(5,4,17,21,15,20,15,14)\n total&lt;-c(14,14,28,39,22,24,18,14)\n prop&lt;-satelites/total\n cangrejos&lt;-data.frame(anchura,satelites,total,prop)\n cangrejos\n\n  anchura satelites total      prop\n1   23.25         5    14 0.3571429\n2   23.75         4    14 0.2857143\n3   24.75        17    28 0.6071429\n4   25.75        21    39 0.5384615\n5   26.75        15    22 0.6818182\n6   27.75        20    24 0.8333333\n7   28.75        15    18 0.8333333\n8   29.25        14    14 1.0000000\n\n\n\nAjusta el modelo probabilístico lineal\n\n\\[\\pi(x)=\\alpha + \\beta x\\]\ndonde la y corresponde a la variable prop y la x corresponde a la anchura del caparazón del cangrejo.\n\n### Ajuste del modelo\ncangrejos.lm&lt;-lm(prop~anchura,weights=total,data=cangrejos)\nsummary(cangrejos.lm) \n\n\nCall:\nlm(formula = prop ~ anchura, data = cangrejos, weights = total)\n\nWeighted Residuals:\n     Min       1Q   Median       3Q      Max \n-0.39848 -0.28671 -0.00139  0.18904  0.60386 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -2.00206    0.39604  -5.055  0.00232 ** \nanchura      0.10081    0.01507   6.692  0.00054 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3641 on 6 degrees of freedom\nMultiple R-squared:  0.8818,    Adjusted R-squared:  0.8621 \nF-statistic: 44.78 on 1 and 6 DF,  p-value: 0.0005402\n\n\nResponde a las siguientes preguntas\n\n¿Cuáles son las estimaciones de los coeficientes? ¿son estadísticamente significativos?\n\n\\(\\alpha\\) =-2.00206 es estadísticamente significativo, dado que su p-valor es pequeño\n\\(\\beta\\) =0.10081 es estadísticamente significativo, dado que su p-valor es también pequeño\n\n¿Cuál es el coeficiente de determinación y cuál es su significado?\n\n\\(R^2\\)= 0.8818. Significa que el 88,18% de la variabilidad total es explicada por el modelo de regresión\n¿El modelo ajustado es estadísticamente significativo?\n\nanova(cangrejos.lm)\n\nAnalysis of Variance Table\n\nResponse: prop\n          Df Sum Sq Mean Sq F value    Pr(&gt;F)    \nanchura    1 5.9365  5.9365  44.778 0.0005402 ***\nResiduals  6 0.7955  0.1326                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nSí, el modelo es estadísticamente significativo. La función anova() presenta el análisis de la varianza con la descomposición de la variabilidad total en sus fuentes de variación y nos indica que la variable anchura es estadísticamente significativa\n\n¿Cuáles son las predicciones de la proporción de satélites para cada valor de la anchura observada?\n\n\n### Predicciones \nround(fitted(cangrejos.lm),3)    ### predicciones de proporciones redondeadas a 3 decimales\n\n    1     2     3     4     5     6     7     8 \n0.342 0.392 0.493 0.594 0.695 0.795 0.896 0.947 \n\nfitted(cangrejos.lm)*total       ## predicciones del número  esperado de cangrejos\n\n       1        2        3        4        5        6        7        8 \n 4.78529  5.49097 13.80466 23.15957 15.28222 19.09099 16.13285 13.25345 \n\ndata.frame(cangrejos,pred.prop=fitted(cangrejos.lm),pred.total.sat=fitted(cangrejos.lm)*total)\n\n  anchura satelites total      prop pred.prop pred.total.sat\n1   23.25         5    14 0.3571429 0.3418064        4.78529\n2   23.75         4    14 0.2857143 0.3922122        5.49097\n3   24.75        17    28 0.6071429 0.4930236       13.80466\n4   25.75        21    39 0.5384615 0.5938350       23.15957\n5   26.75        15    22 0.6818182 0.6946465       15.28222\n6   27.75        20    24 0.8333333 0.7954579       19.09099\n7   28.75        15    18 0.8333333 0.8962694       16.13285\n8   29.25        14    14 1.0000000 0.9466751       13.25345\n\n\n\nCuál es el número esperado de satélites por hembra?\n\n\n mean(fitted(cangrejos.lm)*total)\n\n[1] 13.875\n\n\nEl número esperado o medio de satélites por hembra es de 13.875.\n\nRepresenta gráficamente las proporciones observadas y las predicciones lineales de las proporciones de satélites por cada anchura del caparazón\n\n\nplot(cangrejos$anchura, cangrejos$prop)     #### representación gráfica\nabline(cangrejos.lm, col=3,lwd=2)           ### recta de regrésión\n\n\n\n\n\n\nAjusta el modelo logístico\n\n\\[\n\\mbox{logit}\\, [\\pi(x)]=\\mbox{log}\\,\n\\left(\\frac{\\pi(x)}{1-\\pi(x)}\\right)= \\beta_0 + \\beta_1 x\n\\]\ndonde la \\(\\pi\\) corresponde a la proporción de satélites por anchura de caparazón, y x corresponde a la anchura del cangrejo\n\n## Ajuste del modelo logístico \ncangrejos.glm &lt;-glm(prop~anchura,family=binomial, weights=total,data=cangrejos)       \nsummary(cangrejos.glm)\n\n\nCall:\nglm(formula = prop ~ anchura, family = binomial, data = cangrejos, \n    weights = total)\n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept) -12.4421     2.7150  -4.583 4.59e-06 ***\nanchura       0.5011     0.1051   4.767 1.87e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 34.0340  on 7  degrees of freedom\nResidual deviance:  6.4542  on 6  degrees of freedom\nAIC: 33.636\n\nNumber of Fisher Scoring iterations: 4\n\n\n\n¿Cuáles son las estimaciones de los coeficientes? ¿son estadísticamente significativos?\n\n\nconfint(cangrejos.glm)\n\nWaiting for profiling to be done...\n\n\n                 2.5 %     97.5 %\n(Intercept) -18.027915 -7.3310864\nanchura       0.303846  0.7180261\n\nanova(cangrejos.glm,test=\"Chi\")\n\nAnalysis of Deviance Table\n\nModel: binomial, link: logit\n\nResponse: prop\n\nTerms added sequentially (first to last)\n\n        Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    \nNULL                        7     34.034              \nanchura  1    27.58         6      6.454 1.507e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nSí, tanto el intercept \\(\\alpha\\) como el \\(\\beta\\) son estadísticamente significativos\n\n¿Cuál es la tasa incremental de cambio a los 26 cms? ¿Qué significa?\n\n\nsource(\"tasa.incremental.R\")\n\ntasa.incremental(cangrejos.glm,26,27,3)\n\n[1] \"x1=\"         \"26\"          \"x2=\"         \"27\"          \"incremento=\"\n[6] \"1\"          \n[1] \"pi.x1.1=probabilidad de éxito en x1\"\n[1] \"pi.x2.1=probabilidad de éxito en x2\"\n[1] \"odds.x1.1=odds en x1\"\n[1] \"odds.x2.1=odds en x2\"\n[1] \"tasa.inc.p=tasa incremental de cambio de probabilidad x1 a x2\"\n[1] \"tasa.inc.odds=tasa incremental de cambio de odds(x1) a odds(x2)\"\n\n\n           pi.x1.1 tasa.inc.p.anchura            pi.x2.1          odds.x1.1 \n             0.643              0.115              0.748              1.799 \n   tasa.inc.odds.1          odds.x2.1 \n             1.651              2.970 \n\n## manual\n\npigorro26&lt;-predict(cangrejos.glm,data.frame(anchura=26),type=\"response\")\nbeta&lt;-coef(cangrejos.glm)[2]\ntasa26&lt;-beta*pigorro26*(1-pigorro26)\ntasa26\n\n anchura \n0.115072 \n\n\nInterpretación: Esto significa que cuando la anchura del caparazón aumenta de 26 a 27 cm, la proporción de satélites por hembra aumenta 0.001223.\n\n¿Cuál es la tasa incremental de cambio de probabilidad de que se acerquen cangrejos macho y la tasa de crecimiento en los odds para pasar de 23 a 24, de 24 a 25, de 25 a 26 y de 26 a 27 cm en la anchura del caparazón? ¿Qué significan?\n\n\ntasa.incremental(cangrejos.glm,23,24,decimales=4)\n\n[1] \"x1=\"         \"23\"          \"x2=\"         \"24\"          \"incremento=\"\n[6] \"1\"          \n[1] \"pi.x1.1=probabilidad de éxito en x1\"\n[1] \"pi.x2.1=probabilidad de éxito en x2\"\n[1] \"odds.x1.1=odds en x1\"\n[1] \"odds.x2.1=odds en x2\"\n[1] \"tasa.inc.p=tasa incremental de cambio de probabilidad x1 a x2\"\n[1] \"tasa.inc.odds=tasa incremental de cambio de odds(x1) a odds(x2)\"\n\n\n           pi.x1.1 tasa.inc.p.anchura            pi.x2.1          odds.x1.1 \n            0.2858             0.1023             0.3977             0.4001 \n   tasa.inc.odds.1          odds.x2.1 \n            1.6506             0.6604 \n\ntasa.incremental(cangrejos.glm,24,25,decimales=4)\n\n[1] \"x1=\"         \"24\"          \"x2=\"         \"25\"          \"incremento=\"\n[6] \"1\"          \n[1] \"pi.x1.1=probabilidad de éxito en x1\"\n[1] \"pi.x2.1=probabilidad de éxito en x2\"\n[1] \"odds.x1.1=odds en x1\"\n[1] \"odds.x2.1=odds en x2\"\n[1] \"tasa.inc.p=tasa incremental de cambio de probabilidad x1 a x2\"\n[1] \"tasa.inc.odds=tasa incremental de cambio de odds(x1) a odds(x2)\"\n\n\n           pi.x1.1 tasa.inc.p.anchura            pi.x2.1          odds.x1.1 \n            0.3977             0.1200             0.5215             0.6604 \n   tasa.inc.odds.1          odds.x2.1 \n            1.6506             1.0900 \n\ntasa.incremental(cangrejos.glm,25,26,decimales=4)\n\n[1] \"x1=\"         \"25\"          \"x2=\"         \"26\"          \"incremento=\"\n[6] \"1\"          \n[1] \"pi.x1.1=probabilidad de éxito en x1\"\n[1] \"pi.x2.1=probabilidad de éxito en x2\"\n[1] \"odds.x1.1=odds en x1\"\n[1] \"odds.x2.1=odds en x2\"\n[1] \"tasa.inc.p=tasa incremental de cambio de probabilidad x1 a x2\"\n[1] \"tasa.inc.odds=tasa incremental de cambio de odds(x1) a odds(x2)\"\n\n\n           pi.x1.1 tasa.inc.p.anchura            pi.x2.1          odds.x1.1 \n            0.5215             0.1251             0.6427             1.0900 \n   tasa.inc.odds.1          odds.x2.1 \n            1.6506             1.7991 \n\ntasa.incremental(cangrejos.glm,26,27,decimales=4)\n\n[1] \"x1=\"         \"26\"          \"x2=\"         \"27\"          \"incremento=\"\n[6] \"1\"          \n[1] \"pi.x1.1=probabilidad de éxito en x1\"\n[1] \"pi.x2.1=probabilidad de éxito en x2\"\n[1] \"odds.x1.1=odds en x1\"\n[1] \"odds.x2.1=odds en x2\"\n[1] \"tasa.inc.p=tasa incremental de cambio de probabilidad x1 a x2\"\n[1] \"tasa.inc.odds=tasa incremental de cambio de odds(x1) a odds(x2)\"\n\n\n           pi.x1.1 tasa.inc.p.anchura            pi.x2.1          odds.x1.1 \n            0.6427             0.1151             0.7481             1.7991 \n   tasa.inc.odds.1          odds.x2.1 \n            1.6506             2.9695 \n\n\nInterpretación (seguid el ejemplo anterior)\n\n¿Cuánto crece el odds estimado por cada cm de aumento del caparazón?\n\n\nexp(beta)\n\n anchura \n1.650584 \n\n\nInterpretación: Por cada incremento de una unidad (un cm) en la anchura del caparazón el odds estimado crece odds crece un 65%\n\n¿Cuáles son las predicciones de la proporción de satélites para cada valor de la anchura observada?\n\n\nfitted(cangrejos.glm) #### proporciones pronosticadas por el modelo de regresión logística\n\n        1         2         3         4         5         6         7         8 \n0.3119907 0.3681261 0.4902175 0.6134872 0.7237468 0.8121823 0.8771142 0.9016724 \n\nfitted(cangrejos.glm)*total #### número esperado medio de satélites por el modelo de regresión logística\n\n        1         2         3         4         5         6         7         8 \n 4.367870  5.153766 13.726090 23.926000 15.922429 19.492375 15.788056 12.623414 \n\ndata.frame(cangrejos,pred.prop=fitted(cangrejos.glm),pred.total.sat=fitted(cangrejos.glm)*total)\n\n  anchura satelites total      prop pred.prop pred.total.sat\n1   23.25         5    14 0.3571429 0.3119907       4.367870\n2   23.75         4    14 0.2857143 0.3681261       5.153766\n3   24.75        17    28 0.6071429 0.4902175      13.726090\n4   25.75        21    39 0.5384615 0.6134872      23.926000\n5   26.75        15    22 0.6818182 0.7237468      15.922429\n6   27.75        20    24 0.8333333 0.8121823      19.492375\n7   28.75        15    18 0.8333333 0.8771142      15.788056\n8   29.25        14    14 1.0000000 0.9016724      12.623414\n\n\n\nRepresenta gráficamente las proporciones observadas y las predicciones lineales y logísticas de las proporciones de satélites por cada anchura del caparazón\n\n\nplot(anchura, prop)\nlines(anchura, fitted(cangrejos.lm), col=5,lwd=3)\nlines(anchura, fitted(cangrejos.glm), col=4,lwd=3)\nlegend(23.5,0.9,c(\"logit\",\"lineal\"),col=c(5,4),lwd=c(3,3))"
  },
  {
    "objectID": "Practica8.html",
    "href": "Practica8.html",
    "title": "Bioestadística. Máster Universitario en Investigación en Ciencias de la Salud",
    "section": "",
    "text": "En pruebas con anticonceptivos, un criterio evidente de aceptación de dicho anticonceptivo es la prevención de embarazos. Sin embargo, los anticonceptivos modernos muestran tasas de fallo muy bajas, y por tanto las alteraciones en ocurrencia de hemorragias, como amenorrea (una ausencia prolongada de hemorragia), hemorragias irregulares o prolongadas, son importantes a la hora de evaluar un método anticonceptivo.\nPara promocionar la investigación en este tema la OMS (WHO) ha proporcionado datos de ensayos clínicos realizadas con distintos tipos de anticonceptivos. Una parte de este conjunto de datos tiene que ver con el tiempo que transcurre desde que una mujer comienza a usar un método particular hasta que suspende su uso.\nLos datos que presentamos a continuación corresponden al número de semanas que transcurren desde el comienzo de uso de un dispositivo intrauterino particular (DIU) llamado Multiload 250, hasta que se suspende su uso por problemas de hemorragias. Los datos corresponden a 18 mujeres entre 18 y 35 años que habían experimentado dos embarazos previos.\nEn este ejemplo el tiempo de origen en que se comienza el estudio es a partir del primer día de uso del DIU y el tiempo final es la suspensión debido a problemas hemorrágicos.\nAlgunas mujeres suspendieron el uso del DIU porque deseaban quedarse embarazadas mientras que otras simplemente se perdió su seguimiento. Por ello aparecen algunos datos censurados.\nUn objetivo de este análisis es resumir la distribución de los tiempos de suspensión del uso del dispositivo intrauterino.\nDatos: tiempo en semanas hasta la suspensión de uso del DIU\n10, 134+, 18+, 19, 23+, 30, 36, 38+, 54+, 56+, 59, 75, 93, 97, 104+, 107, 107+, 107+\nPuedes leer los datos del fichero dispositivo.txt o puedes introducirlos manualmente.\n\nlibrary(survival)\ndiu&lt;-read.table(\"dispositivo.txt\", header=T)\n\n\nEstima la función de supervivencia \\(S(t)\\) por Kaplan-Meier. Calcula los errores estándar y proporciona un I.C. al 95% para \\(S(t)\\).\n\n\ndiu.surv1&lt;-survfit(Surv(time,status)~1, diu)  \nsummary(diu.surv1)\n\nCall: survfit(formula = Surv(time, status) ~ 1, data = diu)\n\n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n   10     18       1    0.944  0.0540       0.8443        1.000\n   19     15       1    0.881  0.0790       0.7395        1.000\n   30     13       1    0.814  0.0978       0.6429        1.000\n   36     12       1    0.746  0.1107       0.5577        0.998\n   59      8       1    0.653  0.1303       0.4413        0.965\n   75      7       1    0.559  0.1412       0.3411        0.917\n   93      6       1    0.466  0.1452       0.2532        0.858\n   97      5       1    0.373  0.1430       0.1759        0.791\n  107      3       1    0.249  0.1392       0.0829        0.745\n\n\n\n¿Cuál es la probabilidad de que el tiempo de uso del dispositivo supere las 19 semanas?\nDibuja la función de supervivencia estimada con su correspondiente intervalo de confianza.\n\n\nplot(diu.surv1, lwd=3)\n\n\n\n\nProblema 2. Considere el fichero “OvarianCancer.txt” para estudiar la supervivencia en un ensayo aleatorio que compara dos tratamientos para el cáncer de ovario realizado por el Eastern Cooperative Oncology Group. El fichero incluye las siguientes variables\n\nfutime: tiempo de supervivencia o de censura (días)\nfustat: estado de censura\nage: edad en años\nresid.ds: enfermedad residual presente (1=no,2=sí)\nrx: grupo de tratamiento (1=tratamiento 1, 2= tratamiento 2)\necog.ps: estado de rendimiento ECOG (1 es mejor, ver referencia)\n\nLeer los datos del fichero OvarianCancer.txt\n\novarian&lt;-read.table(\"OvarianCancer.txt\", header=T)\n\n\nAjusta la función de supervivencia \\(S(t)\\) por Kaplan-Meier para los dos grupos de tratamientoy calcula los errores estándar y proporciona un I.C. al 95% para cada \\(S(t)\\).\n\nIndica con qué tratamiento es superior probabilidad de que una paciente sobreviva más de un año. Justifica tus respuestas.\n¿Cuál es el tratamiento más eficaz incialmente?\n¿Cuál dirías que es el tratamiento más eficaz a largo plazo?\n\n\n\novarian1&lt;-ovarian[ovarian$rx==1,] #Seleccionamos el GRUPO PLACEBO\n\nov1.surv&lt;-survfit(Surv(futime,fustat)~1, ovarian1) #ajustamos la curva\nsummary(ov1.surv) # Vemos los resultados\n\nCall: survfit(formula = Surv(futime, fustat) ~ 1, data = ovarian1)\n\n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n   59     13       1    0.923  0.0739        0.789        1.000\n  115     12       1    0.846  0.1001        0.671        1.000\n  156     11       1    0.769  0.1169        0.571        1.000\n  268     10       1    0.692  0.1280        0.482        0.995\n  329      9       1    0.615  0.1349        0.400        0.946\n  431      8       1    0.538  0.1383        0.326        0.891\n  638      5       1    0.431  0.1467        0.221        0.840\n\nplot(ov1.surv, main=\"Curva supervivencia-Tratamiento 1\")    #Dibujamos la curva\n\n\n\novarian2&lt;-ovarian[ovarian$rx==2,] #Seleccionamos el GRUPO TRATAMIENTO 1\n\nov2.surv&lt;-survfit(Surv(futime,fustat)~1, ovarian2) #ajustamos la curva\nsummary(ov2.surv) # Vemos los resultados\n\nCall: survfit(formula = Surv(futime, fustat) ~ 1, data = ovarian2)\n\n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n  353     13       1    0.923  0.0739        0.789        1.000\n  365     12       1    0.846  0.1001        0.671        1.000\n  464      9       1    0.752  0.1256        0.542        1.000\n  475      8       1    0.658  0.1407        0.433        1.000\n  563      7       1    0.564  0.1488        0.336        0.946\n\nplot(ov2.surv, main=\"Curva supervivencia-Tratamiento 2\")    #Dibujamos la curva\n\n\n\n# alternativamente (no proporciona IC)\n\nklein.surv&lt;-survfit(Surv(futime,fustat)~rx, ovarian)\nsummary(klein.surv)\n\nCall: survfit(formula = Surv(futime, fustat) ~ rx, data = ovarian)\n\n                rx=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n   59     13       1    0.923  0.0739        0.789        1.000\n  115     12       1    0.846  0.1001        0.671        1.000\n  156     11       1    0.769  0.1169        0.571        1.000\n  268     10       1    0.692  0.1280        0.482        0.995\n  329      9       1    0.615  0.1349        0.400        0.946\n  431      8       1    0.538  0.1383        0.326        0.891\n  638      5       1    0.431  0.1467        0.221        0.840\n\n                rx=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n  353     13       1    0.923  0.0739        0.789        1.000\n  365     12       1    0.846  0.1001        0.671        1.000\n  464      9       1    0.752  0.1256        0.542        1.000\n  475      8       1    0.658  0.1407        0.433        1.000\n  563      7       1    0.564  0.1488        0.336        0.946\n\nplot(klein.surv,lty=c(1,2),col=c(4,2),lwd=c(2,2),main=\"Curvas de supervivencia KM\")\nlegend(1000,1,c(\"Rx=1\",\"Rx=2\"),lty=c(1,2),col=c(4,2),lwd=c(2,2)) \n\n\n\n\n\nCompara las curvas de supervivencia en ambios grupos e indica si hay diferencias significativas.\n\n\nsurvdiff(Surv(futime,fustat)~rx, ovarian)\n\nCall:\nsurvdiff(formula = Surv(futime, fustat) ~ rx, data = ovarian)\n\n      N Observed Expected (O-E)^2/E (O-E)^2/V\nrx=1 13        7     5.23     0.596      1.06\nrx=2 13        5     6.77     0.461      1.06\n\n Chisq= 1.1  on 1 degrees of freedom, p= 0.3 \n\nsurvdiff(Surv(futime,fustat)~rx, rho=1, ovarian)\n\nCall:\nsurvdiff(formula = Surv(futime, fustat) ~ rx, data = ovarian, \n    rho = 1)\n\n      N Observed Expected (O-E)^2/E (O-E)^2/V\nrx=1 13     5.89     4.12     0.761      1.68\nrx=2 13     3.50     5.27     0.595      1.68\n\n Chisq= 1.7  on 1 degrees of freedom, p= 0.2"
  },
  {
    "objectID": "Practica8.html#práctica-8---análisis-de-supervivencia",
    "href": "Practica8.html#práctica-8---análisis-de-supervivencia",
    "title": "Bioestadística. Máster Universitario en Investigación en Ciencias de la Salud",
    "section": "",
    "text": "En pruebas con anticonceptivos, un criterio evidente de aceptación de dicho anticonceptivo es la prevención de embarazos. Sin embargo, los anticonceptivos modernos muestran tasas de fallo muy bajas, y por tanto las alteraciones en ocurrencia de hemorragias, como amenorrea (una ausencia prolongada de hemorragia), hemorragias irregulares o prolongadas, son importantes a la hora de evaluar un método anticonceptivo.\nPara promocionar la investigación en este tema la OMS (WHO) ha proporcionado datos de ensayos clínicos realizadas con distintos tipos de anticonceptivos. Una parte de este conjunto de datos tiene que ver con el tiempo que transcurre desde que una mujer comienza a usar un método particular hasta que suspende su uso.\nLos datos que presentamos a continuación corresponden al número de semanas que transcurren desde el comienzo de uso de un dispositivo intrauterino particular (DIU) llamado Multiload 250, hasta que se suspende su uso por problemas de hemorragias. Los datos corresponden a 18 mujeres entre 18 y 35 años que habían experimentado dos embarazos previos.\nEn este ejemplo el tiempo de origen en que se comienza el estudio es a partir del primer día de uso del DIU y el tiempo final es la suspensión debido a problemas hemorrágicos.\nAlgunas mujeres suspendieron el uso del DIU porque deseaban quedarse embarazadas mientras que otras simplemente se perdió su seguimiento. Por ello aparecen algunos datos censurados.\nUn objetivo de este análisis es resumir la distribución de los tiempos de suspensión del uso del dispositivo intrauterino.\nDatos: tiempo en semanas hasta la suspensión de uso del DIU\n10, 134+, 18+, 19, 23+, 30, 36, 38+, 54+, 56+, 59, 75, 93, 97, 104+, 107, 107+, 107+\nPuedes leer los datos del fichero dispositivo.txt o puedes introducirlos manualmente.\n\nlibrary(survival)\ndiu&lt;-read.table(\"dispositivo.txt\", header=T)\n\n\nEstima la función de supervivencia \\(S(t)\\) por Kaplan-Meier. Calcula los errores estándar y proporciona un I.C. al 95% para \\(S(t)\\).\n\n\ndiu.surv1&lt;-survfit(Surv(time,status)~1, diu)  \nsummary(diu.surv1)\n\nCall: survfit(formula = Surv(time, status) ~ 1, data = diu)\n\n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n   10     18       1    0.944  0.0540       0.8443        1.000\n   19     15       1    0.881  0.0790       0.7395        1.000\n   30     13       1    0.814  0.0978       0.6429        1.000\n   36     12       1    0.746  0.1107       0.5577        0.998\n   59      8       1    0.653  0.1303       0.4413        0.965\n   75      7       1    0.559  0.1412       0.3411        0.917\n   93      6       1    0.466  0.1452       0.2532        0.858\n   97      5       1    0.373  0.1430       0.1759        0.791\n  107      3       1    0.249  0.1392       0.0829        0.745\n\n\n\n¿Cuál es la probabilidad de que el tiempo de uso del dispositivo supere las 19 semanas?\nDibuja la función de supervivencia estimada con su correspondiente intervalo de confianza.\n\n\nplot(diu.surv1, lwd=3)\n\n\n\n\nProblema 2. Considere el fichero “OvarianCancer.txt” para estudiar la supervivencia en un ensayo aleatorio que compara dos tratamientos para el cáncer de ovario realizado por el Eastern Cooperative Oncology Group. El fichero incluye las siguientes variables\n\nfutime: tiempo de supervivencia o de censura (días)\nfustat: estado de censura\nage: edad en años\nresid.ds: enfermedad residual presente (1=no,2=sí)\nrx: grupo de tratamiento (1=tratamiento 1, 2= tratamiento 2)\necog.ps: estado de rendimiento ECOG (1 es mejor, ver referencia)\n\nLeer los datos del fichero OvarianCancer.txt\n\novarian&lt;-read.table(\"OvarianCancer.txt\", header=T)\n\n\nAjusta la función de supervivencia \\(S(t)\\) por Kaplan-Meier para los dos grupos de tratamientoy calcula los errores estándar y proporciona un I.C. al 95% para cada \\(S(t)\\).\n\nIndica con qué tratamiento es superior probabilidad de que una paciente sobreviva más de un año. Justifica tus respuestas.\n¿Cuál es el tratamiento más eficaz incialmente?\n¿Cuál dirías que es el tratamiento más eficaz a largo plazo?\n\n\n\novarian1&lt;-ovarian[ovarian$rx==1,] #Seleccionamos el GRUPO PLACEBO\n\nov1.surv&lt;-survfit(Surv(futime,fustat)~1, ovarian1) #ajustamos la curva\nsummary(ov1.surv) # Vemos los resultados\n\nCall: survfit(formula = Surv(futime, fustat) ~ 1, data = ovarian1)\n\n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n   59     13       1    0.923  0.0739        0.789        1.000\n  115     12       1    0.846  0.1001        0.671        1.000\n  156     11       1    0.769  0.1169        0.571        1.000\n  268     10       1    0.692  0.1280        0.482        0.995\n  329      9       1    0.615  0.1349        0.400        0.946\n  431      8       1    0.538  0.1383        0.326        0.891\n  638      5       1    0.431  0.1467        0.221        0.840\n\nplot(ov1.surv, main=\"Curva supervivencia-Tratamiento 1\")    #Dibujamos la curva\n\n\n\novarian2&lt;-ovarian[ovarian$rx==2,] #Seleccionamos el GRUPO TRATAMIENTO 1\n\nov2.surv&lt;-survfit(Surv(futime,fustat)~1, ovarian2) #ajustamos la curva\nsummary(ov2.surv) # Vemos los resultados\n\nCall: survfit(formula = Surv(futime, fustat) ~ 1, data = ovarian2)\n\n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n  353     13       1    0.923  0.0739        0.789        1.000\n  365     12       1    0.846  0.1001        0.671        1.000\n  464      9       1    0.752  0.1256        0.542        1.000\n  475      8       1    0.658  0.1407        0.433        1.000\n  563      7       1    0.564  0.1488        0.336        0.946\n\nplot(ov2.surv, main=\"Curva supervivencia-Tratamiento 2\")    #Dibujamos la curva\n\n\n\n# alternativamente (no proporciona IC)\n\nklein.surv&lt;-survfit(Surv(futime,fustat)~rx, ovarian)\nsummary(klein.surv)\n\nCall: survfit(formula = Surv(futime, fustat) ~ rx, data = ovarian)\n\n                rx=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n   59     13       1    0.923  0.0739        0.789        1.000\n  115     12       1    0.846  0.1001        0.671        1.000\n  156     11       1    0.769  0.1169        0.571        1.000\n  268     10       1    0.692  0.1280        0.482        0.995\n  329      9       1    0.615  0.1349        0.400        0.946\n  431      8       1    0.538  0.1383        0.326        0.891\n  638      5       1    0.431  0.1467        0.221        0.840\n\n                rx=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n  353     13       1    0.923  0.0739        0.789        1.000\n  365     12       1    0.846  0.1001        0.671        1.000\n  464      9       1    0.752  0.1256        0.542        1.000\n  475      8       1    0.658  0.1407        0.433        1.000\n  563      7       1    0.564  0.1488        0.336        0.946\n\nplot(klein.surv,lty=c(1,2),col=c(4,2),lwd=c(2,2),main=\"Curvas de supervivencia KM\")\nlegend(1000,1,c(\"Rx=1\",\"Rx=2\"),lty=c(1,2),col=c(4,2),lwd=c(2,2)) \n\n\n\n\n\nCompara las curvas de supervivencia en ambios grupos e indica si hay diferencias significativas.\n\n\nsurvdiff(Surv(futime,fustat)~rx, ovarian)\n\nCall:\nsurvdiff(formula = Surv(futime, fustat) ~ rx, data = ovarian)\n\n      N Observed Expected (O-E)^2/E (O-E)^2/V\nrx=1 13        7     5.23     0.596      1.06\nrx=2 13        5     6.77     0.461      1.06\n\n Chisq= 1.1  on 1 degrees of freedom, p= 0.3 \n\nsurvdiff(Surv(futime,fustat)~rx, rho=1, ovarian)\n\nCall:\nsurvdiff(formula = Surv(futime, fustat) ~ rx, data = ovarian, \n    rho = 1)\n\n      N Observed Expected (O-E)^2/E (O-E)^2/V\nrx=1 13     5.89     4.12     0.761      1.68\nrx=2 13     3.50     5.27     0.595      1.68\n\n Chisq= 1.7  on 1 degrees of freedom, p= 0.2"
  }
]